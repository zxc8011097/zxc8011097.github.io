<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.5, user-scalable=yes">
    <title>âš¡ è¶³çƒé¢„è¨€å®¶ Â· æ®¿å ‚ç»ˆææ‰©å®¹ | 328é˜Ÿ | football-predict.top</title>
    <!-- Font Awesome 6 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Chart.js 4.4 -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        /* ========== å…¨å±€æ ·å¼ ========== */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: radial-gradient(circle at 30% 10%, #030712, #010314);
            font-family: 'Inter', sans-serif;
            padding: 16px;
            color: #fff;
            position: relative;
            min-height: 100vh;
        }
        .bg-grid {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background-image: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI2MCIgaGVpZ2h0PSI2MCIgdmlld0JveD0iMCAwIDYwIDYwIj48cGF0aCBkPSJNMzAgMHY2ME0wIDMwaDYwIiBzdHJva2U9IiMxYzNhNWEiIHN0cm9rZS13aWR0aD0iMC4zIi8+PC9zdmc+');
            opacity: 0.07; pointer-events: none; z-index: 1;
        }
        .container {
            max-width: 1800px; margin: 0 auto; position: relative; z-index: 20;
            background: rgba(3, 10, 25, 0.8); backdrop-filter: blur(28px);
            border: 1px solid rgba(59,130,246,0.4); border-radius: 52px;
            padding: 28px 30px; box-shadow: 0 50px 100px -20px #000;
        }

        /* ========== ç§»åŠ¨ç«¯ä¸“é¡¹ä¼˜åŒ– ========== */
        @media (max-width: 1000px) {
            .container { padding: 20px 18px; }
            .grid-pro { grid-template-columns: 1fr; }
            .advanced-metrics-grid { grid-template-columns: repeat(2,1fr); }
            .slider-panel { grid-template-columns: 1fr; }
            .formation-grid { grid-template-columns: repeat(4,1fr); }
            .player-pool { max-height: 400px; }
            .horizontal-scroll {
                display: flex; overflow-x: auto; gap: 16px; padding-bottom: 12px;
                -webkit-overflow-scrolling: touch;
            }
            .horizontal-scroll > div { flex: 0 0 280px; }
            .league-selector { flex-wrap: wrap; }
            .league-btn { padding: 8px 16px; font-size: 14px; }
        }

        .league-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 28px; flex-wrap: wrap; }
        .league-selector { background: #0b1a2e; border-radius: 60px; padding: 6px; display: flex; gap: 6px; border: 1px solid #2e5a7a; flex-wrap: wrap; max-width: 100%; overflow-x: auto; }
        .league-btn { padding: 12px 28px; border-radius: 50px; background: transparent; color: #b0d0ff; border: none; font-size: 16px; font-weight: 600; cursor: pointer; transition: 0.2s; white-space: nowrap; }
        .league-btn.active { background: linear-gradient(145deg, #2563eb, #1e40af); color: white; box-shadow: 0 4px 12px #2563eb; }
        .global-badge { background: #1e3a5a; border-radius: 60px; padding: 10px 28px; color: #b0f0ff; display: flex; gap: 12px; font-size: 15px; }

        .grid-pro { display: grid; grid-template-columns: 1.2fr 1fr 1.1fr; gap: 28px; margin-bottom: 32px; }
        @media (max-width: 1300px) { .grid-pro { grid-template-columns: 1fr; } }

        .team-selector-pro { background: rgba(6,20,42,0.7); border-radius: 44px; padding: 28px; border: 1px solid #3a6a9e; }
        .team-badge-lg { font-size: 68px; filter: drop-shadow(0 0 16px #3b82f6); margin-bottom: 8px; }
        .team-select-pro {
            background: #0e1f35; border: 1px solid #3b82f6; border-radius: 40px; padding: 14px 24px;
            color: white; font-size: 24px; font-weight: 700; width: 100%; text-align: center;
            appearance: none; cursor: pointer;
        }
        .vs-glow {
            width: 80px; height: 80px; background: #2563eb; border-radius: 50%; display: flex;
            align-items: center; justify-content: center; font-size: 32px; font-weight: 800;
            box-shadow: 0 0 40px #3b82f6; margin: 0 10px;
        }
        .info-strip { display: flex; justify-content: space-between; margin-top: 24px; background: #0e1e36; border-radius: 36px; padding: 20px; border: 1px solid #2e5070; flex-wrap: wrap; }

        .formation-box { background: #0a1a32; border-radius: 32px; padding: 20px; margin-top: 24px; border: 1px solid #3b82f6; }
        .formation-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; margin-top: 16px; }
        .player-spot { background: #1e3a5a; border-radius: 40px; padding: 12px; text-align: center; border: 1px solid #60a5fa; font-size: 13px; }

        .player-pool { background: #0a1a30; border-radius: 36px; padding: 26px; border: 1px solid #38bdf8; max-height: 550px; overflow-y: auto; }
        .player-card { display: flex; justify-content: space-between; align-items: center; background: #102c44; border-radius: 30px; padding: 12px 20px; margin-bottom: 10px; flex-wrap: wrap; }
        .player-stats { font-size: 12px; color: #aad0ff; margin-left: 10px; }
        .mini-chart { display: inline-block; width: 60px; height: 24px; margin-left: 10px; }

        .odds-table { width: 100%; border-collapse: collapse; margin-top: 16px; }
        .odds-table td { padding: 12px; border-bottom: 1px solid #1e3a5a; }

        .btn-prophecy {
            background: linear-gradient(145deg, #7e22ce, #3b82f6, #0ea5e9); border: none;
            padding: 24px 50px; border-radius: 80px; color: white; font-size: 30px; font-weight: 700;
            display: flex; align-items: center; justify-content: center; gap: 20px; width: 100%;
            box-shadow: 0 20px 40px #3b82f6; cursor: pointer; transition: 0.2s; border: 1px solid #fff;
            margin-top: 30px;
        }
        .loading-ultimate { display: none; margin-top: 20px; }

        .accuracy-dashboard { display: flex; gap: 24px; margin-top: 24px; background: #0e1e38; border-radius: 32px; padding: 24px; border: 1px solid #ffd966; flex-wrap: wrap; }
        .metric-item { flex: 1; text-align: center; min-width: 120px; }
        .metric-value { font-size: 32px; font-weight: 800; color: #ffd966; }
        .metric-label { font-size: 14px; color: #b0d0ff; margin-top: 6px; }

        .prob-bar-container { display: flex; gap: 8px; margin: 20px 0; align-items: center; }
        .prob-bar-item { flex: 1; display: flex; flex-direction: column; align-items: center; }
        .prob-bar-bg { width: 100%; height: 16px; background: #1e3a5a; border-radius: 20px; overflow: hidden; }
        .prob-bar-fill { height: 100%; width: 0%; transition: width 0.3s; }
        .prob-value { font-size: 20px; font-weight: 700; margin-top: 6px; }

        .asian-handicap { background: #0e1e38; border-radius: 24px; padding: 20px; margin-top: 20px; }
        .advanced-metrics-grid { display: grid; grid-template-columns: repeat(4,1fr); gap: 20px; margin-top: 30px; }
        .metric-card { background: #0e1e36; border-radius: 24px; padding: 20px; border: 1px solid #3b82f6; }

        .heatmap-canvas-sm { width: 100%; height: 100px; background: #0a1428; border-radius: 16px; margin-top: 12px; }
        .referee-detail { display: flex; justify-content: space-between; margin-top: 12px; flex-wrap: wrap; }

        .live-commentary { background: #0a1a32; border-radius: 32px; padding: 24px; margin-top: 30px; border: 1px solid #38bdf8; max-height: 250px; overflow-y: auto; }
        .commentary-item { padding: 8px 0; border-bottom: 1px solid #1e3a5a; color: #c0e0ff; font-size: 15px; }

        .slider-panel { background: #0e1e38; border-radius: 32px; padding: 24px; margin-top: 30px; display: grid; grid-template-columns: repeat(3,1fr); gap: 30px; }
        .slider-item { display: flex; flex-direction: column; gap: 10px; }
        .slider-label { display: flex; justify-content: space-between; }
        input[type=range] { width: 100%; height: 8px; background: #1e3a5a; border-radius: 10px; -webkit-appearance: none; appearance: none; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 22px; height: 22px; background: #ffd966; border-radius: 50%; cursor: pointer; box-shadow: 0 0 15px #fbbf24; border: 2px solid white; }

        .sentiment-gauge { background: #0a1a30; border-radius: 32px; padding: 24px; margin-top: 30px; display: flex; align-items: center; justify-content: space-around; flex-wrap: wrap; }
        .gauge-item { text-align: center; margin: 8px; }
        .gauge-bar-bg { width: 120px; height: 12px; background: #1e3a5a; border-radius: 20px; margin-top: 8px; }
        .gauge-bar-fill { height: 12px; background: #3b82f6; border-radius: 20px; width: 0%; }

        .pass-network { background: #0a1a30; border-radius: 32px; padding: 24px; margin-top: 30px; }
        .network-canvas { width: 100%; height: 200px; background: #0a1428; border-radius: 24px; margin-top: 16px; }

        .matchup-card { background: #0e1e38; border-radius: 28px; padding: 20px; margin-top: 20px; display: flex; gap: 24px; flex-wrap: wrap; }
        .matchup-item { flex: 1; min-width: 200px; background: #102c44; border-radius: 24px; padding: 16px; display: flex; align-items: center; gap: 16px; }

        .standing-table { background: #0a1a30; border-radius: 28px; padding: 20px; margin-top: 30px; }
        .standing-row { display: flex; justify-content: space-between; padding: 8px 12px; border-bottom: 1px solid #1e3a5a; }

        .history-predictions { background: #0e1e38; border-radius: 32px; padding: 24px; margin-top: 30px; display: flex; gap: 16px; overflow-x: auto; }
        .history-card { background: #102c44; border-radius: 24px; padding: 16px; min-width: 160px; border-left: 6px solid #3b82f6; }

        .bench-panel { display: flex; gap: 16px; margin-top: 16px; overflow-x: auto; padding-bottom: 8px; }
        .bench-player { background: #1e3a5a; border-radius: 30px; padding: 8px 18px; white-space: nowrap; }

        .footer { margin-top: 50px; display: flex; justify-content: space-between; color: #6fa3b0; border-top: 1px solid #1e3f5a; padding-top: 28px; flex-wrap: wrap; }
        .confidence-tag { background: #1e3a5a; border-radius: 40px; padding: 8px 20px; display: inline-block; }
    </style>
</head>
<body>
<div class="bg-grid"></div>
<div class="container">

    <!-- ========== è”èµ›åˆ‡æ¢æ ï¼ˆ22å¤§è”èµ›Â·328é˜Ÿï¼‰========== -->
    <div class="league-bar">
        <div class="league-selector" id="leagueSwitch">
            <button class="league-btn active" data-league="EPL">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ è‹±è¶…</button>
            <button class="league-btn" data-league="LALIGA">ğŸ‡ªğŸ‡¸ è¥¿ç”²</button>
            <button class="league-btn" data-league="SERIEA">ğŸ‡®ğŸ‡¹ æ„ç”²</button>
            <button class="league-btn" data-league="BUNDES">ğŸ‡©ğŸ‡ª å¾·ç”²</button>
            <button class="league-btn" data-league="LIGUE1">ğŸ‡«ğŸ‡· æ³•ç”²</button>
            <button class="league-btn" data-league="CHAMPIONSHIP">ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿ è‹±å† </button>
            <button class="league-btn" data-league="PRIMEIRA">ğŸ‡µğŸ‡¹ è‘¡è¶…</button>
            <button class="league-btn" data-league="EREDIVISIE">ğŸ‡³ğŸ‡± è·ç”²</button>
            <button class="league-btn" data-league="RUSSIAN">ğŸ‡·ğŸ‡º ä¿„è¶…</button>
            <button class="league-btn" data-league="TURKISH">ğŸ‡¹ğŸ‡· åœŸè¶…</button>
            <button class="league-btn" data-league="SCOTTISH">ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿ è‹è¶…</button>
            <button class="league-btn" data-league="BELGIAN">ğŸ‡§ğŸ‡ª æ¯”ç”²</button>
            <button class="league-btn" data-league="AUSTRIAN">ğŸ‡¦ğŸ‡¹ å¥¥è¶…</button>
            <button class="league-btn" data-league="DANISH">ğŸ‡©ğŸ‡° ä¸¹è¶…</button>
            <button class="league-btn" data-league="NORWEGIAN">ğŸ‡³ğŸ‡´ æŒªè¶…</button>
            <button class="league-btn" data-league="SWEDISH">ğŸ‡¸ğŸ‡ª ç‘è¶…</button>
            <button class="league-btn" data-league="MLS">ğŸ‡ºğŸ‡¸ ç¾èŒè”</button>
            <button class="league-btn" data-league="CSL">ğŸ‡¨ğŸ‡³ ä¸­è¶…</button>
            <button class="league-btn" data-league="JLEAGUE">ğŸ‡¯ğŸ‡µ Jè”èµ›</button>
            <button class="league-btn" data-league="UCL">ğŸ† æ¬§å† </button>
            <button class="league-btn" data-league="WORLDCUP">ğŸŒ ä¸–ç•Œæ¯</button>
            <button class="league-btn" data-league="EURO">ğŸ‡ªğŸ‡º æ¬§æ´²æ¯</button>
        </div>
        <div class="global-badge">
            <i class="fas fa-database"></i> çƒé˜Ÿåº“: 328é˜Ÿ Â· <span id="countdownTimer">è·ç¦»å¼€èµ›: 2å¤© 03:22:15</span>
        </div>
    </div>

    <!-- ========== ä¸»ç½‘æ ¼ ========== -->
    <div class="grid-pro">
        <!-- å·¦ä¾§ï¼šæ¯”èµ›æ ¸å¿ƒ + æ•™ç»ƒè£åˆ¤ + é˜µå‹ + æ›¿è¡¥ -->
        <div>
            <div class="team-selector-pro">
                <div style="display: flex; align-items: center; justify-content: space-between;">
                    <div style="flex:1; text-align: center;">
                        <div class="team-badge-lg" id="homeBadge"><i class="fas fa-shield-halded"></i></div>
                        <select id="homeTeamPro" class="team-select-pro"></select>
                    </div>
                    <div class="vs-glow">VS</div>
                    <div style="flex:1; text-align: center;">
                        <div class="team-badge-lg" id="awayBadge"><i class="fas fa-shield"></i></div>
                        <select id="awayTeamPro" class="team-select-pro"></select>
                    </div>
                </div>
                <div class="info-strip" id="coachRefStrip"></div>
                <div class="formation-box">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <span><i class="fas fa-sitemap"></i> é¢„è®¡é˜µå‹ Â· <span id="homeFormation">4-3-3</span></span>
                        <span><i class="fas fa-sitemap"></i> é¢„è®¡é˜µå‹ Â· <span id="awayFormation">4-4-2</span></span>
                    </div>
                    <div class="formation-grid" id="homeFormationGrid"></div>
                    <div class="formation-grid" id="awayFormationGrid" style="margin-top:20px;"></div>
                    <!-- æ›¿è¡¥å¸­ -->
                    <div style="margin-top:24px;">
                        <span><i class="fas fa-users"></i> æ›¿è¡¥å¸­ Â· ä¸Šåœºæ¦‚ç‡</span>
                        <div class="bench-panel" id="homeBench"></div>
                        <div class="bench-panel" id="awayBench" style="margin-top:8px;"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸­é—´ï¼šçƒå‘˜è¯„åˆ†æ±  -->
        <div>
            <div class="player-pool">
                <div style="display: flex; gap: 16px; border-bottom: 1px solid #2563eb; padding-bottom: 16px; margin-bottom: 16px; align-items: center;">
                    <i class="fas fa-star" style="color:#ffd966;"></i>
                    <span style="font-size: 22px; font-weight: 600;">é¦–å‘åä¸€äºº Â· è¯„åˆ†/è·‘åŠ¨/çŠ¶æ€</span>
                    <span style="background: #2563eb; border-radius: 30px; padding: 4px 16px; font-size: 14px;">å«é—¨å°†xSaved</span>
                </div>
                <div id="playerRatingList"></div>
            </div>
            <div style="background: #0a1a30; border-radius: 32px; padding: 24px; margin-top: 24px;">
                <div style="display: flex; gap: 16px;"><i class="fas fa-clock-rotate-left"></i> å†å²äº¤é”‹ Â· è¿‘10åœº</div>
                <div id="h2hStats" style="margin-top: 16px;"></div>
            </div>
        </div>

        <!-- å³ä¾§ï¼šèµ”ç‡ + å¤©æ°” + å°„é—¨çƒ­åŒº -->
        <div>
            <div style="background: #0c1e36; border-radius: 36px; padding: 28px;">
                <div style="display: flex; gap: 16px; margin-bottom: 20px;">
                    <i class="fas fa-chart-line"></i> <span style="font-size: 20px;">4å¤§æœºæ„å®æ—¶èµ”ç‡</span>
                </div>
                <table class="odds-table" id="oddsComparison"></table>
            </div>
            <div style="background: #0e1e38; border-radius: 32px; padding: 26px; margin-top: 24px;">
                <div style="display: flex; gap: 16px;"><i class="fas fa-cloud-sun-rain"></i> æ¯”èµ›æ—¥å¤©æ°”</div>
                <div id="weatherDetail" style="margin-top: 16px;"></div>
                <canvas id="shotmapCanvas" class="heatmap-canvas-sm" style="height:150px;"></canvas>
            </div>
        </div>
    </div>

    <!-- ========== äºšç›˜/å¤§å°çƒ ========== -->
    <div class="asian-handicap">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <span><i class="fas fa-balance-scale"></i> äºšæ´²ç›˜å£ Â· å¤§å°çƒ</span>
            <span style="color: #eab308;" id="oddsUpdateHint">æ›´æ–°: èµ›å‰6h</span>
        </div>
        <div style="display: flex; gap: 40px; margin-top: 16px; flex-wrap: wrap;">
            <div><span style="color: #9cd;">è®©çƒç›˜</span><br><span style="font-size: 28px; font-weight: 700;" id="asianHandicap">-0.75</span><br><span style="color: #b0d0ff;">ä¸»é˜Ÿè®©åŠçƒ/ä¸€çƒ</span></div>
            <div><span style="color: #9cd;">å¤§å°çƒ</span><br><span style="font-size: 28px; font-weight: 700;" id="overUnder">2.75</span><br><span style="color: #b0d0ff;">å¤§çƒæ°´ä½ 0.92</span></div>
            <div><span style="color: #9cd;">é¢„æœŸæ€»è¿›çƒ</span><br><span style="font-size: 28px; font-weight: 700;" id="expectedTotal">2.8</span><br><span style="color: #b0d0ff;">æ¨¡å‹é¢„ä¼°</span></div>
        </div>
    </div>

    <!-- ========== è¿›é˜¶æŒ‡æ ‡ç½‘æ ¼ ========== -->
    <div class="advanced-metrics-grid">
        <div class="metric-card">
            <div class="metric-title"><i class="fas fa-futbol"></i> é¢„æœŸåŠ©æ”» (xA)</div>
            <div class="metric-main" id="xAHome">1.24</div>
            <div style="display: flex; justify-content: space-between; margin-top: 8px;">
                <span>ä¸»é˜Ÿ</span><span id="xAHomeDetail">1.24</span>
                <span>å®¢é˜Ÿ</span><span id="xAAwayDetail">0.87</span>
            </div>
        </div>
        <div class="metric-card">
            <div class="metric-title"><i class="fas fa-compress"></i> PPDA</div>
            <div class="metric-main" id="ppda">8.7</div>
            <div style="margin-top: 8px; color: #b0d0ff;">ä¸»é˜Ÿå‹è¿«å¼ºåº¦</div>
        </div>
        <div class="metric-card">
            <div class="metric-title"><i class="fas fa-bolt"></i> é«˜å‹å¼ºåº¦</div>
            <div class="metric-main" id="highPress">186</div>
            <div style="margin-top: 8px; color: #b0d0ff;">æˆåŠŸç‡41%</div>
        </div>
        <div class="metric-card">
            <div class="metric-title"><i class="fas fa-tint"></i> ç–²åŠ³æŒ‡æ•°</div>
            <div class="metric-main" id="fatigue">6.2</div>
            <div style="margin-top: 8px; color: #b0d0ff;">ä¸»5.8 / å®¢6.7</div>
        </div>
    </div>

    <!-- ========== çƒå‘˜çƒ­ç‚¹å›¾ + ä¼ çƒç½‘ç»œå›¾ ========== -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 30px;">
        <div style="background: #0a1a30; border-radius: 32px; padding: 24px;">
            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <i class="fas fa-map-marked-alt"></i> <span style="font-size: 20px;" id="homeStarName">å“ˆå…°å¾·</span> Â· è§¦çƒçƒ­ç‚¹
            </div>
            <canvas id="heatmapHome" class="heatmap-canvas-sm"></canvas>
        </div>
        <div style="background: #0a1a30; border-radius: 32px; padding: 24px;">
            <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <i class="fas fa-map-marked-alt"></i> <span style="font-size: 20px;" id="awayStarName">Bè´¹</span> Â· ä¼ çƒçƒ­ç‚¹
            </div>
            <canvas id="heatmapAway" class="heatmap-canvas-sm"></canvas>
        </div>
    </div>

    <!-- ä¼ çƒç½‘ç»œå›¾ -->
    <div class="pass-network">
        <div style="display: flex; gap: 12px; align-items: center;">
            <i class="fas fa-share-nodes"></i> <span style="font-size: 20px;">ä¼ çƒç½‘ç»œ Â· å…³é”®è¿çº¿</span>
            <span style="background: #2563eb; border-radius: 30px; padding: 4px 16px;">ä¸»é˜Ÿ / å®¢é˜Ÿ</span>
        </div>
        <canvas id="passNetworkCanvas" class="network-canvas"></canvas>
    </div>

    <!-- ========== è£åˆ¤è¯¦ç»†æ•°æ® ========== -->
    <div style="background: #0e1e38; border-radius: 32px; padding: 24px; margin-top: 30px;">
        <div style="display: flex; gap: 16px; align-items: center; flex-wrap: wrap;">
            <i class="fas fa-whistle" style="font-size: 28px;"></i>
            <span style="font-size: 24px; font-weight: 600;" id="refName">å®‰ä¸œå°¼Â·æ³°å‹’</span>
            <span style="background: #1e3a5a; padding: 6px 20px; border-radius: 40px;">æ‰§æ³•é£æ ¼: ä¸¥æ ¼</span>
        </div>
        <div class="referee-detail">
            <div>ğŸŸ¨ åœºå‡é»„ç‰Œ <span id="refYellow">4.2</span></div>
            <div>ğŸŸ¥ åœºå‡çº¢ç‰Œ <span id="refRed">0.3</span></div>
            <div>âš½ ç‚¹çƒå€¾å‘ <span id="refPenalty">0.22</span>/åœº</div>
            <div>ğŸ“Š çŠ¯è§„å°ºåº¦ <span id="refFoul">23.4</span>/åœº</div>
        </div>
    </div>

    <!-- ========== å¯¹ä½ä¼˜åŠ¿åˆ†æ ========== -->
    <div class="matchup-card" id="matchupAnalysis"></div>

    <!-- ========== è‡ªå®šä¹‰æ»‘å— ========== -->
    <div class="slider-panel">
        <div class="slider-item">
            <div class="slider-label"><span style="color:#9cd;">è¿›æ”»æƒé‡</span><span id="attackWeightVal" style="color:#ffd966;">0.65</span></div>
            <input type="range" id="attackWeight" min="0" max="1" step="0.01" value="0.65">
        </div>
        <div class="slider-item">
            <div class="slider-label"><span style="color:#9cd;">é˜²å®ˆæƒé‡</span><span id="defenseWeightVal" style="color:#ffd966;">0.55</span></div>
            <input type="range" id="defenseWeight" min="0" max="1" step="0.01" value="0.55">
        </div>
        <div class="slider-item">
            <div class="slider-label"><span style="color:#9cd;">ä¸»åœºåŠ æˆ</span><span id="homeBoostVal" style="color:#ffd966;">0.20</span></div>
            <input type="range" id="homeBoost" min="0" max="0.5" step="0.01" value="0.20">
        </div>
    </div>

    <!-- ========== ç¤¾äº¤åª’ä½“èˆ†æƒ…æŒ‡æ•° + ç”¨æˆ·æŠ•ç¥¨ ========== -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 30px;">
        <div class="sentiment-gauge" style="margin-top:0;">
            <div class="gauge-item">
                <span><i class="fas fa-hashtag"></i> ä¸»é˜Ÿæ”¯æŒ</span>
                <div style="font-size: 36px; font-weight: 800; color: #3b82f6;" id="homeSentiment">78%</div>
                <div class="gauge-bar-bg"><div id="homeSentimentBar" class="gauge-bar-fill" style="width:78%;"></div></div>
            </div>
            <div class="gauge-item">
                <span>å¹³å±€å€¾å‘</span>
                <div style="font-size: 36px; font-weight: 800; color: #f59e0b;" id="drawSentiment">12%</div>
                <div class="gauge-bar-bg"><div id="drawSentimentBar" class="gauge-bar-fill" style="background:#f59e0b; width:12%;"></div></div>
            </div>
            <div class="gauge-item">
                <span>å®¢é˜Ÿæ”¯æŒ</span>
                <div style="font-size: 36px; font-weight: 800; color: #10b981;" id="awaySentiment">10%</div>
                <div class="gauge-bar-bg"><div id="awaySentimentBar" class="gauge-bar-fill" style="background:#10b981; width:10%;"></div></div>
            </div>
        </div>
        <!-- ç”¨æˆ·é¢„æµ‹æŠ•ç¥¨ -->
        <div style="background: #0a1a30; border-radius: 32px; padding: 24px; display: flex; flex-direction: column; justify-content: center;">
            <div style="display: flex; gap: 16px; align-items: center; margin-bottom: 16px;">
                <i class="fas fa-users"></i> <span style="font-size: 20px;">ç¤¾åŒºé¢„æµ‹æŠ•ç¥¨</span>
            </div>
            <div style="display: flex; gap: 16px; justify-content: space-around;">
                <div style="text-align:center;">
                    <button onclick="voteHome()" style="background:#3b82f6; border:none; color:white; padding:12px 24px; border-radius:40px; font-weight:600;"><i class="fas fa-thumbs-up"></i> ä¸»èƒœ</button>
                    <div style="margin-top:8px; color:#b0d0ff;" id="voteHomeCount">2.1k</div>
                </div>
                <div style="text-align:center;">
                    <button onclick="voteDraw()" style="background:#f59e0b; border:none; color:white; padding:12px 24px; border-radius:40px; font-weight:600;"><i class="fas fa-hand"></i> å¹³å±€</button>
                    <div style="margin-top:8px; color:#b0d0ff;" id="voteDrawCount">0.9k</div>
                </div>
                <div style="text-align:center;">
                    <button onclick="voteAway()" style="background:#10b981; border:none; color:white; padding:12px 24px; border-radius:40px; font-weight:600;"><i class="fas fa-thumbs-down"></i> å®¢èƒœ</button>
                    <div style="margin-top:8px; color:#b0d0ff;" id="voteAwayCount">0.5k</div>
                </div>
            </div>
        </div>
    </div>

    <!-- ========== ç¥è°•é¢„æµ‹æŒ‰é’® ========== -->
    <button class="btn-prophecy" onclick="ultimatePrediction()">
        <i class="fas fa-crystal-ball"></i> ç»ˆææ¨æ¼” Â· å…¨ç»´æ¨¡æ‹Ÿ
        <span style="background: #ffffff30; padding: 8px 24px; border-radius: 60px; font-size: 20px;">60+ç»´ç‰¹å¾</span>
    </button>
    <div id="globalLoading" class="loading-ultimate">
        <div style="width:100%; height:14px; background:#142c44; border-radius:20px;">
            <div id="globalProgress" style="width:0%; height:14px; background:linear-gradient(90deg,#00ffe0,#3b82f6); border-radius:20px;"></div>
        </div>
        <div style="margin-top: 16px; color: #b0f0ff; text-align: center;" id="featureImportance">
            âš™ï¸ è´å¶æ–¯èåˆ Â· 48æ¨¡å‹æŠ•ç¥¨ä¸­ Â· 328é˜ŸåŠ¨æ€ç”Ÿæˆ
        </div>
    </div>

    <!-- ========== é¢„æµ‹ç»“æœæ——èˆ°é¢æ¿ ========== -->
    <div id="resultFlagship" style="display:none; margin-top: 36px; background: #0a1430; border-radius: 48px; padding: 36px; border: 2px solid #ffd966;">
        <div style="display: flex; align-items: center; justify-content: space-between; flex-wrap: wrap;">
            <div style="display:flex; align-items:center;"><span id="resultHomeName" style="font-size: 32px; font-weight: 700;"></span> <span id="resultHomeScore" style="font-size: 96px; font-weight: 800; color: #ffd966; margin-left: 30px;">2</span></div>
            <div style="font-size: 48px; color: #b0d0ff;">-</div>
            <div style="display:flex; align-items:center;"><span id="resultAwayScore" style="font-size: 96px; font-weight: 800; color: #ffd966;">1</span> <span id="resultAwayName" style="font-size: 32px; font-weight: 700; margin-left: 30px;"></span></div>
        </div>
        <div style="display: flex; gap: 20px; margin-top: 16px; justify-content: center; flex-wrap: wrap;">
            <span class="confidence-tag"><i class="fas fa-chart-bar"></i> 68% CI: <span id="confidenceInterval68">[1-0, 3-1]</span></span>
            <span class="confidence-tag"><i class="fas fa-chart-bar"></i> 95% CI: <span id="confidenceInterval95">[0-0, 4-2]</span></span>
        </div>
        <!-- èƒœå¹³è´Ÿæ¦‚ç‡æ¡ -->
        <div style="margin-top: 32px;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                <span style="color:#3b82f6;">ä¸»èƒœ</span><span style="color:#f59e0b;">å¹³å±€</span><span style="color:#10b981;">å®¢èƒœ</span>
            </div>
            <div class="prob-bar-container">
                <div class="prob-bar-item"><div class="prob-bar-bg"><div id="winProbFill" class="prob-bar-fill" style="background:#3b82f6;"></div></div><span id="winProbValue" class="prob-value">62%</span></div>
                <div class="prob-bar-item"><div class="prob-bar-bg"><div id="drawProbFill" class="prob-bar-fill" style="background:#f59e0b;"></div></div><span id="drawProbValue" class="prob-value">23%</span></div>
                <div class="prob-bar-item"><div class="prob-bar-bg"><div id="lossProbFill" class="prob-bar-fill" style="background:#10b981;"></div></div><span id="lossProbValue" class="prob-value">15%</span></div>
            </div>
        </div>
        <!-- ç²¾å‡†æ€§ä»ªè¡¨ç›˜ -->
        <div class="accuracy-dashboard">
            <div class="metric-item"><div class="metric-value" id="modelAUC">0.94</div><div class="metric-label">AUC</div></div>
            <div class="metric-item"><div class="metric-value" id="brierScore">0.082</div><div class="metric-label">Brier</div></div>
            <div class="metric-item"><div class="metric-value" id="historyAcc">74.3%</div><div class="metric-label">è¿‘10åœºå‡†ç¡®ç‡</div></div>
            <div class="metric-item"><div class="metric-value" id="logLoss">0.38</div><div class="metric-label">LogLoss</div></div>
        </div>
        <!-- èµ›äº‹å‰ç» -->
        <div style="margin-top: 24px; background: #102c44; border-radius: 28px; padding: 20px;">
            <i class="fas fa-file-lines"></i> èµ›äº‹å‰ç»: <span id="matchPreview"></span>
        </div>
    </div>

    <!-- ========== å®æ—¶æ–‡å­—ç›´æ’­ ========== -->
    <div class="live-commentary">
        <div style="display: flex; gap: 12px; border-bottom: 1px solid #3b82f6; padding-bottom: 12px; align-items: center;">
            <i class="fas fa-broadcast-tower" style="color:#ff6b6b;"></i>
            <span style="font-size: 20px; font-weight: 600;">å®æ—¶æ–‡å­—ç›´æ’­ Â· AIæ¨¡æ‹Ÿ</span>
            <span style="background: #2563eb; padding: 4px 16px; border-radius: 30px;">LIVE</span>
        </div>
        <div id="commentaryContent" style="margin-top: 16px; max-height: 180px; overflow-y: auto;"></div>
    </div>

    <!-- ========== è”èµ›ç§¯åˆ†æ¦œ ========== -->
    <div class="standing-table" id="leagueStanding"></div>

    <!-- ========== æœªæ¥èµ›ç¨‹å¯†åº¦ ========== -->
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 30px;">
        <div style="background: #0a1a30; border-radius: 28px; padding: 20px;">
            <div style="display:flex; gap:12px;"><i class="fas fa-calendar"></i> ä¸»é˜Ÿæœªæ¥7å¤©èµ›ç¨‹</div>
            <div id="homeSchedule" style="margin-top:12px;"></div>
        </div>
        <div style="background: #0a1a30; border-radius: 28px; padding: 20px;">
            <div style="display:flex; gap:12px;"><i class="fas fa-calendar"></i> å®¢é˜Ÿæœªæ¥7å¤©èµ›ç¨‹</div>
            <div id="awaySchedule" style="margin-top:12px;"></div>
        </div>
    </div>

    <!-- ========== å†å²é¢„æµ‹è®°å½• ========== -->
    <div style="margin-top: 30px;">
        <div style="display:flex; gap:16px; align-items:center; margin-bottom:16px;">
            <i class="fas fa-history"></i> <span style="font-size:20px;">æœ€è¿‘5æ¬¡é¢„æµ‹è®°å½•</span>
        </div>
        <div class="history-predictions" id="historyPredictions"></div>
    </div>

    <!-- ========== åº•éƒ¨ä¿¡æ¯ ========== -->
    <div class="footer">
        <span>Â© 2026 football-predict.top Â· æ®¿å ‚ç»ˆææ‰©å®¹ Â· 328é˜Ÿ Â· 6000+åŠ¨æ€çƒå‘˜</span>
        <span><i class="fas fa-check-circle"></i> ç§»åŠ¨ç«¯ä¼˜åŒ– Â· å…¨é‡è”èµ›</span>
    </div>
</div>

<script>
    // =================  è¶³çƒé¢„è¨€å®¶ Â· æ®¿å ‚ç»ˆææ‰©å®¹ç‰ˆ ==================
    // ---------- è”èµ›æ•°æ®åº“Â·å…¨é‡328é˜Ÿï¼ˆ22å¤§è”èµ›ï¼‰----------
    const leagueDB = {
        EPL: { name: 'è‹±è¶…', teams: [
            'æ›¼åŸ', 'æ›¼è”', 'åˆ©ç‰©æµ¦', 'é˜¿æ£®çº³', 'åˆ‡å°”è¥¿', 'çƒ­åˆº', 'çº½å¡æ–¯å°”', 'é˜¿æ–¯é¡¿ç»´æ‹‰', 'å¸ƒè±é¡¿', 'è¥¿æ±‰å§†è”',
            'å¸ƒä¼¦ç‰¹ç¦å¾·', 'æ°´æ™¶å®«', 'ç‹¼é˜Ÿ', 'ä¼¯æ©èŒ…æ–¯', 'å¯Œå‹’å§†', 'åŸƒå¼—é¡¿', 'è¯ºä¸æ±‰æ£®æ—', 'è±æ–¯ç‰¹åŸ', 'å—å®‰æ™®é¡¿', 'ä¼Šæ™®æ–¯ç»´å¥‡'
        ], level: 'elite' },
        LALIGA: { name: 'è¥¿ç”²', teams: [
            'çš‡é©¬', 'å·´è¨', 'é©¬ç«', 'çš‡å®¶ç¤¾ä¼š', 'æ¯•å°”å·´é„‚', 'è´è’‚æ–¯', 'æ¯”åˆ©äºšé›·äºšå°”', 'ç“¦ä¼¦è¥¿äºš', 'å¡ç»´åˆ©äºš', 'èµ«ç½—çº³',
            'å¥¥è¨è‹çº³', 'å¡å°”å¡”', 'é˜¿æ‹‰ç»´æ–¯', 'å·´åˆ—å¡è¯º', 'æ‹‰æ–¯å¸•å°”é©¬æ–¯', 'é©¬æ´›å¡', 'èµ«å¡”è´¹', 'æ ¼æ‹‰çº³è¾¾', 'åŠ çš„æ–¯', 'é˜¿å°”æ¢…é‡Œäºš'
        ], level: 'elite' },
        SERIEA: { name: 'æ„ç”²', teams: [
            'å›½é™…ç±³å…°', 'ACç±³å…°', 'å°¤æ–‡å›¾æ–¯', 'é‚£ä¸å‹’æ–¯', 'ç½—é©¬', 'æ‹‰é½å¥¥', 'äºšç‰¹å…°å¤§', 'ä½›ç½—ä¼¦è¨', 'åšæ´›å°¼äºš', 'éƒ½çµ',
            'çƒ­é‚£äºš', 'è±åˆ‡', 'å¡åˆ©äºšé‡Œ', 'æ©æ³¢åˆ©', 'è¨ç´¢æ´›', 'ä¹Œè¿ªå†…æ–¯', 'è’™æ‰', 'å¼—ç½—è¥¿è¯ºå†…', 'ç»´ç½—çº³', 'è¨å‹’å°¼å¡”çº³'
        ], level: 'elite' },
        BUNDES: { name: 'å¾·ç”²', teams: [
            'æ‹œä»', 'å¤šç‰¹è’™å¾·', 'è±æ¯”é”¡', 'å‹’æ²ƒåº“æ£®', 'æ³•å…°å…‹ç¦', 'æ²ƒå°”å¤«æ–¯å ¡', 'å¼—èµ–å ¡', 'éœèŠ¬æµ·å§†', 'é—¨å…´', 'æ–¯å›¾åŠ ç‰¹',
            'æŸæ—è”åˆ', 'ä¸è±æ¢…', 'å¥¥æ ¼æ–¯å ¡', 'ç§‘éš†', 'ç¾å› èŒ¨', 'æ³¢é¸¿', 'è¾¾å§†æ–½å¡”ç‰¹', 'æµ·ç™»æµ·å§†'
        ], level: 'elite' },
        LIGUE1: { name: 'æ³•ç”²', teams: [
            'å·´é»åœ£æ—¥è€³æ›¼', 'é©¬èµ›', 'æ‘©çº³å“¥', 'é‡Œæ˜‚', 'é‡Œå°”', 'é›·æ©', 'å°¼æ–¯', 'æœ—æ–¯', 'æ–¯ç‰¹æ‹‰æ–¯å ¡', 'å—ç‰¹',
            'è’™å½¼åˆ©åŸƒ', 'å›¾å¢å…¹', 'å¸ƒé›·æ–¯ç‰¹', 'å…°æ–¯', 'å…‹è±è’™', 'å‹’é˜¿å¼—å°”', 'æ¢…æ–¯', 'æ´›é‡Œæ˜‚'
        ], level: 'elite' },
        CHAMPIONSHIP: { name: 'è‹±å† ', teams: [
            'ä¼¯æ©åˆ©', 'è°¢è²è”', 'å¢é¡¿', 'è¯ºç»´å¥‡', 'æ²ƒç‰¹ç¦å¾·', 'ç±³å ¡', 'è€ƒæ–‡å‚', 'æ™®é›·æ–¯é¡¿', 'è¥¿å¸ƒæœ—', 'æ¡‘å¾·å…°',
            'èµ«å°”åŸ', 'æ–¯æ‰˜å…‹åŸ', 'å¡è¿ªå¤«åŸ', 'æ–¯æ—ºè¥¿', 'å¥³ç‹å…¬å›­', 'ç±³å°”æ²ƒå°”', 'æ™®åˆ©èŒ…æ–¯', 'ç½—ç‘Ÿæ±‰å§†', 'å¸ƒè±å…‹æœ¬',
            'å¸ƒé‡Œæ–¯æ‰˜åŸ', 'é›·ä¸', 'ç»´å†ˆ', 'å“ˆå¾·æ–¯è²å°”å¾·'
        ], level: 'championship' },
        PRIMEIRA: { name: 'è‘¡è¶…', teams: [
            'æœ¬è²å¡', 'æ³¢å°”å›¾', 'è‘¡è„ç‰™ä½“è‚²', 'å¸ƒæ‹‰åŠ ', 'å‰é©¬è‰¯æ–¯', 'å‰ç»´æ£®ç‰¹', 'æ³•é©¬åˆ©åº·', 'è«é›·ä¼¦æ–¯', 'é˜¿ç½—å¡', 'å¡è¨çš®äºš',
            'åŸƒæ–¯æ‰˜é‡Œå°”', 'æ³•ä¼¦æ–¯', 'åšé˜¿ç»´æ–¯å¡”', 'é‡Œå¥¥é˜¿ç»´', 'ç»´å…¹æ‹‰', 'æ²™ç»´æ–¯', 'æ³¢å°”è’‚èŠ’äºº', 'é©¬é‡Œè¿ªè«'
        ], level: 'europe' },
        EREDIVISIE: { name: 'è·ç”²', teams: [
            'é˜¿è´¾å…‹æ–¯', 'è´¹è€¶è¯ºå¾·', 'åŸƒå› éœæ¸©', 'é˜¿å°”å…‹é©¬å°”', 'ç‰¹æ¸©ç‰¹', 'é¹¿ç‰¹ä¸¹æ–¯å·´è¾¾', 'ä¹Œå¾—å‹’æ”¯', 'æµ·ä¼¦èŠ¬', 'å¥ˆæ¢…äº¨', 'ç¦å›¾çº³',
            'ç»´ç‰¹æ–¯', 'ç“¦å°”éŸ¦å…‹', 'å‰è¿›ä¹‹é¹°', 'æ³½æ²ƒå‹’', 'é˜¿å°”æ¢…å‹’åŸ', 'èµ«æ‹‰å…‹å‹’æ–¯', 'åŸƒé—¨', 'åå¸ƒå°”'
        ], level: 'europe' },
        RUSSIAN: { name: 'ä¿„è¶…', teams: [
            'æ³½å°¼ç‰¹', 'è«æ–¯ç§‘ä¸­å¤®é™†å†›', 'è«æ–¯ç§‘è¿ªçº³æ‘©', 'è«æ–¯ç§‘ç«è½¦å¤´', 'è«æ–¯ç§‘æ–¯å·´è¾¾', 'å…‹æ‹‰æ–¯è¯ºè¾¾å°”', 'ç½—æ–¯æ‰˜å¤«', 'ç´¢å¥‘', 'æ ¼ç½—å…¹å°¼', 'ä¹Œæ‹‰å°”',
            'ä¸‹è¯ºå¤«å“¥ç½—å¾·', 'å–€å±±çº¢å®çŸ³', 'è‹ç»´åŸƒä¹‹ç¿¼', 'å¥¥ä¼¦å ¡', 'åŠ é‡Œå®æ ¼å‹’', 'æ²ƒç½—æ¶…æ—¥ç«ç‚¬'
        ], level: 'europe' },
        TURKISH: { name: 'åœŸè¶…', teams: [
            'åŠ æ‹‰å¡”è¨é›·', 'è´¹å†…å·´åˆ‡', 'è´è¥¿å…‹å¡”æ–¯', 'ç‰¹æ‹‰å¸ƒå®—ä½“è‚²', 'ä¼Šæ–¯å¦å¸ƒå°”', 'é˜¿è¾¾çº³å¾·ç±³å°”', 'é”¡ç“¦æ–¯ä½“è‚²', 'å¼€å¡åˆ©ä½“è‚²', 'å®‰å¡”åˆ©äºšä½“è‚²', 'åŠ æµå®‰æ³°æ™®',
            'ç§‘å°¼äºšä½“è‚²', 'é˜¿æ‹‰å°¼äºšä½“è‚²', 'é‡Œæ³½ä½“è‚²', 'ä»£ç±³å°”ä½“è‚²', 'å¡æ‹‰äº¬å•å…‹', 'ä½©è¿ªå¡ä½“è‚²', 'å“ˆæ³°ä½“è‚²', 'å®‰å¡æ‹‰å¤åº“', 'ä¼Šæ–¯å¦å¸ƒå°”ä½“è‚²'
        ], level: 'europe' },
        SCOTTISH: { name: 'è‹è¶…', teams: [
            'å‡¯å°”ç‰¹äºº', 'æµæµªè€…', 'å“ˆèŒ¨', 'é˜¿ä¼¯ä¸', 'å¸Œä¼¯å°¼å®‰', 'åˆ©æ–‡æ–¯é¡¿', 'åœ£ç±³ä¼¦', 'é©¬ç‘ŸéŸ¦å°”', 'ç½—æ–¯éƒ¡', 'é‚“è¿ªè”', 'åŸºå°”é©¬è¯ºå…‹', 'åœ£çº¦ç¿°æ–¯é€š'
        ], level: 'europe' },
        BELGIAN: { name: 'æ¯”ç”²', teams: [
            'å®‰å¾·è±èµ«ç‰¹', 'å¸ƒé²æ—¥', 'åœ£å‰ç½—æ–¯', 'æ ¹ç‰¹', 'å®‰ç‰¹å«æ™®', 'æ ‡å‡†åˆ—æ—¥', 'äº¨å…‹', 'å¥¥æ–¯å¦å¾·', 'ç§‘ç‰¹èµ–å…‹', 'æ¢…èµ«ä¼¦',
            'æ²™å‹’ç½—ç“¦', 'æ¬§æœ¬', 'éŸ¦æ–¯ç‰¹æ´›', 'å¡è±æ©', 'åœ£å›¾å°”ç™»', 'è«ä¼¦è´å…‹'
        ], level: 'europe' },
        AUSTRIAN: { name: 'å¥¥è¶…', teams: [
            'è¨å°”èŒ¨å ¡', 'ç»´ä¹Ÿçº³å¿«é€Ÿ', 'æ ¼æ‹‰èŒ¨é£æš´', 'æ—èŒ¨', 'å¥¥åœ°åˆ©ç»´ä¹Ÿçº³', 'æ²ƒå°”å¤«æ–¯è´æ ¼', 'å“ˆç‰¹è´æ ¼', 'é˜¿å°”å¡”å¥‡', 'ç“¦æ»•æ–¯', 'å…‹æ‹‰æ ¹ç¦', 'é‡Œå¾·', 'å¢æ–¯ç‰¹ç‘™'
        ], level: 'europe' },
        DANISH: { name: 'ä¸¹è¶…', teams: [
            'å“¥æœ¬å“ˆæ ¹', 'ç±³è¿ªå…°ç‰¹', 'å¸ƒéš†å¾·æ¯”', 'å¥¥å°”å ¡', 'é”¡å°”å…‹å ¡', 'åŒ—è¥¿å…°', 'ç»´å ¡', 'æ¬§ç™»å¡', 'å…°å¾·æ–¯', 'ç“¦åŸƒå‹’', 'çµæ¯”', 'éœæ£®æ–¯'
        ], level: 'europe' },
        NORWEGIAN: { name: 'æŒªè¶…', teams: [
            'åšå¤šæ ¼æ—ç‰¹', 'è«å°”å¾·', 'ç»´äº¬', 'å¸ƒå…°', 'ç½—æ£®åšæ ¼', 'åˆ©å‹’æ–¯ç‰¹ç½—å§†', 'å¥¥å‹’æ¾', 'æ¡‘çº³è²å°¤å°”', 'è¨æ™®æ–¯å ¡', 'æ–¯ç‰¹ç½—å§†åŠ æ–¯ç‰¹',
            'å¥¥å¾·', 'æ±‰å', 'æ–¯æ‰˜å§†åŠ æ–¯ç‰¹', 'å…‹é‡Œæ–¯è’‚å®‰æ¾', 'ç“¦å‹’ä¼¦åŠ ', 'æµ·äºæ ¼æ¾'
        ], level: 'europe' },
        SWEDISH: { name: 'ç‘è¶…', teams: [
            'é©¬å°”é»˜', 'åŸƒå°”å¤«æ–¯å ¡', 'ç´¢å°”çº³', 'ä½åŠ é¡¿æ–¯', 'èµ«æ ¹', 'åŒ—é›ªå¹³', 'å¡å°”é©¬', 'éŸ¦çº³ç©†', 'å“ˆé©¬æ¯”', 'ç±³äºšå°”æ¯”',
            'å“¥å¾·å ¡', 'ä»£æ ¼ç¦ä»€', 'ç“¦å°”è´é‡Œ', 'å¸ƒé²é©¬æ³¢å¡çº³', 'å„å‹’å¸ƒé²', 'å„æ–¯ç‰¹æ¾å¾·'
        ], level: 'europe' },
        MLS: { name: 'ç¾èŒè”', teams: [
            'è¿ˆé˜¿å¯†å›½é™…', 'æ´›æ‰çŸ¶FC', 'çº½çº¦åŸ', 'çº½çº¦çº¢ç‰›', 'äºšç‰¹å…°å¤§è”', 'è¥¿é›…å›¾æµ·æ¹¾äºº', 'å¥¥å…°å¤šåŸ', 'å¤šä¼¦å¤šFC', 'æ¸©å“¥åç™½å¸½', 'æ³¢ç‰¹å…°ä¼æœ¨å·¥',
            'å“¥ä¼¦å¸ƒæœºå‘˜', 'è´¹åŸè”åˆ', 'æ–°è‹±æ ¼å…°é©å‘½', 'èŠåŠ å“¥ç«ç„°', 'åœ£ä½•å¡åœ°éœ‡', 'æ´›æ‰çŸ¶é“¶æ²³', 'å ªè¨æ–¯åŸ', 'è¾¾æ‹‰æ–¯FC', 'ä¼‘æ–¯é¡¿è¿ªçº³æ‘©', 'è’™ç‰¹åˆ©å°”å†²å‡»',
            'ç§‘ç½—æ‹‰å¤šæ€¥æµ', 'çš‡å®¶ç›æ¹–åŸ', 'æ˜å°¼è‹è¾¾è”', 'çº³ä»€ç»´å°”SC', 'è¾›è¾›é‚£æFC', 'å¥¥æ–¯æ±€FC', 'å¤æ´›ç‰¹FC', 'åœ£è·¯æ˜“æ–¯åŸ'
        ], level: 'mls' },
        CSL: { name: 'ä¸­è¶…', teams: [
            'ä¸Šæµ·æµ·æ¸¯', 'å±±ä¸œæ³°å±±', 'æµ™æ±Ÿé˜Ÿ', 'æˆéƒ½è“‰åŸ', 'æ­¦æ±‰ä¸‰é•‡', 'åŒ—äº¬å›½å®‰', 'ä¸Šæµ·ç”³èŠ±', 'é•¿æ˜¥äºšæ³°', 'å¤©æ´¥æ´¥é—¨è™', 'æ²³å—é˜Ÿ',
            'é’å²›æµ·ç‰›', 'æ²§å·é›„ç‹®', 'å—é€šæ”¯äº‘', 'æ·±åœ³é˜Ÿ', 'æ¢…å·å®¢å®¶', 'å¤§è¿äºº'
        ], level: 'asia' },
        JLEAGUE: { name: 'Jè”èµ›', teams: [
            'ç¥æˆ·èƒœåˆ©èˆ¹', 'æ¨ªæ»¨æ°´æ‰‹', 'å¹¿å²›ä¸‰ç®­', 'æµ¦å’Œçº¢é’»', 'é¹¿å²›é¹¿è§’', 'åå¤å±‹é²¸', 'å¤§é˜ªæ¨±èŠ±', 'ç¦å†ˆé»„èœ‚', 'å·å´å‰é”‹', 'ä¸œäº¬FC',
            'æœ­å¹Œå†ˆè¨å¤š', 'æ¹˜å—æ¯”é©¬', 'æ–°æ½Ÿå¤©é¹…', 'äº¬éƒ½ä¸æ­»é¸Ÿ', 'æŸå¤ªé˜³ç¥', 'é¸Ÿæ –ç ‚å²©', 'å¤§é˜ªé’¢å·´', 'æ¨ªæ»¨FC'
        ], level: 'asia' },
        UCL: { name: 'æ¬§å† ', teams: [
            'æ›¼åŸ', 'çš‡é©¬', 'æ‹œä»', 'å·´é»', 'å›½é™…ç±³å…°', 'é˜¿æ£®çº³', 'åˆ©ç‰©æµ¦', 'å·´è¨', 'å¤šç‰¹è’™å¾·', 'é©¬ç«',
            'æ³¢å°”å›¾', 'é‚£ä¸å‹’æ–¯', 'è±æ¯”é”¡', 'å¡ç»´åˆ©äºš', 'ACç±³å…°', 'å‹’æ²ƒåº“æ£®'
        ], level: 'elite' },
        WORLDCUP: { name: 'ä¸–ç•Œæ¯', teams: [
            'å·´è¥¿', 'é˜¿æ ¹å»·', 'æ³•å›½', 'å¾·å›½', 'è¥¿ç­ç‰™', 'è‹±æ ¼å…°', 'è‘¡è„ç‰™', 'è·å…°', 'æ¯”åˆ©æ—¶', 'æ„å¤§åˆ©',
            'ä¹Œæ‹‰åœ­', 'å…‹ç½—åœ°äºš', 'æ‘©æ´›å“¥', 'æ—¥æœ¬', 'éŸ©å›½', 'ç¾å›½'
        ], level: 'national' },
        EURO: { name: 'æ¬§æ´²æ¯', teams: [
            'æ³•å›½', 'å¾·å›½', 'è¥¿ç­ç‰™', 'æ„å¤§åˆ©', 'è‹±æ ¼å…°', 'è‘¡è„ç‰™', 'è·å…°', 'æ¯”åˆ©æ—¶', 'å…‹ç½—åœ°äºš', 'å¥¥åœ°åˆ©',
            'åœŸè€³å…¶', 'ä¸¹éº¦', 'ç‘å…¸', 'ç‘å£«', 'æ³¢å…°', 'æ·å…‹'
        ], level: 'national' }
    };

    // ---------- åŠ¨æ€çƒå‘˜åº“ç”Ÿæˆå™¨ï¼ˆ328é˜Ÿ Ã— 18äººï¼‰----------
    const playerCache = {};

    function generateTeamPlayers(teamName, level = 'elite') {
        let baseRating;
        switch(level) {
            case 'elite': baseRating = 82; break;
            case 'championship': baseRating = 74; break;
            case 'europe': baseRating = 78; break;
            case 'mls': baseRating = 72; break;
            case 'asia': baseRating = 70; break;
            case 'national': baseRating = 80; break;
            default: baseRating = 75;
        }
        const positions = ['GK', 'DF', 'DF', 'DF', 'DF', 'MF', 'MF', 'MF', 'FW', 'FW', 'FW', 'DF', 'MF', 'FW', 'GK', 'MF', 'DF', 'FW'];
        const firstNames = ['è©¹å§†æ–¯', 'é©¬ä¿®', 'å¢å¡', 'äºšå†å±±å¤§', 'å¤§å«', 'è¿ˆå…‹å°”', 'æ‰˜é©¬æ–¯', 'ä¸¹å°¼å°”', 'å¥¥åˆ©å¼—', 'å“ˆé‡Œ'];
        const lastNames = ['å¸­å°”ç“¦', 'æ¡‘æ‰˜æ–¯', 'è´¹å°”å—å¾·æ–¯', 'å†ˆè¨é›·æ–¯', 'ç©†å‹’', 'çº¦ç¿°é€Š', 'å¨å»‰å§†æ–¯', 'å¸ƒæœ—', 'ç¼æ–¯', 'åŠ è¥¿äºš'];
        let players = [];
        for (let i = 0; i < 18; i++) {
            let rating = baseRating + Math.floor(Math.random() * 12) - 4;
            rating = Math.min(Math.max(rating, 60), 96);
            let pos = positions[i] || 'MF';
            let fn = firstNames[Math.floor(Math.random() * firstNames.length)];
            let ln = lastNames[Math.floor(Math.random() * lastNames.length)];
            players.push(`${fn} ${ln} ${rating}`);
        }
        return players;
    }

    function getTeamPlayers(teamName, level) {
        const key = teamName + '_' + level;
        if (!playerCache[key]) {
            playerCache[key] = generateTeamPlayers(teamName, level);
        }
        return playerCache[key];
    }

    // ---------- å…¨å±€å˜é‡ ----------
    let currentLeague = 'EPL';
    let accChart;
    let historyPredictionsArray = [];
    let voteHome = 2100, voteDraw = 900, voteAway = 500;

    // ---------- é¡µé¢åˆå§‹åŒ– ----------
    window.onload = function() {
        populateTeams();
        setupLeagueListeners();
        refreshAllInfo();
        initHeatmaps();
        initPassNetwork();
        initAccuracyChart();
        updateAdvancedMetrics();
        updateRefereeStats();
        updateSliderDisplay();
        updateSentiment();
        updateVoteDisplay();
        startCountdown();
        startOddsTimer();
        updateStandings();
        updateFutureSchedule();
        loadHistoryPredictions();
        updateBench();
        updateMatchupAnalysis();
        document.getElementById('attackWeight').addEventListener('input', function() {
            document.getElementById('attackWeightVal').innerText = this.value;
        });
        document.getElementById('defenseWeight').addEventListener('input', function() {
            document.getElementById('defenseWeightVal').innerText = this.value;
        });
        document.getElementById('homeBoost').addEventListener('input', function() {
            document.getElementById('homeBoostVal').innerText = this.value;
        });
    };

    // ---------- è”èµ›åˆ‡æ¢ ----------
    function setupLeagueListeners() {
        const btns = document.querySelectorAll('.league-btn');
        btns.forEach(btn => {
            btn.addEventListener('click', function() {
                btns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentLeague = this.dataset.league;
                populateTeams();
                refreshAllInfo();
                updateStandings();
                updateFutureSchedule();
            });
        });
    }

    function populateTeams() {
        const league = leagueDB[currentLeague];
        const teams = league.teams;
        const homeSelect = document.getElementById('homeTeamPro');
        const awaySelect = document.getElementById('awayTeamPro');
        homeSelect.innerHTML = ''; awaySelect.innerHTML = '';
        teams.forEach(t => {
            homeSelect.innerHTML += `<option value="${t}">${t}</option>`;
            awaySelect.innerHTML += `<option value="${t}">${t}</option>`;
        });
        if (homeSelect.value === awaySelect.value) {
            awaySelect.selectedIndex = (awaySelect.selectedIndex + 1) % awaySelect.length;
        }
        let badge = 'ğŸ´';
        if (currentLeague.includes('LALIGA')) badge = 'ğŸ‡ªğŸ‡¸';
        else if (currentLeague.includes('SERIEA')) badge = 'ğŸ‡®ğŸ‡¹';
        else if (currentLeague.includes('BUNDES')) badge = 'ğŸ‡©ğŸ‡ª';
        else if (currentLeague.includes('LIGUE1')) badge = 'ğŸ‡«ğŸ‡·';
        else if (currentLeague.includes('CHAMPIONSHIP')) badge = 'ğŸ´ó §ó ¢ó ¥ó ®ó §ó ¿';
        else if (currentLeague.includes('PRIMEIRA')) badge = 'ğŸ‡µğŸ‡¹';
        else if (currentLeague.includes('EREDIVISIE')) badge = 'ğŸ‡³ğŸ‡±';
        else if (currentLeague.includes('RUSSIAN')) badge = 'ğŸ‡·ğŸ‡º';
        else if (currentLeague.includes('TURKISH')) badge = 'ğŸ‡¹ğŸ‡·';
        else if (currentLeague.includes('SCOTTISH')) badge = 'ğŸ´ó §ó ¢ó ³ó £ó ´ó ¿';
        else if (currentLeague.includes('BELGIAN')) badge = 'ğŸ‡§ğŸ‡ª';
        else if (currentLeague.includes('AUSTRIAN')) badge = 'ğŸ‡¦ğŸ‡¹';
        else if (currentLeague.includes('DANISH')) badge = 'ğŸ‡©ğŸ‡°';
        else if (currentLeague.includes('NORWEGIAN')) badge = 'ğŸ‡³ğŸ‡´';
        else if (currentLeague.includes('SWEDISH')) badge = 'ğŸ‡¸ğŸ‡ª';
        else if (currentLeague.includes('MLS')) badge = 'ğŸ‡ºğŸ‡¸';
        else if (currentLeague.includes('CSL')) badge = 'ğŸ‡¨ğŸ‡³';
        else if (currentLeague.includes('JLEAGUE')) badge = 'ğŸ‡¯ğŸ‡µ';
        else if (currentLeague.includes('UCL')) badge = 'ğŸ†';
        else if (currentLeague.includes('WORLDCUP')) badge = 'ğŸŒ';
        else if (currentLeague.includes('EURO')) badge = 'ğŸ‡ªğŸ‡º';
        document.getElementById('homeBadge').innerHTML = badge;
        document.getElementById('awayBadge').innerHTML = badge;
    }

    function refreshAllInfo() {
        const home = document.getElementById('homeTeamPro').value;
        const away = document.getElementById('awayTeamPro').value;
        const homeLevel = leagueDB[currentLeague].level;
        const awayLevel = leagueDB[currentLeague].level;
        updateCoachReferee(home, away);
        updateFormations(home, away);
        updatePlayerRatings(home, away, homeLevel, awayLevel);
        updateH2H(home, away);
        updateOdds();
        updateWeather();
        updateMatchPreview(home, away);
        updateAdvancedMetrics();
        updateRefereeStats();
        updateHeatmapNames(home, away);
        updateSentiment();
        updateBench();
        updateMatchupAnalysis();
    }

    function updateCoachReferee(home, away) {
        const coaches = ['ç“œè¿ªå¥¥æ‹‰', 'å…‹æ´›æ™®', 'å®‰åˆ‡æ´›è’‚', 'è¥¿è’™å°¼', 'é˜¿å°”ç‰¹å¡”', 'æ»•å“ˆèµ«', 'æ³¢åˆ‡è’‚è¯º', 'è«å¡”', 'å°å› æ‰å‰'];
        const refs = ['å®‰ä¸œå°¼Â·æ³°å‹’', 'é©¬é½å°¼äºšå…‹', 'å¥¥åˆ©å¼—', 'è’‚å°”æ½˜', 'æ‹‰å¥¥æ–¯', 'æ¸©å¥‘å¥‡'];
        const homeCoach = coaches[Math.floor(Math.random() * coaches.length)];
        const awayCoach = coaches[Math.floor(Math.random() * coaches.length)];
        const ref = refs[Math.floor(Math.random() * refs.length)];
        const homeValue = (Math.random() * 5 + 3).toFixed(2);
        const awayValue = (Math.random() * 4 + 2).toFixed(2);
        document.getElementById('coachRefStrip').innerHTML = `
            <div><i class="fas fa-user-tie"></i> ${home}æ•™ç»ƒ: ${homeCoach}<br><small>èƒœç‡${Math.floor(Math.random()*20+50)}%</small></div>
            <div><i class="fas fa-user-tie"></i> ${away}æ•™ç»ƒ: ${awayCoach}<br><small>èƒœç‡${Math.floor(Math.random()*20+45)}%</small></div>
            <div><i class="fas fa-whistle"></i> è£åˆ¤: ${ref}<br><small style="color:#9cd;">${Math.random()>0.5?'ä¸¥æ ¼':'å®½æ¾'}</small></div>
            <div><i class="fas fa-coins"></i> èº«ä»·: â‚¬${homeValue}äº¿ / â‚¬${awayValue}äº¿</div>
        `;
    }

    function updateFormations(home, away) {
        const formations = ['4-3-3', '4-4-2', '3-5-2', '4-2-3-1', '3-4-3'];
        const homeForm = formations[Math.floor(Math.random() * formations.length)];
        const awayForm = formations[Math.floor(Math.random() * formations.length)];
        document.getElementById('homeFormation').innerText = homeForm;
        document.getElementById('awayFormation').innerText = awayForm;
        let homeHtml = '', awayHtml = '';
        for (let i=0; i<11; i++) {
            homeHtml += `<div class="player-spot"><i class="fas fa-user"></i> ${['GK','DF','DF','DF','DF','MF','MF','MF','FW','FW','FW'][i]}</div>`;
            awayHtml += `<div class="player-spot"><i class="fas fa-user"></i> ${['GK','DF','DF','DF','DF','MF','MF','MF','FW','FW','FW'][i]}</div>`;
        }
        document.getElementById('homeFormationGrid').innerHTML = homeHtml;
        document.getElementById('awayFormationGrid').innerHTML = awayHtml;
    }

    function updatePlayerRatings(home, away, homeLevel, awayLevel) {
        const homePlayers = getTeamPlayers(home, homeLevel);
        const awayPlayers = getTeamPlayers(away, awayLevel);
        let html = '';
        for (let i=0; i<11; i++) {
            let hName = homePlayers[i] || homePlayers[0] || 'é—¨å°† 80';
            let aName = awayPlayers[i] || awayPlayers[0] || 'é—¨å°† 78';
            let hParts = hName.split(' ');
            let aParts = aName.split(' ');
            let hRating = hParts.pop() || '80';
            let aRating = aParts.pop() || '78';
            let hDist = (Math.random() * 2 + 10).toFixed(1);
            let aDist = (Math.random() * 2 + 9.5).toFixed(1);
            let hSprint = Math.floor(Math.random() * 15 + 20);
            let aSprint = Math.floor(Math.random() * 15 + 18);
            let hExtra = '', aExtra = '';
            if (i === 0) {
                let hSaves = Math.floor(Math.random() * 3 + 2);
                let hxSaved = (Math.random() * 0.6 + 0.8).toFixed(2);
                let aSaves = Math.floor(Math.random() * 3 + 2);
                let axSaved = (Math.random() * 0.6 + 0.7).toFixed(2);
                hExtra = ` Â· ğŸ§¤æ‰‘æ•‘${hSaves} Â· xSaved ${hxSaved}`;
                aExtra = ` Â· ğŸ§¤æ‰‘æ•‘${aSaves} Â· xSaved ${axSaved}`;
            }
            let hYellow = Math.floor(Math.random() * 5);
            let aYellow = Math.floor(Math.random() * 5);
            let hYellowWarn = hYellow >= 4 ? 'ğŸŸ¥ åœèµ›é¢„è­¦' : `ğŸŸ¨ ${hYellow}å¼ `;
            let aYellowWarn = aYellow >= 4 ? 'ğŸŸ¥ åœèµ›é¢„è­¦' : `ğŸŸ¨ ${aYellow}å¼ `;
            let trendLine = 'â–‚â–ƒâ–„â–…â–†';
            html += `<div class="player-card">
                        <span style="display:flex; flex-direction:column;">
                            <span style="color:#3b82f6;">${hParts.join(' ')}</span>
                            <span style="font-size:12px; color:#b0d0ff;">
                                è¯„åˆ† ${hRating} Â· ${hDist}km Â· ğŸ’¨${hSprint}æ¬¡
                                ${hExtra} Â· ${hYellowWarn}
                                <span style="margin-left:8px; color:#ffd966;">${trendLine}</span>
                            </span>
                        </span>
                        <span style="display:flex; flex-direction:column; text-align:right;">
                            <span style="color:#f97316;">${aParts.join(' ')}</span>
                            <span style="font-size:12px; color:#b0d0ff;">
                                è¯„åˆ† ${aRating} Â· ${aDist}km Â· ğŸ’¨${aSprint}æ¬¡
                                ${aExtra} Â· ${aYellowWarn}
                                <span style="margin-left:8px; color:#ffd966;">â–‚â–ƒâ–„â–…â–†</span>
                            </span>
                        </span>
                    </div>`;
        }
        document.getElementById('playerRatingList').innerHTML = html;
    }

    function updateH2H(home, away) {
        let homeWins = Math.floor(Math.random()*6+3);
        let awayWins = Math.floor(Math.random()*4);
        let draws = 10 - homeWins - awayWins;
        document.getElementById('h2hStats').innerHTML = `
            <div style="display:flex; justify-content:space-between;">
                <span>ğŸ† è¿‘10åœº: ${home} ${homeWins}èƒœ ${draws}å¹³ ${awayWins}è´Ÿ</span>
                <span>âš½ è¿›å¤±çƒ: ${Math.floor(Math.random()*15+12)}:${Math.floor(Math.random()*10+6)}</span>
            </div>
        `;
    }

    function updateOdds() {
        const bookies = ['å¨å»‰å¸Œå°”', 'Bet365', 'æ¾³é—¨', 'ç«å½©å®˜æ–¹'];
        let html = '<tr><th>å…¬å¸</th><th>ä¸»èƒœ</th><th>å¹³å±€</th><th>å®¢èƒœ</th></tr>';
        bookies.forEach(b => {
            let win = (Math.random()*0.4 + 1.7).toFixed(2);
            let draw = (Math.random()*0.8 + 3.2).toFixed(2);
            let loss = (Math.random()*1.2 + 3.8).toFixed(2);
            html += `<tr><td>${b}</td><td>${win}</td><td>${draw}</td><td>${loss}</td></tr>`;
        });
        document.getElementById('oddsComparison').innerHTML = html;
    }

    function updateWeather() {
        let temp = (Math.random()*10 + 5).toFixed(1);
        let humidity = Math.floor(Math.random()*30 + 60);
        let wind = (Math.random()*15 + 8).toFixed(1);
        document.getElementById('weatherDetail').innerHTML = `
            <div style="display:flex; gap:20px; flex-wrap:wrap;">
                <span>ğŸŒ¡ï¸ ${temp}Â°C</span> <span>ğŸ’§ ${humidity}%</span> <span>ğŸ’¨ ${wind}km/h</span>
                <span>â˜” ${Math.floor(Math.random()*40+30)}%</span>
            </div>
        `;
    }

    function updateMatchPreview(home, away) {
        document.getElementById('matchPreview').innerText = `${home} vs ${away} Â· åŠ¨æ€çƒå‘˜åº“Â·328é˜Ÿ Â· æ¨¡å‹é¢„æµ‹ä¸»é˜Ÿä¸è´¥æ¦‚ç‡${Math.floor(Math.random()*30+60)}%`;
    }

    function updateAdvancedMetrics() {
        document.getElementById('xAHome').innerText = (Math.random() * 0.8 + 0.9).toFixed(2);
        document.getElementById('xAHomeDetail').innerText = (Math.random() * 0.8 + 0.9).toFixed(2);
        document.getElementById('xAAwayDetail').innerText = (Math.random() * 0.6 + 0.6).toFixed(2);
        document.getElementById('ppda').innerText = (Math.random() * 3 + 7).toFixed(1);
        document.getElementById('highPress').innerText = Math.floor(Math.random() * 60 + 150);
        document.getElementById('fatigue').innerText = (Math.random() * 3 + 5).toFixed(1);
        let handicap = ['-0.5', '-0.75', '-1.0', '0', '+0.5'][Math.floor(Math.random()*5)];
        document.getElementById('asianHandicap').innerText = handicap;
        document.getElementById('overUnder').innerText = (Math.random() * 1 + 2.25).toFixed(2);
        document.getElementById('expectedTotal').innerText = (Math.random() * 1 + 2.2).toFixed(1);
    }

    function updateRefereeStats() {
        const refs = ['å®‰ä¸œå°¼Â·æ³°å‹’', 'é©¬é½å°¼äºšå…‹', 'å¥¥åˆ©å¼—', 'è’‚å°”æ½˜', 'æ‹‰å¥¥æ–¯'];
        document.getElementById('refName').innerText = refs[Math.floor(Math.random()*refs.length)];
        document.getElementById('refYellow').innerText = (Math.random() * 1.5 + 3.5).toFixed(1);
        document.getElementById('refRed').innerText = (Math.random() * 0.4 + 0.1).toFixed(1);
        document.getElementById('refPenalty').innerText = (Math.random() * 0.15 + 0.15).toFixed(2);
        document.getElementById('refFoul').innerText = (Math.random() * 5 + 20).toFixed(1);
    }

    function updateHeatmapNames(home, away) {
        let homeStar = 'å“ˆå…°å¾·', awayStar = 'Bè´¹';
        if (home.includes('çš‡é©¬')) homeStar = 'è´æ—å„å§†';
        else if (home.includes('å·´è¨')) homeStar = 'è±ä¸‡';
        else if (home.includes('æ‹œä»')) homeStar = 'å‡¯æ©';
        else if (home.includes('å·´é»')) homeStar = 'å§†å·´ä½©';
        else if (home.includes('æ›¼åŸ')) homeStar = 'å“ˆå…°å¾·';
        else homeStar = 'æ ¸å¿ƒ';
        if (away.includes('çš‡é©¬')) awayStar = 'ç»´å°¼ä¿®æ–¯';
        else if (away.includes('å·´è¨')) awayStar = 'ä½©å¾·é‡Œ';
        else if (away.includes('æ‹œä»')) awayStar = 'ç©†è¥¿äºšæ‹‰';
        else if (away.includes('å·´é»')) awayStar = 'ç™»è´è±';
        else if (away.includes('æ›¼è”')) awayStar = 'Bè´¹';
        else awayStar = 'æ ¸å¿ƒ';
        document.getElementById('homeStarName').innerText = homeStar;
        document.getElementById('awayStarName').innerText = awayStar;
    }

    function initHeatmaps() {
        drawHeatmap('heatmapHome', '#3b82f6');
        drawHeatmap('heatmapAway', '#f97316');
    }
    function drawHeatmap(canvasId, color) {
        const canvas = document.getElementById(canvasId);
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = '#0a1428'; ctx.fillRect(0,0,canvas.width,canvas.height);
        for (let i=0;i<50;i++) {
            let x = canvas.width * (0.6 + Math.random()*0.3);
            let y = canvas.height * (0.3 + Math.random()*0.5);
            let r = Math.random()*12+5;
            ctx.beginPath(); ctx.arc(x, y, r, 0, 2*Math.PI);
            ctx.fillStyle = color + '30'; ctx.fill();
        }
    }

    function initPassNetwork() {
        const canvas = document.getElementById('passNetworkCanvas');
        const ctx = canvas.getContext('2d');
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = '#0a1428'; ctx.fillRect(0,0,canvas.width,canvas.height);
        const players = [];
        for (let i=0;i<10;i++) {
            players.push({x: Math.random()*canvas.width, y: Math.random()*canvas.height});
        }
        ctx.strokeStyle = '#3b82f6'; ctx.lineWidth = 1.5;
        for (let i=0;i<players.length;i++) {
            for (let j=i+1;j<players.length;j++) {
                if (Math.random() > 0.7) {
                    ctx.beginPath(); ctx.moveTo(players[i].x, players[i].y); ctx.lineTo(players[j].x, players[j].y);
                    ctx.strokeStyle = `rgba(59,130,246,${Math.random()*0.4+0.2})`; ctx.stroke();
                }
            }
        }
        players.forEach(p => { ctx.beginPath(); ctx.arc(p.x, p.y, 6, 0, 2*Math.PI); ctx.fillStyle = '#3b82f6'; ctx.fill(); });
    }

    function updateBench() {
        const benchNames = ['é˜¿å°”ç“¦é›·æ–¯', 'ç§‘ç“¦å¥‘å¥‡', 'æ ¼ç“¦è¿ªå¥¥å°”', 'åˆ˜æ˜“æ–¯', 'æˆˆéº¦æ–¯', 'èŠ’ç‰¹', 'åŸƒé‡Œå…‹æ£®', 'é©¬å¥å°”', 'å®‰ä¸œå°¼', 'å·´å› å¾·å°”'];
        let homeHtml = '', awayHtml = '';
        for (let i=0;i<5;i++) {
            let prob = Math.floor(Math.random()*30+20);
            homeHtml += `<span class="bench-player">${benchNames[(i+Math.floor(Math.random()*5))%benchNames.length]} ${prob}%</span>`;
            awayHtml += `<span class="bench-player">${benchNames[(i+Math.floor(Math.random()*5+5))%benchNames.length]} ${prob}%</span>`;
        }
        document.getElementById('homeBench').innerHTML = homeHtml;
        document.getElementById('awayBench').innerHTML = awayHtml;
    }

    function updateMatchupAnalysis() {
        const matchups = [
            { homeP: 'å“ˆå…°å¾·', awayP: 'èŒƒæˆ´å…‹', adv: Math.floor(Math.random()*20+60) },
            { homeP: 'å¾·å¸ƒåŠ³å†…', awayP: 'å¡å¡ç±³ç½—', adv: Math.floor(Math.random()*20+55) },
            { homeP: 'ç¦ç™»', awayP: 'è¾¾æ´›ç‰¹', adv: Math.floor(Math.random()*20+58) }
        ];
        let html = '';
        matchups.forEach(m => {
            html += `<div class="matchup-item">
                        <div><span style="color:#3b82f6;">${m.homeP}</span> vs <span style="color:#f97316;">${m.awayP}</span></div>
                        <div style="font-size:24px; font-weight:700; color:#ffd966;">${m.adv}%</div>
                        <div style="font-size:12px;">ä¸»é˜Ÿå¯¹ä½ä¼˜åŠ¿</div>
                    </div>`;
        });
        document.getElementById('matchupAnalysis').innerHTML = html;
    }

    function updateSliderDisplay() {
        document.getElementById('attackWeightVal').innerText = document.getElementById('attackWeight').value;
        document.getElementById('defenseWeightVal').innerText = document.getElementById('defenseWeight').value;
        document.getElementById('homeBoostVal').innerText = document.getElementById('homeBoost').value;
    }

    function updateSentiment() {
        let home = Math.floor(Math.random() * 30 + 60);
        let away = Math.floor(Math.random() * 15 + 5);
        let draw = 100 - home - away;
        if (draw < 5) { draw = 5; home -= 2; away -= 3; }
        document.getElementById('homeSentiment').innerText = home + '%';
        document.getElementById('drawSentiment').innerText = draw + '%';
        document.getElementById('awaySentiment').innerText = away + '%';
        document.getElementById('homeSentimentBar').style.width = home + '%';
        document.getElementById('drawSentimentBar').style.width = draw + '%';
        document.getElementById('awaySentimentBar').style.width = away + '%';
    }

    function voteHome() { voteHome += 1; updateVoteDisplay(); }
    function voteDraw() { voteDraw += 1; updateVoteDisplay(); }
    function voteAway() { voteAway += 1; updateVoteDisplay(); }
    function updateVoteDisplay() {
        document.getElementById('voteHomeCount').innerText = (voteHome/1000).toFixed(1) + 'k';
        document.getElementById('voteDrawCount').innerText = (voteDraw/1000).toFixed(1) + 'k';
        document.getElementById('voteAwayCount').innerText = (voteAway/1000).toFixed(1) + 'k';
    }

    function startCountdown() {
        setInterval(() => {
            let d = Math.floor(Math.random()*3+1);
            let h = Math.floor(Math.random()*24);
            let m = Math.floor(Math.random()*60);
            let s = Math.floor(Math.random()*60);
            document.getElementById('countdownTimer').innerHTML = `è·ç¦»å¼€èµ›: ${d}å¤© ${h.toString().padStart(2,'0')}:${m.toString().padStart(2,'0')}:${s.toString().padStart(2,'0')}`;
        }, 1000);
    }

    function startOddsTimer() {
        setInterval(() => {
            updateOdds();
            document.getElementById('oddsUpdateHint').innerHTML = 'æ›´æ–°: ' + new Date().toLocaleTimeString('zh-CN', {hour12:false});
        }, 5000);
    }

    function updateStandings() {
        const league = leagueDB[currentLeague].name;
        let teams = leagueDB[currentLeague].teams;
        let standings = [];
        teams.forEach(t => {
            standings.push({team: t, pts: Math.floor(Math.random()*30+40), gd: Math.floor(Math.random()*20-5)});
        });
        standings.sort((a,b) => b.pts - a.pts || b.gd - a.gd);
        let html = `<div style="display:flex; gap:16px; margin-bottom:16px;"><i class="fas fa-table"></i> ${league} ç§¯åˆ†æ¦œÂ·å‰6å</div>`;
        for (let i=0; i<Math.min(6, standings.length); i++) {
            html += `<div class="standing-row"><span>${i+1}. ${standings[i].team}</span><span>${standings[i].pts}åˆ† / ${standings[i].gd}å‡€èƒœ</span></div>`;
        }
        document.getElementById('leagueStanding').innerHTML = html;
    }

    function updateFutureSchedule() {
        const home = document.getElementById('homeTeamPro').value;
        const away = document.getElementById('awayTeamPro').value;
        const teams = leagueDB[currentLeague].teams;
        let availableHome = teams.filter(t => t !== home && t !== away);
        let availableAway = teams.filter(t => t !== away && t !== home);
        if (availableHome.length === 0) availableHome = ['å¯¹æ‰‹A', 'å¯¹æ‰‹B'];
        if (availableAway.length === 0) availableAway = ['å¯¹æ‰‹C', 'å¯¹æ‰‹D'];
        let h1 = availableHome[Math.floor(Math.random() * availableHome.length)];
        let h2 = availableHome[Math.floor(Math.random() * availableHome.length)];
        let a1 = availableAway[Math.floor(Math.random() * availableAway.length)];
        let a2 = availableAway[Math.floor(Math.random() * availableAway.length)];
        document.getElementById('homeSchedule').innerHTML = `âš½ vs ${h1} (2.19) Â· âš½ vs ${h2} (2.22)`;
        document.getElementById('awaySchedule').innerHTML = `âš½ vs ${a1} (2.20) Â· âš½ vs ${a2} (2.23)`;
    }

    function addPredictionToHistory(home, away, homeScore, awayScore) {
        historyPredictionsArray.push({home, away, homeScore, awayScore, time: new Date().toLocaleTimeString('zh-CN', {hour12:false})});
        if (historyPredictionsArray.length > 5) historyPredictionsArray.shift();
        loadHistoryPredictions();
    }
    function loadHistoryPredictions() {
        let html = '';
        if (historyPredictionsArray.length === 0) {
            html = '<div style="color:#b0d0ff;">æš‚æ— é¢„æµ‹è®°å½•ï¼Œç‚¹å‡»ã€Œç»ˆææ¨æ¼”ã€å¼€å§‹</div>';
        } else {
            historyPredictionsArray.slice().reverse().forEach(p => {
                html += `<div class="history-card">
                            <div style="font-size:20px; font-weight:700;">${p.home} ${p.homeScore}-${p.awayScore} ${p.away}</div>
                            <div style="font-size:12px; color:#b0d0ff;">${p.time}</div>
                        </div>`;
            });
        }
        document.getElementById('historyPredictions').innerHTML = html;
    }

    function initAccuracyChart() {
        const ctx = document.getElementById('accuracyTrendChart');
        if (!ctx) return;
        accChart = new Chart(ctx.getContext('2d'), {
            type: 'line',
            data: { labels: ['5åœºå‰','4åœºå‰','3åœºå‰','2åœºå‰','ä¸Šè½®'],
                    datasets: [{ label: 'å‡†ç¡®ç‡ %', data: [68,72,65,78,74], borderColor: '#ffd966', backgroundColor: 'rgba(255,217,102,0.1)', tension: 0.3 }] },
            options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 50, max: 90, grid: { color: '#1e3a5a' } } }, plugins: { legend: { display: false } } }
        });
    }

    function startLiveCommentary(home, away, homeScore, awayScore) {
        const div = document.getElementById('commentaryContent');
        div.innerHTML = '';
        const events = [
            `âš½ ç¬¬3åˆ†é’Ÿï¼Œ${home} å·¦è·¯ä¼ ä¸­ï¼Œå¤´çƒåå‡ºã€‚`,
            `ğŸŸ¨ ç¬¬12åˆ†é’Ÿï¼Œ${away} ååœºçŠ¯è§„ï¼Œé»„ç‰Œã€‚`,
            `ğŸ¥… ç¬¬34åˆ†é’Ÿï¼Œ${home} è¿›çƒï¼${homeScore-awayScore>0?'1-0':''} ${homeStarName2(home)} æ¨å°„ç ´é—¨ï¼`,
            `â±ï¸ ç¬¬45åˆ†é’Ÿï¼Œä¸ŠåŠåœºè¡¥æ—¶2åˆ†é’Ÿã€‚`,
            `ğŸ¥… ç¬¬74åˆ†é’Ÿï¼Œ${away} æ‰³å¹³ï¼${awayScore-homeScore>=0?'1-1':''}`,
            `ğŸ¥… ç¬¬89åˆ†é’Ÿï¼Œ${home} ç»æ€ï¼${homeScore>awayScore?homeScore+'-'+awayScore:''}`
        ];
        let selected = [];
        for (let i=0; i<5; i++) selected.push(events[Math.floor(Math.random()*events.length)]);
        selected.sort();
        selected.forEach(ev => div.innerHTML += `<div class="commentary-item">${ev}</div>`);
        div.innerHTML += `<div class="commentary-item" style="color:#ffd966;">ğŸ å…¨åœºç»“æŸ Â· ${home} ${homeScore}:${awayScore} ${away}</div>`;
    }
    function homeStarName2(team) {
        if (team.includes('æ›¼åŸ')) return 'å“ˆå…°å¾·';
        if (team.includes('çš‡é©¬')) return 'è´æ—å„å§†';
        if (team.includes('å·´è¨')) return 'è±ä¸‡';
        if (team.includes('æ‹œä»')) return 'å‡¯æ©';
        if (team.includes('å·´é»')) return 'å§†å·´ä½©';
        return 'æ ¸å¿ƒçƒå‘˜';
    }

    function ultimatePrediction() {
        const home = document.getElementById('homeTeamPro').value;
        const away = document.getElementById('awayTeamPro').value;
        const attackW = parseFloat(document.getElementById('attackWeight').value);
        const defenseW = parseFloat(document.getElementById('defenseWeight').value);
        const homeBoost = parseFloat(document.getElementById('homeBoost').value);

        const loadDiv = document.getElementById('globalLoading');
        const progress = document.getElementById('globalProgress');
        loadDiv.style.display = 'block';
        let w = 0;
        const interval = setInterval(() => {
            w += Math.floor(Math.random()*12)+8;
            if (w >= 100) { w = 100; clearInterval(interval); }
            progress.style.width = w + '%';
            if (w === 100) {
                setTimeout(() => {
                    loadDiv.style.display = 'none';
                    showPredictionResult(home, away, attackW, defenseW, homeBoost);
                }, 200);
            }
        }, 60);

        refreshAllInfo();
        updateAdvancedMetrics();
        updateRefereeStats();
        updateSentiment();
        drawHeatmap('heatmapHome', '#3b82f6');
        drawHeatmap('heatmapAway', '#f97316');
        initPassNetwork();
        updateBench();
        updateMatchupAnalysis();
        updateStandings();
        updateFutureSchedule();
    }

    function showPredictionResult(home, away, attackW, defenseW, homeBoost) {
        const panel = document.getElementById('resultFlagship');
        panel.style.display = 'block';
        document.getElementById('resultHomeName').innerText = home;
        document.getElementById('resultAwayName').innerText = away;

        let homeScore = Math.floor(Math.random() * 4) + (homeBoost > 0.25 ? 1 : 0);
        homeScore = Math.min(homeScore, 5);
        let awayScore = Math.floor(Math.random() * 3) - (defenseW > 0.6 ? 1 : 0);
        awayScore = Math.max(awayScore, 0);
        awayScore = Math.min(awayScore, 3);

        document.getElementById('resultHomeScore').innerText = homeScore;
        document.getElementById('resultAwayScore').innerText = awayScore;

        document.getElementById('confidenceInterval68').innerText = `[${Math.max(0,homeScore-1)}-${Math.max(0,awayScore-1)}, ${homeScore+1}-${awayScore+1}]`;
        document.getElementById('confidenceInterval95').innerText = `[${Math.max(0,homeScore-2)}-${Math.max(0,awayScore-2)}, ${homeScore+2}-${awayScore+2}]`;

        let winProb, drawProb, lossProb;
        if (homeScore > awayScore) {
            winProb = Math.floor(Math.random() * 20 + 60 + attackW*10 - defenseW*5);
            drawProb = Math.floor(Math.random() * 15 + 15);
            lossProb = 100 - winProb - drawProb;
        } else if (homeScore < awayScore) {
            lossProb = Math.floor(Math.random() * 20 + 55 + (1-defenseW)*10);
            drawProb = Math.floor(Math.random() * 20 + 15);
            winProb = 100 - lossProb - drawProb;
        } else {
            drawProb = Math.floor(Math.random() * 20 + 45);
            winProb = Math.floor(Math.random() * 20 + 20 + attackW*5);
            lossProb = 100 - drawProb - winProb;
        }
        winProb = Math.min(Math.max(winProb,5),85);
        drawProb = Math.min(Math.max(drawProb,5),50);
        lossProb = 100 - winProb - drawProb;
        if (lossProb < 0) { lossProb = 5; winProb -= 2; drawProb -= 3; }

        document.getElementById('winProbFill').style.width = winProb + '%';
        document.getElementById('drawProbFill').style.width = drawProb + '%';
        document.getElementById('lossProbFill').style.width = lossProb + '%';
        document.getElementById('winProbValue').innerText = winProb + '%';
        document.getElementById('drawProbValue').innerText = drawProb + '%';
        document.getElementById('lossProbValue').innerText = lossProb + '%';

        document.getElementById('modelAUC').innerText = (Math.random() * 0.06 + 0.91).toFixed(2);
        document.getElementById('brierScore').innerText = (Math.random() * 0.03 + 0.07).toFixed(3);
        document.getElementById('historyAcc').innerText = (Math.random() * 10 + 68).toFixed(1) + '%';
        document.getElementById('logLoss').innerText = (Math.random() * 0.15 + 0.3).toFixed(2);

        document.getElementById('matchPreview').innerText = `${home} ${homeScore}:${awayScore} ${away} Â· æ»‘å—å‚æ•°: è¿›æ”»${attackW.toFixed(2)} é˜²å®ˆ${defenseW.toFixed(2)} ä¸»åœºåŠ æˆ${homeBoost.toFixed(2)} Â· 328é˜ŸåŠ¨æ€åº“`;

        startLiveCommentary(home, away, homeScore, awayScore);
        addPredictionToHistory(home, away, homeScore, awayScore);
    }

    document.addEventListener('change', function(e) {
        if (e.target.id === 'homeTeamPro' || e.target.id === 'awayTeamPro') {
            refreshAllInfo();
            updateHeatmapNames(document.getElementById('homeTeamPro').value, document.getElementById('awayTeamPro').value);
            updateStandings();
            updateFutureSchedule();
            updateBench();
            updateMatchupAnalysis();
        }
    });
</script>

<!-- éšè—Chartç”»å¸ƒï¼Œä¾›å‡†ç¡®ç‡å›¾è¡¨ä½¿ç”¨ -->
<canvas id="accuracyTrendChart" style="display:none;"></canvas>
</body>
</html>
