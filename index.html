index.html
<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#00ffc3">
  <link rel="manifest" href="/manifest.json">
  <link rel="icon" href="/icons/icon-192.png">
  <title>âš¡è¶³çƒå…ƒå®‡å®™Â·è‡³å°Šç¥è°•ç‰ˆ</title>
  <!-- å†…è”å…³é”®CSSï¼ˆé¦–å±ï¼‰ -->
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:'Inter',sans-serif}
    body{background:#000c08;color:#e0ffe0;padding:1.5rem}
    .hologram-header{display:flex;flex-wrap:wrap;justify-content:space-between;align-items:center;padding:1rem 2rem;border-bottom:2px solid #00ffc3;margin-bottom:2rem}
    .brand-text{font-size:2.5rem;font-weight:900;background:linear-gradient(45deg,#fff,#00ffea);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
    .hologram-stage{width:100%;height:400px;background:radial-gradient(circle,#0a3a2a,#020806);border-radius:48px;border:2px solid #00ffc3;margin-bottom:2rem;position:relative}
    .dimension-tower{display:grid;grid-template-columns:1.2fr 1.8fr 1.2fr;gap:1.5rem;margin-bottom:2rem}
    .dimension-panel{background:rgba(8,25,20,0.9);backdrop-filter:blur(20px);border-radius:48px;padding:1.8rem;border:1px solid #00ffc3;box-shadow:0 0 20px #00ffc366}
    .legend-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:0.8rem;margin:1rem 0}
    .legend-card{background:linear-gradient(145deg,#102a20,#05100c);border-radius:24px;padding:1rem 0.5rem;text-align:center;border:1px solid gold;box-shadow:0 0 20px gold;position:relative;overflow:hidden}
    .score-hologram{display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;margin:1.5rem 0}
    .score-3d{background:rgba(0,20,10,0.7);border-radius:32px;border:1px solid #0ff;box-shadow:0 0 30px #0ff7;padding:1.2rem 0.3rem;text-align:center;transform:perspective(500px) rotateX(2deg);backdrop-filter:blur(8px)}
    .btn{border:none;color:#fff;padding:0.6rem 1.3rem;border-radius:60px;font-weight:600;display:inline-flex;align-items:center;gap:0.5rem;cursor:pointer;border:1px solid rgba(255,255,255,0.4);background:linear-gradient(145deg,#006688,#003344)}
    .pk-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(700px,1fr));gap:2rem;margin:2rem 0}
    @media (max-width:1200px){.dimension-tower{grid-template-columns:1fr}.pk-grid{grid-template-columns:1fr}.brand-text{font-size:1.8rem}}
  </style>
  <!-- é¢„åŠ è½½æ ¸å¿ƒåº“ -->
  <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.module.js" crossorigin>
  <link rel="preload" as="script" href="https://cdn.jsdelivr.net/npm/chart.js@3.9.1/dist/chart.min.js" crossorigin>
  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <!-- å¼‚æ­¥åŠ è½½éæ ¸å¿ƒèµ„æº -->
  <script>
    window.loadFontAwesome = function() {
      const fa = document.createElement('link');
      fa.rel = 'stylesheet';
      fa.href = 'https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css';
      document.head.appendChild(fa);
    };
    window.loadAnnyang = function(callback) {
      const s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/annyang@2.6.1/dist/annyang.min.js';
      s.onload = callback;
      document.head.appendChild(s);
    };
    // é¢„åŠ è½½å®Œæˆç«‹å³æ‰§è¡Œå­—ä½“å›¾æ ‡ï¼ˆå»¶è¿Ÿä½†å°½æ—©ï¼‰
    setTimeout(loadFontAwesome, 100);
  </script>
</head>
<body>
<div class="container">
  <!-- ========== å…¨æ¯å¤´éƒ¨ ========== -->
  <div class="hologram-header">
    <div style="display:flex; align-items:center; gap:1.2rem">
      <i class="fas fa-crown" style="font-size:2.8rem; color:#f1c40f; text-shadow:0 0 30px gold"></i>
      <span class="brand-text">âš¡AIÂ·å…ƒå®‡å®™Â·è‡³å°Š</span>
      <span style="background:rgba(0,255,200,0.1); border:1px solid #00ffc3; border-radius:60px; padding:0.3rem 1.2rem; box-shadow:0 0 15px #00ffc3">é‡å­é¢„è¨€ v10.0</span>
    </div>
    <div style="display:flex; gap:0.8rem">
      <button id="voiceBtn" class="btn" onclick="window.loadAnnyang(()=>{annyang.addCommands({ä¸‹bet:()=>alert('è¯­éŸ³ä¸‹æ³¨æ¼”ç¤º')}); annyang.start()})"><i class="fas fa-microphone-alt"></i> è¯­éŸ³</button>
      <button id="themeToggle" class="btn" style="background:linear-gradient(145deg,#880088,#440044)"><i id="themeIcon" class="fas fa-moon"></i> æ·±è‰²</button>
      <button id="fullscreenBtn" class="btn"><i class="fas fa-expand"></i></button>
    </div>
  </div>

  <!-- ========== å…¨æ¯3Dçƒåœº ========== -->
  <div class="hologram-stage">
    <canvas id="threeCanvas" style="width:100%; height:100%; display:block"></canvas>
    <div style="position:absolute; top:20px; right:30px; background:rgba(0,0,0,0.7); border-radius:60px; padding:0.5rem 1.5rem; border:1px solid #00ffc3; display:flex; gap:1rem; backdrop-filter:blur(8px)">
      <span class="weather-btn" data-w="0"><i class="fas fa-sun" style="color:#ffaa00"></i> æ™´</span>
      <span class="weather-btn" data-w="1"><i class="fas fa-cloud-rain" style="color:#88aaff"></i> é›¨</span>
      <span class="weather-btn" data-w="2"><i class="fas fa-snowflake" style="color:#aaddff"></i> é›ª</span>
      <span class="weather-btn" data-w="3"><i class="fas fa-smog" style="color:#ccc"></i> é›¾</span>
      <span id="currentWeather"><i class="fas fa-sun"></i> æ™´Â·23â„ƒ</span>
    </div>
  </div>

  <!-- ========== ç»´åº¦æ§åˆ¶å¡” ========== -->
  <div class="dimension-tower">
    <!-- å·¦ï¼šä¼ å¥‡æ®¿å ‚ -->
    <div class="dimension-panel">
      <div style="display:flex; align-items:center; gap:0.8rem; margin-bottom:1rem">
        <i class="fas fa-crown" style="color:gold; font-size:1.8rem"></i>
        <span style="font-size:1.5rem; font-weight:800">âš¡ ä¼ å¥‡æ®¿å ‚</span>
      </div>
      <div class="legend-grid" id="legendGrid"></div>
      <div style="margin-top:1rem; background:rgba(0,0,0,0.4); border-radius:32px; padding:1rem">
        <span><i class="fas fa-dragon"></i> ç„å­¦è¿åŠ¿:</span>
        <span id="fortuneText">âš¡ å¤§å‰Â·è¿›æ”»å¦‚æ½®</span>
        <button id="fortuneBtn" style="margin-left:1rem; background:none; border:1px solid cyan; border-radius:40px; padding:0.2rem 1rem; color:white">æŠ½ç­¾</button>
      </div>
    </div>
    <!-- ä¸­ï¼šæ—¶ç©ºé¢„æµ‹ -->
    <div class="dimension-panel">
      <div style="display:flex; align-items:center; gap:0.8rem; margin-bottom:1rem">
        <i class="fas fa-chart-pie" style="color:#00ffc3; font-size:1.8rem"></i>
        <span style="font-size:1.5rem; font-weight:800"> æ—¶ç©ºé¢„æµ‹</span>
      </div>
      <div id="predictionSample" style="min-height:160px">
        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:0.5rem">
          <span id="sampleHome" style="font-size:1.6rem">æ›¼åŸ 5â˜…</span>
          <span style="font-size:2rem">VS</span>
          <span id="sampleAway" style="font-size:1.6rem">åˆ©ç‰©æµ¦ 5â˜…</span>
        </div>
        <div class="score-hologram" id="sampleScores"></div>
      </div>
      <div style="display:flex; gap:0.8rem; margin-top:0.5rem">
        <button id="worldCupBtn" class="btn" style="background:linear-gradient(145deg,#aaff00,#558800)"><i class="fas fa-globe"></i> ä¸–ç•Œæ¯64åœº</button>
        <button id="timeCompressBtn" class="btn" style="background:linear-gradient(145deg,#ffaa00,#aa5500)"><i class="fas fa-hourglass-half"></i> 10å€é€Ÿ</button>
      </div>
    </div>
    <!-- å³ï¼šç»ç†äººåœ£æ®¿ -->
    <div class="dimension-panel">
      <div style="display:flex; align-items:center; gap:0.8rem; margin-bottom:1rem">
        <i class="fas fa-trophy" style="color:gold; font-size:1.8rem"></i>
        <span style="font-size:1.5rem; font-weight:800"> ç»ç†äººåœ£æ®¿</span>
      </div>
      <div id="rankingList">
        <div style="display:flex; justify-content:space-between"><span>1. AIå…ˆçŸ¥</span><span> 9850</span></div>
        <div style="display:flex; justify-content:space-between"><span>2. è¶³çƒä¹‹ç¥</span><span>ğŸ¥ˆ 9720</span></div>
        <div style="display:flex; justify-content:space-between"><span>3. å…ƒå®‡å®™æ•™çˆ¶</span><span>ğŸ¥‰ 9610</span></div>
        <div style="display:flex; justify-content:space-between"><span>4. YOU</span><span>â­ 8940</span></div>
      </div>
      <div style="margin-top:1.5rem; background:rgba(0,255,200,0.05); border-radius:28px; padding:1rem">
        <span><i class="fas fa-exchange-alt"></i> è½¬ä¼šå¸‚åœº</span>
        <div style="display:flex; gap:0.5rem; margin-top:0.5rem; flex-wrap:wrap">
          <span style="background:#006666; padding:0.2rem 0.8rem; border-radius:20px">å§†å·´ä½© 1.8äº¿</span>
          <span style="background:#006666; padding:0.2rem 0.8rem; border-radius:20px">å“ˆå…°å¾· 1.5äº¿</span>
        </div>
      </div>
    </div>
  </div>

  <!-- ========== é¢„æµ‹å¡ç‰‡ç½‘æ ¼ï¼ˆåŠ¨æ€ï¼‰========== -->
  <div id="pkGrid" class="pk-grid"></div>

  <!-- ========== è¿›çƒå›æ”¾/é‡‘çƒå¥– ========== -->
  <div style="display:grid; grid-template-columns:1fr 1fr; gap:1.5rem; margin-bottom:2rem">
    <div class="dimension-panel" style="padding:1.5rem">
      <span style="font-size:1.3rem"><i class="fas fa-video"></i> è¿›çƒå›æ”¾Â·å…¨æ¯æŠ•å½±</span>
      <div id="replayArea" style="height:100px; margin-top:0.8rem; background:rgba(0,0,0,0.6); border-radius:28px; padding:1rem; display:flex; align-items:center; justify-content:center">
        âš½ ç‚¹å‡»æ¯”åˆ†å¡ç‰‡å›æ”¾3Dè¿›çƒ
      </div>
    </div>
    <div class="dimension-panel" style="padding:1.5rem">
      <span style="font-size:1.3rem"><i class="fas fa-medal"></i> é‡‘çƒå¥–Â·2060</span>
      <div style="display:flex; align-items:center; gap:1rem; margin-top:0.8rem">
        <i class="fas fa-trophy" style="font-size:3rem; color:gold"></i>
        <span style="font-size:1.2rem; font-weight:800">å“ˆå…°å¾·</span>
        <span style="background:rgba(255,255,0,0.3); padding:0.3rem 1rem; border-radius:40px">67çƒ</span>
      </div>
    </div>
  </div>

  <!-- ========== é¡µè„š ========== -->
  <div style="margin-top:3rem; padding:1.5rem 0; border-top:2px solid #00ffc3; display:flex; justify-content:space-between; color:#aaffdd">
    <div><i class="fas fa-shield-alt"></i> æœ¨å…°PSL-2.0</div>
    <div><i class="fas fa-globe-asia"></i> www.football-predict.top</div>
    <div><i class="fas fa-crown"></i> è‡³å°Šç¥è°•ç‰ˆ</div>
  </div>
</div>

<script>
// ========== å…¨å±€çŠ¶æ€ä¸å·¥å…·å‡½æ•° ==========
const STORAGE_KEYS = { GROUPS:'fp_groups', ACC:'fp_acc', CREDITS:'fp_credits', STR:'fp_strength' };
let state = {
  accuracy: 2, weatherIdx: 0, userCredits: 1000, groups: [
    { home:'æ›¼åŸ', away:'åˆ©ç‰©æµ¦' }, { home:'çš‡é©¬', away:'å·´è¨' },
    { home:'æ‹œä»', away:'å¤šç‰¹' }, { home:'å·´é»', away:'å°¤æ–‡' }
  ],
  teamStrength: new Map(), formation: '442', lang: 'zh'
};
// åˆå§‹åŒ–å­˜å‚¨
try {
  state.accuracy = +localStorage.getItem(STORAGE_KEYS.ACC) || 2;
  state.userCredits = +localStorage.getItem(STORAGE_KEYS.CREDITS) || 1000;
  const g = localStorage.getItem(STORAGE_KEYS.GROUPS);
  if(g) state.groups = JSON.parse(g);
  const s = localStorage.getItem(STORAGE_KEYS.STR);
  if(s) state.teamStrength = new Map(JSON.parse(s));
} catch(e){}
const rand = (m,n)=>Math.floor(Math.random()*(n-m+1)+m);
const saveGroups = ()=>localStorage.setItem(STORAGE_KEYS.GROUPS, JSON.stringify(state.groups));
const saveStrength = ()=>localStorage.setItem(STORAGE_KEYS.STR, JSON.stringify([...state.teamStrength]));
const getStrength = team=> (teamStrengthMap.get(team) || (teamStrengthMap.set(team, rand(2,5)), teamStrengthMap.get(team)));
const setStrength = (team,v)=> { teamStrengthMap.set(team,v); saveStrength(); };
window.teamStrengthMap = state.teamStrength; // å…¨å±€å¼•ç”¨

// ========== é¢„æµ‹å¼•æ“ ==========
const GOAL_RANGES = [[0,5],[0,4],[0,3],[0,2],[0,1]];
const WEATHER_MOD = [{a:1.05,d:0.95},{a:0.9,d:1.1},{a:0.8,d:1.2},{a:0.85,d:1.15}];
function generatePrediction(home, away) {
  const r = GOAL_RANGES[state.accuracy];
  let hw_h, hw_a, d, aw_h, aw_a;
  do { hw_h = rand(...r); hw_a = rand(...r); } while(hw_h <= hw_a);
  d = rand(...r);
  do { aw_h = rand(...r); aw_a = rand(...r); } while(aw_h >= aw_a);
  let baseH = [rand(28,45), rand(32,43), rand(35,42), rand(38,43), rand(40,44)][state.accuracy];
  let baseD = [rand(25,40), rand(27,37), rand(30,36), rand(31,35), rand(32,35)][state.accuracy];
  let baseA = 100 - baseH - baseD;
  let hs = getStrength(home), as = getStrength(away);
  let mod = WEATHER_MOD[state.weatherIdx];
  let diff = (hs - as) * (state.formation=='433'?1.2:1) * mod.a;
  let hp = Math.min(78, Math.max(18, baseH + diff*3));
  let ap = Math.min(78, Math.max(18, baseA - diff*3));
  let dp = 100 - hp - ap;
  if(dp<12) dp=12, hp=60, ap=28;
  if(dp>48) dp=48, hp=38, ap=14;
  return {
    scores: [
      { type:'ä¸»èƒœ', score:`${hw_h}:${hw_a}`, prob:Math.round(hp), tip:` ${home}èƒœ`, icon:'fa-thumbs-up', color:'#27ae60' },
      { type:'å¹³å±€', score:`${d}:${d}`, prob:Math.round(dp), tip:'ğŸ¤ å¹³å±€', icon:'fa-hand-peace', color:'#7f8c8d' },
      { type:'å®¢èƒœ', score:`${aw_h}:${aw_a}`, prob:Math.round(ap), tip:`âœˆï¸ ${away}èƒœ`, icon:'fa-plane-departure', color:'#e67e22' }
    ],
    hs, as
  };
}

// ========== ä¼ å¥‡å¡ç‰Œæ•°æ® ==========
const legends = [
  {name:'è´åˆ©', nation:'å·´è¥¿', rating:98, skill:'å€’æŒ‚é‡‘é’©', color:'gold', rarity:'SSR', icon:'fa-futbol'},
  {name:'é©¬æ‹‰å¤šçº³', nation:'é˜¿æ ¹å»·', rating:98, skill:'ä¸–çºªè¿›çƒ', color:'silver', rarity:'SSR', icon:'fa-crown'},
  {name:'å…‹é²ä¼Šå¤«', nation:'è·å…°', rating:96, skill:'å…¨æ”»å…¨å®ˆ', color:'#cd7f32', rarity:'UR', icon:'fa-star'},
  {name:'ç½—çº³å°”å¤š', nation:'å·´è¥¿', rating:97, skill:'é’Ÿæ‘†è¿‡äºº', color:'cyan', rarity:'LR', icon:'fa-meteor'},
  {name:'æ¢…è¥¿', nation:'é˜¿æ ¹å»·', rating:99, skill:'è¿è¿‡äº”äºº', color:'gold', rarity:'SSR', icon:'fa-crown'},
  {name:'Cç½—', nation:'è‘¡è„ç‰™', rating:98, skill:'å€’æŒ‚é‡‘é’©', color:'gold', rarity:'SSR', icon:'fa-star'},
  {name:'é½è¾¾å†…', nation:'æ³•å›½', rating:96, skill:'é©¬èµ›å›æ—‹', color:'#aaa', rarity:'UR', icon:'fa-magic'},
  {name:'è´å…‹æ±‰å§†', nation:'è‹±æ ¼å…°', rating:94, skill:'åœ†æœˆå¼¯åˆ€', color:'#fff', rarity:'UR', icon:'fa-futbol'}
];

// ========== UIæ¸²æŸ“ ==========
function renderLegendGrid() {
  const html = legends.slice(0,4).map(l=>`
    <div class="legend-card">
      <i class="fas ${l.icon}" style="font-size:2rem; color:${l.color}"></i>
      <div style="font-weight:900">${l.name}</div>
      <div style="font-size:0.65rem">${l.skill}</div>
      <span style="background:${l.color}; color:black; padding:0.1rem 0.5rem; border-radius:20px; font-size:0.6rem">${l.rarity}</span>
    </div>
  `).join('');
  document.getElementById('legendGrid').innerHTML = html;
}
function renderSample() {
  const p = generatePrediction('æ›¼åŸ','åˆ©ç‰©æµ¦');
  const homeStr = state.teamStrength.get('æ›¼åŸ')||5, awayStr = state.teamStrength.get('åˆ©ç‰©æµ¦')||5;
  document.getElementById('sampleHome').innerHTML = `æ›¼åŸ ${homeStr}â˜…`;
  document.getElementById('sampleAway').innerHTML = `åˆ©ç‰©æµ¦ ${awayStr}â˜…`;
  document.getElementById('sampleScores').innerHTML = p.scores.map(s=>
    `<div class="score-3d"><span style="font-size:2.2rem">${s.score}</span><br><span>${s.type}</span><div style="color:#7cfc00">${s.prob}%</div><div style="font-size:0.7rem">${s.tip}</div></div>`
  ).join('');
}
function renderCard(home, away, idx) {
  const p = generatePrediction(home, away);
  const homeStr = getStrength(home), awayStr = getStrength(away);
  return `<div class="ultra-card" style="background:rgba(8,25,20,0.9); border-radius:48px; padding:2rem; border:1px solid #00ffc3; box-shadow:0 0 20px #00ffc366" data-index="${idx}">
    <div style="display:flex; justify-content:space-between; align-items:center; flex-wrap:wrap">
      <div><i class="fas ${teamIcon(home)}" style="font-size:2rem"></i> <span style="font-size:1.8rem; font-weight:800">${home}</span> <span style="background:rgba(0,255,0,0.3); padding:0.2rem 0.8rem; border-radius:40px">${homeStr}â˜…</span></div>
      <span style="font-size:2rem">VS</span>
      <div><span style="background:rgba(255,100,0,0.3); padding:0.2rem 0.8rem; border-radius:40px">${awayStr}â˜…</span> <span style="font-size:1.8rem; font-weight:800">${away}</span> <i class="fas ${teamIcon(away)}" style="font-size:2rem"></i></div>
    </div>
    <div class="score-hologram">
      ${p.scores.map(s=>`<div class="score-3d"><span style="font-size:2rem">${s.score}</span><br><span>${s.type}</span><div style="color:#7cfc00">${s.prob}%</div><div style="font-size:0.7rem">${s.tip}</div></div>`).join('')}
    </div>
    <div style="display:flex; gap:1rem; margin-top:1.5rem">
      <button class="btn refresh-card" data-home="${home}" data-away="${away}" style="background:linear-gradient(145deg,#27ae60,#1e8449)"><i class="fas fa-sync-alt"></i> åˆ·æ–°</button>
      <button class="btn replay-btn" data-home="${home}" data-away="${away}" style="background:linear-gradient(145deg,#e67e22,#d35400)"><i class="fas fa-video"></i> å›æ”¾</button>
    </div>
  </div>`;
}
function teamIcon(name) {
  const map = {æ›¼åŸ:'fa-shield',åˆ©ç‰©æµ¦:'fa-crown',çš‡é©¬:'fa-crown',å·´è¨:'fa-shield',æ‹œä»:'fa-star',å¤šç‰¹:'fa-star',å·´é»:'fa-futbol',å°¤æ–‡:'fa-shield'};
  return map[name]||'fa-futbol';
}
function renderAll() {
  const grid = document.getElementById('pkGrid');
  grid.innerHTML = state.groups.map((g,i)=>renderCard(g.home,g.away,i)).join('');
  // é‡æ–°ç»‘å®šå¡ç‰‡äº‹ä»¶
  document.querySelectorAll('.refresh-card').forEach(b=>b.addEventListener('click',function(e){
    const home = this.dataset.home, away = this.dataset.away;
    const card = this.closest('.ultra-card');
    const idx = card.dataset.index;
    card.outerHTML = renderCard(home, away, idx);
  }));
  saveGroups();
}
// åˆå§‹åŒ–ä¼ å¥‡
renderLegendGrid();
renderSample();
renderAll();

// ========== Three.js 3Dåœºæ™¯ï¼ˆåŠ¨æ€åŠ è½½ï¼‰=========
import('https://cdn.jsdelivr.net/npm/three@0.128.0/build/three.module.js').then(THREE=>{
  import('https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/controls/OrbitControls.js').then(({OrbitControls})=>{
    const canvas = document.getElementById('threeCanvas');
    const scene = new THREE.Scene(); scene.background = new THREE.Color(0x030f0c);
    const camera = new THREE.PerspectiveCamera(45, canvas.clientWidth/canvas.clientHeight, 0.1, 200);
    camera.position.set(10,12,25);
    const renderer = new THREE.WebGLRenderer({canvas, antialias:true});
    renderer.setSize(canvas.clientWidth, canvas.clientHeight);
    renderer.shadowMap.enabled = true; renderer.shadowMap.type = THREE.PCFSoftShadowMap;
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true; controls.autoRotate = true; controls.autoRotateSpeed = 0.5;
    // ç¯å…‰
    const ambient = new THREE.AmbientLight(0x404040); scene.add(ambient);
    const mainLight = new THREE.DirectionalLight(0xffeedd, 1.2);
    mainLight.position.set(10,20,15); mainLight.castShadow = true; mainLight.receiveShadow = true; scene.add(mainLight);
    // è‰åª
    const pitch = new THREE.Mesh(new THREE.PlaneGeometry(40,60), new THREE.MeshStandardMaterial({color:0x1a4a2a, roughness:0.7}));
    pitch.rotation.x = -Math.PI/2; pitch.position.y = -0.1; pitch.receiveShadow = true; scene.add(pitch);
    // çº¿æ¡
    const lineMat = new THREE.LineBasicMaterial({color:0xffffff});
    scene.add(new THREE.Line(new THREE.BufferGeometry().setFromPoints([new THREE.Vector3(-20,0.01,0), new THREE.Vector3(20,0.01,0)]), lineMat));
    const pts = []; for(let i=0;i<=64;i++){ let a = (i/64)*Math.PI*2; pts.push(new THREE.Vector3(Math.cos(a)*5,0.01,Math.sin(a)*5)); }
    scene.add(new THREE.LineLoop(new THREE.BufferGeometry().setFromPoints(pts), lineMat));
    // çƒé—¨
    const goalMat = new THREE.MeshStandardMaterial({color:0xdddddd});
    const post = new THREE.BoxGeometry(0.3,1.5,0.3);
    const lp = new THREE.Mesh(post, goalMat); lp.position.set(-3,0.75,-29); scene.add(lp);
    const rp = new THREE.Mesh(post, goalMat); rp.position.set(3,0.75,-29); scene.add(rp);
    const bar = new THREE.Mesh(new THREE.BoxGeometry(6.3,0.3,0.3), goalMat); bar.position.set(0,1.5,-29); scene.add(bar);
    // è¶³çƒ
    const ball = new THREE.Mesh(new THREE.SphereGeometry(0.5,32,32), new THREE.MeshStandardMaterial({color:0xffffff, emissive:0x333333}));
    ball.position.set(0,0.5,0); ball.castShadow = true; ball.receiveShadow = true; scene.add(ball);
    // ç®€å•çƒå‘˜
    [[-6,-2,2,6],[-10,-5,0,5],0x2266cc].forEach((x,i,a)=> x.forEach(xx=> a[1].forEach(zz=>{
      const p = new THREE.Mesh(new THREE.CylinderGeometry(0.4,0.4,1.8), new THREE.MeshStandardMaterial({color:a[2], emissive:0x112233, emissiveIntensity:0.3}));
      p.position.set(xx,0.9,zz); p.castShadow = true; p.receiveShadow = true; scene.add(p);
    })));
    [[-5,-1,3,7],[15,10,5,0],0xcc3333].forEach((x,i,a)=> x.forEach(xx=> a[1].forEach(zz=>{
      const p = new THREE.Mesh(new THREE.CylinderGeometry(0.4,0.4,1.8), new THREE.MeshStandardMaterial({color:a[2], emissive:0x112233, emissiveIntensity:0.3}));
      p.position.set(xx,0.9,zz); p.castShadow = true; p.receiveShadow = true; scene.add(p);
    })));
    // è§‚ä¼—ç²’å­
    const crowdGeo = new THREE.BufferGeometry(), pos = [];
    for(let i=0;i<1500;i++){ let a = Math.random()*Math.PI*2, r = 35+Math.random()*15; pos.push(Math.cos(a)*r, 2+Math.random()*8, Math.sin(a)*r*0.5+10); }
    crowdGeo.setAttribute('position', new THREE.Float32BufferAttribute(pos, 3));
    scene.add(new THREE.Points(crowdGeo, new THREE.PointsMaterial({color:0x88aaff, size:0.2, sizeAttenuation:true})));
    function animate(){ requestAnimationFrame(animate); controls.update(); ball.rotation.x+=0.02; ball.rotation.z+=0.015; renderer.render(scene,camera); }
    animate();
    window.addEventListener('resize', ()=>{ camera.aspect = canvas.clientWidth/canvas.clientHeight; camera.updateProjectionMatrix(); renderer.setSize(canvas.clientWidth, canvas.clientHeight); });
  });
});

// ========== äº¤äº’äº‹ä»¶ç»‘å®š ==========
// å¤©æ°”åˆ‡æ¢
document.querySelectorAll('.weather-btn').forEach((el,i)=> el.addEventListener('click', ()=>{
  state.weatherIdx = i;
  const w = ['æ™´','é›¨','é›ª','é›¾'][i], ic = ['fa-sun','fa-cloud-rain','fa-snowflake','fa-smog'][i], col = ['#ffaa00','#88aaff','#aaddff','#ccc'][i];
  document.getElementById('currentWeather').innerHTML = `<i class="fas ${ic}" style="color:${col}"></i> ${w}Â·${['23â„ƒ','16â„ƒ','-2â„ƒ','12â„ƒ'][i]}`;
  renderSample(); renderAll();
}));
// æŠ½ç­¾
document.getElementById('fortuneBtn').addEventListener('click', ()=>{
  const fortunes = ['âš¡ å¤§å‰Â·è¿›æ”»å¦‚æ½®','ğŸ›¡ï¸ ä¸­å‰Â·é˜²å®ˆç¨³å›º',' å°å‰Â·æ§çƒåˆ¶èƒœ',' æœ«å‰Â·ç»æ€',' å¤§å‡¶Â·ç‚¹çƒé­”å’’'];
  document.getElementById('fortuneText').innerHTML = fortunes[Math.floor(Math.random()*fortunes.length)];
});
// ä¸–ç•Œæ¯æ¨¡æ‹Ÿ
document.getElementById('worldCupBtn').addEventListener('click', ()=>{
  alert(' 64åœºä¸–ç•Œæ¯æ¨¡æ‹Ÿå¼€å§‹ï¼å† å†›: '+['å·´è¥¿','é˜¿æ ¹å»·','æ³•å›½','å¾·å›½','è‹±æ ¼å…°'][Math.floor(Math.random()*5)]);
});
// å…¨å±
document.getElementById('fullscreenBtn').addEventListener('click', ()=>{ if(document.fullscreenElement) document.exitFullscreen(); else document.documentElement.requestFullscreen(); });
// ä¸»é¢˜åˆ‡æ¢
let dark = true;
document.getElementById('themeToggle').addEventListener('click', function(){
  dark = !dark; document.body.style.background = dark ? '#000c08' : '#f0f8f5';
  this.innerHTML = dark ? '<i class="fas fa-moon"></i> æ·±è‰²' : '<i class="fas fa-sun"></i> æµ…è‰²';
});
</script>
<!-- å¼‚æ­¥åŠ è½½å‰©ä½™å›¾æ ‡ï¼ˆå­—ä½“å›¾æ ‡å·²åœ¨å¤´éƒ¨é¢„åŠ è½½ï¼‰ -->
</body>
</html>
