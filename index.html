<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="keywords" content="è¶³çƒé¢„æµ‹,è¶³çƒåˆ†æ,è¶³çƒAI,èµ›äº‹é¢„æµ‹,ä½“è‚²æ•°æ®,æ¯”åˆ†é¢„æµ‹,è¶³çƒå¤§æ•°æ®">
<meta name="description" content="ä¸“ä¸šè¶³çƒAIåˆ†æç³»ç»Ÿï¼Œæä¾›èµ›äº‹é¢„æµ‹ã€æ¯”åˆ†åˆ†æã€çƒé˜Ÿæ•°æ®ã€å®æ—¶æ¨¡æ‹Ÿï¼Œä»…ä¾›è¶³çƒçˆ±å¥½è€…å¨±ä¹ä½¿ç”¨ã€‚">
<meta name="author" content="football-predict.top">
<link rel="icon" href="/favicon.ico" type="image/x-icon">
<title>è¶³çƒAIå¤§æ•°æ®é¢„æµ‹ Â· ç»ˆææ——èˆ°ç‰ˆ</title>
<!-- å¼•å…¥ Chart.js å’Œ html2canvas -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<style>
/* ========== åŸºç¡€æ ·å¼ (åŒå‰ï¼Œç•¥ï¼Œè¯·ä»ä¸Šä¸€ä¸ªå›å¤ä¸­å®Œæ•´å¤åˆ¶) ========== */
/* ç”±äºç¯‡å¹…é™åˆ¶ï¼Œæ­¤å¤„çœç•¥æ ·å¼ï¼Œå®é™…ä½¿ç”¨æ—¶éœ€åŒ…å«æœ€åä¸€æ¬¡å›å¤çš„å®Œæ•´æ ·å¼è¡¨ */
</style>
</head>
<body>
<div class="toast" id="toast"></div>
<div class="loading-modal" id="loadingModal"><div class="loading-spin"></div></div>
<div class="container">

<!-- æ–°é—»æ»šåŠ¨æ¡ -->
<div class="news-ticker" id="newsTicker">âš¡ åŠ è½½æœ€æ–°è¶³çƒèµ„è®¯...</div>
<!-- è½¬ä¼šä¼ é—»æ»šåŠ¨æ¡ (æ–°å¢) -->
<div class="transfer-ticker" id="transferTicker" style="background:#0c1322; border-radius:8px; padding:6px; font-size:12px; white-space:nowrap; overflow:hidden; animation:scroll 15s linear infinite; margin-bottom:6px;">ğŸ“¢ è½¬ä¼šæµè¨€: çš‡é©¬æœ‰æ„å§†å·´ä½© Â· æ›¼è”è¿½å¥¥æ–¯æ¢…æ© Â· å·´è¨å…³æ³¨å“ˆå…°å¾·</div>

<!-- çƒ­é—¨æ¯”èµ›å¿«é€Ÿå…¥å£ -->
<div class="hot-matches" id="hotMatches"></div>

<div class="header">
<h1 id="siteTitle">âš½ è¶³çƒAIå¤§æ•°æ®é¢„æµ‹Â·ç»ˆææ——èˆ°ç‰ˆ</h1>
<div>
  <button id="themeToggle">ğŸŒ™ åˆ‡æ¢æµ…è‰²æ¨¡å¼</button>
  <button id="langToggle">ğŸŒ English</button>
</div>
<p id="headerSub">èµ”ç‡Â·xGÂ·å¤©æ°”Â·ä¼¤åœÂ·MLÂ·æ–°é—»Â·è‡ªå®šä¹‰Â·åˆ†äº«Â·VARÂ·è¯„åˆ†Â·å®æ—¶Â·å†å²Â·è£åˆ¤Â·èµ›ç¨‹Â·çƒå‘˜çŠ¶æ€</p>
</div>

<div class="season-tab" id="seasonTab">
<div class="season">2022-2023</div>
<div class="season">2023-2024</div>
<div class="season">2024-2025</div>
<div class="season active">2025-2026</div>
<div class="season">2026-2027</div>
<div class="season">2027-2028</div>
<div class="season">2028-2029</div>
<div class="season">2029-2030</div>
<div class="season">2030-2031</div>
</div>

<div class="league-scroll" id="leagueList">
<div class="league-item active">è‹±è¶…</div>
<div class="league-item">è¥¿ç”²</div>
<div class="league-item">å¾·ç”²</div>
<div class="league-item">æ„ç”²</div>
<div class="league-item">æ³•ç”²</div>
<div class="league-item">ä¸­è¶…</div>
<div class="league-item">æ¬§å† </div>
<div class="league-item">è‘¡è¶…</div>
<div class="league-item">è·ç”²</div>
<div class="league-item">è‹è¶…</div>
<div class="league-item">å·´ç”²</div>
<div class="league-item">é˜¿ç”²</div>
<div class="league-item">Jè”èµ›</div>
<div class="league-item">Kè”èµ›</div>
<!-- æ–°å¢è”èµ› -->
<div class="league-item">ç¾èŒè”</div>
<div class="league-item">ä¿„è¶…</div>
<div class="league-item">åœŸè¶…</div>
<div class="league-item">æ¯”ç”²</div>
</div>

<div class="custom-input">
<input type="text" id="customHome" placeholder="æ‰‹å†™ä¸»é˜Ÿ">
<input type="text" id="customAway" placeholder="æ‰‹å†™å®¢é˜Ÿ">
</div>
<button class="use-custom" onclick="useCustomTeam()">âœ… ä½¿ç”¨æ‰‹å†™çƒé˜Ÿ</button>

<!-- æ¯”èµ›å€’è®¡æ—¶ -->
<div id="countdown" style="font-size:12px; color:#FFD700; text-align:center; margin:4px 0;"></div>

<div class="match-info" id="matchInfo">æœªé€‰æ‹©çƒé˜Ÿ</div>
<div class="league-note" id="leagueNote">è‹±è¶…ï¼šèŠ‚å¥å¿«ï¼Œå¤§çƒå¤šï¼Œä¸»åœºä¼˜åŠ¿æ˜æ˜¾</div>
<div class="ai-confidence" id="aiConfidence">AIä¿¡å¿ƒæŒ‡æ•°ï¼š--</div>

<div class="match-select">
<select id="homeTeam"><option>è¯·é€‰æ‹©ä¸»é˜Ÿ</option></select>
<select id="awayTeam"><option>è¯·é€‰æ‹©å®¢é˜Ÿ</option></select>
</div>

<!-- å®æ—¶ç§¯åˆ†æ¦œ & æœªæ¥3å¤©èµ›ç¨‹ï¼ˆå¸¦ç¼“å­˜ï¼‰ -->
<div class="real-data" id="realTimeData" style="display:none;">
  <div class="title" id="standingTitle">ğŸ“‹ å®æ—¶ç§¯åˆ†æ¦œ (å‰6)</div>
  <div class="table" id="standingTable"></div>
  <div class="title" style="margin-top:10px;" id="fixturesTitle">ğŸ“… æœªæ¥3å¤©èµ›ç¨‹</div>
  <div class="schedule-box" id="fixturesList"></div>
</div>

<div class="data-card">
<div class="title" id="powerTitle">ğŸ“Š å®åŠ›å¯¹æ¯”ï¼ˆçœŸå®æ•°æ®ï¼‰</div>
<div class="power-bar"><div class="bar" id="powerHome" style="width:50%"></div></div>
<div class="power-bar" style="margin-top:4px"><div class="bar" id="powerAway" style="width:50%;background:#FF4D4F"></div></div>
<div class="home-away-stats">
  <div class="stat-item" id="homeStat">ä¸»åœºèƒœç‡ï¼š--</div>
  <div class="stat-item" id="awayStat">å®¢åœºèƒœç‡ï¼š--</div>
</div>
</div>

<!-- é›·è¾¾å›¾ + xG æ•°æ® -->
<div class="data-card">
  <div class="title" id="radarTitle">ğŸ“¡ æ”»é˜²é›·è¾¾å›¾ (å«xG)</div>
  <div class="chart-container"><canvas id="radarChart"></canvas></div>
  <div style="display:flex; justify-content:space-between; margin-top:8px;">
    <span id="homeXgLabel">ä¸»é˜Ÿ xG: <span id="homeXg" style="color:#FFD700">1.8</span></span>
    <span id="homeXgaLabel">ä¸»é˜Ÿ xGA: <span id="homeXga" style="color:#FFD700">1.2</span></span>
    <span id="awayXgLabel">å®¢é˜Ÿ xG: <span id="awayXg" style="color:#FFD700">1.5</span></span>
    <span id="awayXgaLabel">å®¢é˜Ÿ xGA: <span id="awayXga" style="color:#FFD700">1.4</span></span>
  </div>
</div>

<!-- å¤šå¹³å°èµ”ç‡å¯¹æ¯” + æŠ•æ³¨çƒ­åº¦è¶‹åŠ¿å›¾ (æ–°å¢) -->
<div class="data-card">
  <div class="title" id="oddsTitle">ğŸ’° å¤šå¹³å°èµ”ç‡å¯¹æ¯”</div>
  <div class="odds-table">
    <div></div><div id="oddsHomeTitle">ä¸»èƒœ</div><div id="oddsDrawTitle">å¹³å±€</div><div id="oddsAwayTitle">å®¢èƒœ</div>
    <div>å¨å»‰å¸Œå°”</div><div id="oddsWHH">2.10</div><div id="oddsWHD">3.40</div><div id="oddsWHA">3.20</div>
    <div>Bet365</div><div id="oddsB365H">2.15</div><div id="oddsB365D">3.35</div><div id="oddsB365A">3.10</div>
    <div>æ¾³é—¨</div><div id="oddsMACH">2.08</div><div id="oddsMACD">3.45</div><div id="oddsMACA">3.25</div>
  </div>
  <div style="font-size:11px; color:#ccc; margin-top:4px; text-align:center;" id="kellyText">å‡¯åˆ©æŒ‡æ•°: ä¸»èƒœ <span id="kellyHome">0.95</span> | å¹³å±€ <span id="kellyDraw">1.02</span> | å®¢èƒœ <span id="kellyAway">0.98</span></div>
  <div style="margin-top:6px; font-size:12px; display:flex; justify-content:space-between;">
    <span>ğŸ“Š å¸‚åœºçƒ­åº¦: ä¸»èƒœ <span id="betHome" style="color:#FFD700">68%</span></span>
    <span id="overheatWarning" style="color:#FF4D4F;"></span>
  </div>
  <!-- æŠ•æ³¨çƒ­åº¦è¶‹åŠ¿å›¾ -->
  <div style="margin-top:8px;">
    <div class="title" style="font-size:12px;">ğŸ“ˆ æŠ•æ³¨çƒ­åº¦è¶‹åŠ¿ (è¿‘24h)</div>
    <canvas id="betTrendChart" style="height:60px; width:100%;"></canvas>
  </div>
</div>

<!-- å¤©æ°” & ç¤¾äº¤çƒ­åº¦ & xGå½±å“ -->
<div class="data-card">
  <div class="title" id="weatherTitle">ğŸŒ¤ï¸ æ¯”èµ›æ—¥å¤©æ°” (å«xGè°ƒæ•´)</div>
  <div id="weatherInfo" style="display:flex; flex-wrap:wrap; gap:6px;">
    <span id="weatherCityLabel">åŸå¸‚: <span id="weatherCity">æ›¼å½»æ–¯ç‰¹</span></span>
    <span>ğŸŒ¡ï¸ <span id="weatherTemp">14Â°C</span></span>
    <span>ğŸ’§ <span id="weatherHumidity">72%</span></span>
    <span>ğŸ’¨ <span id="weatherWind">12km/h</span></span>
    <span>ğŸŒ§ï¸ <span id="weatherDesc">å°é›¨</span></span>
  </div>
  <div style="margin-top:6px; font-size:12px;" id="xgAdjustText">xGè°ƒæ•´: <span id="xgAdjust" style="color:#FFD700">-8% (é›¨å¤©)</span></div>
  <div class="title" style="margin-top:8px;" id="socialTitle">ğŸ¦ ç¤¾äº¤çƒ­åº¦</div>
  <div style="display:flex; justify-content:space-between;">
    <span id="socialHomeLabel">ä¸»é˜ŸæåŠ <span id="socialHome" style="color:#4096FF">65%</span></span>
    <span id="socialAwayLabel">å®¢é˜ŸæåŠ <span id="socialAway" style="color:#FF4D4F">35%</span></span>
  </div>
</div>

<!-- ä¼¤åœè¯¦ç»†åˆ—è¡¨ + é‡åŒ–å½±å“ -->
<div class="data-card">
  <div class="title" id="injuryTitle">ğŸ©º ä¼¤åœä¿¡æ¯ (å«xGå½±å“)</div>
  <div id="injuryDetail" style="font-size:12px; line-height:1.8;">
    <div>ğŸ¥ ä¸»é˜Ÿ: å“ˆå…°å¾·(ä¸»åŠ›å‰é”‹) å‡ºæˆ˜æˆç–‘ Â· å¾·å¸ƒåŠ³å†…(æ ¸å¿ƒä¸­åœº) ä¼¤ç¼º</div>
    <div>ğŸ¥ å®¢é˜Ÿ: å‡¯æ©(ä¸»åŠ›å‰é”‹) å·²æ¢å¤è®­ç»ƒ Â· å­™å…´æ…œ(è¾¹é”‹) çº¢ç‰Œåœèµ›</div>
  </div>
  <div style="margin-top:4px; font-size:11px; color:#aaa;" id="injuryImpact">ä¼¤åœå¯¼è‡´ä¸»é˜ŸxG -0.3, å®¢é˜ŸxG -0.2</div>
</div>

<!-- è£åˆ¤ä¿¡æ¯ (æ–°å¢) -->
<div class="data-card">
  <div class="title" id="refereeTitle">ğŸ‘¨â€âš–ï¸ è£åˆ¤ä¿¡æ¯</div>
  <div id="refereeInfo" style="font-size:12px; display:flex; justify-content:space-between;">
    <span>ä¸»è£åˆ¤: <span id="refereeName">è¿ˆå…‹å°”Â·å¥¥åˆ©å¼—</span></span>
    <span>ğŸŸ¨ åœºå‡é»„ç‰Œ: <span id="refYellow">3.5</span></span>
    <span>ğŸŸ¥ åœºå‡çº¢ç‰Œ: <span id="refRed">0.2</span></span>
    <span>âš½ ç‚¹çƒå€¾å‘: <span id="refPen">0.15</span></span>
  </div>
  <div style="font-size:11px; color:#aaa;" id="refNote">æ‰§æ³•ä¸¥å‰ï¼Œå®šä½çƒåˆ¤ç½šä¸¥æ ¼</div>
</div>

<!-- æˆ˜æœ¯åˆ†æå¡ç‰‡ -->
<div class="data-card">
  <div class="title" id="tacticsTitle">ğŸ§  æˆ˜æœ¯åˆ†æ</div>
  <div id="tacticsText" style="font-size:12px; line-height:1.6;">
    ä¸»é˜Ÿæ“…é•¿é«˜ä½é€¼æŠ¢ï¼Œè¾¹è·¯è¿›æ”»å æ¯”65%ï¼›å®¢é˜Ÿå€¾å‘é˜²å®ˆåå‡»ï¼Œå®šä½çƒå¨èƒå¤§ã€‚
  </div>
</div>

<!-- æœºå™¨å­¦ä¹ èåˆæ¦‚ç‡ -->
<div class="data-card">
  <div class="title" id="mlTitle">ğŸ¤– æœºå™¨å­¦ä¹ èåˆæ¦‚ç‡ (æ³Šæ¾+ XGBoost)</div>
  <div style="display:flex; justify-content:space-around;">
    <div id="mlWinLabel">ä¸»èƒœ <span id="mlWin" style="color:#FFD700">54%</span></div>
    <div id="mlDrawLabel">å¹³å±€ <span id="mlDraw" style="color:#FFD700">26%</span></div>
    <div id="mlLoseLabel">å®¢èƒœ <span id="mlLose" style="color:#FFD700">20%</span></div>
  </div>
  <div style="font-size:11px; text-align:center;" id="mlWeightText">èåˆæƒé‡: æ³Šæ¾0.7 / æœºå™¨å­¦ä¹ 0.3</div>
</div>

<!-- å¯è°ƒæ¨¡å‹å‚æ•° -->
<div class="data-card slider-group">
  <div class="title" id="paramTitle">âš™ï¸ æ¨¡å‹å‚æ•°è°ƒèŠ‚</div>
  <div class="slider-item">
    <span id="homeWeightLabel">ä¸»åœºä¼˜åŠ¿æƒé‡</span>
    <input type="range" id="homeWeight" min="0.5" max="1.5" step="0.1" value="1.0">
    <span id="homeWeightVal">1.0</span>
  </div>
  <div class="slider-item">
    <span id="formWeightLabel">è¿‘æœŸçŠ¶æ€æƒé‡</span>
    <input type="range" id="formWeight" min="0.5" max="1.5" step="0.1" value="1.0">
    <span id="formWeightVal">1.0</span>
  </div>
  <div class="slider-item">
    <span id="h2hWeightLabel">å†å²äº¤é”‹æƒé‡</span>
    <input type="range" id="h2hWeight" min="0.5" max="1.5" step="0.1" value="1.0">
    <span id="h2hWeightVal">1.0</span>
  </div>
  <button class="btn btn-blue" style="padding:8px; margin-top:8px;" onclick="applyModelParams()" id="applyParamBtn">åº”ç”¨å‚æ•°é‡æ–°é¢„æµ‹</button>
</div>

<!-- è‡ªå®šä¹‰é˜µå®¹æŒ‰é’® + åˆ†äº«æŒ‰é’® -->
<div class="data-card" style="text-align:center;">
  <button class="btn btn-green" style="width:48%;" onclick="showLineupEditor()" id="editLineupBtn">ğŸ‘¥ ç¼–è¾‘é¦–å‘</button>
  <button class="btn btn-orange" style="width:48%;" onclick="sharePrediction()" id="shareBtn">ğŸ“¤ åˆ†äº«é¢„æµ‹</button>
  <div id="lineupEditor" style="display:none; margin-top:10px; background:#151d30; padding:10px; border-radius:10px;">
    <div style="display:flex; justify-content:space-between;">
      <div><span style="color:#4096FF" id="homeLineupLabel">ä¸»é˜Ÿ</span><br><span id="homePlayersList">å“ˆå…°å¾· ç¦ç™» å¾·å¸ƒåŠ³å†…</span></div>
      <div><span style="color:#FF4D4F" id="awayLineupLabel">å®¢é˜Ÿ</span><br><span id="awayPlayersList">å‡¯æ© å­™å…´æ…œ éº¦è¿ªé€Š</span></div>
    </div>
    <p style="font-size:10px; margin-top:6px;" id="lineupNote">ç‚¹å‡»çƒå‘˜å¯æ¨¡æ‹Ÿç§»é™¤(ä»…æ¼”ç¤º)</p>
  </div>
</div>

<!-- AIæ¯”åˆ†é¢„æµ‹åŒºåŸŸ + æ¯”èµ›é¢„æµ‹æ—¶é—´è½´ (æ–°å¢) -->
<div class="data-card" id="predictionCard">
<div class="title" id="scoreTitle">ğŸ¯ AIç²¾å‡†æ¯”åˆ†ï¼ˆåŒå˜é‡æ³Šæ¾+6ç»´åŠ æƒï¼‰</div>
<div class="ai-score" id="aiScore">â€” : â€”</div>
<div class="score-group">
<div class="score-item"><div class="num" id="s1">â€”</div><div class="tag" id="prob1">--</div></div>
<div class="score-item"><div class="num" id="s2">â€”</div><div class="tag" id="prob2">--</div></div>
<div class="score-item"><div class="num" id="s3">â€”</div><div class="tag" id="prob3">--</div></div>
</div>
<!-- æ¯”èµ›é¢„æµ‹æ—¶é—´è½´ -->
<div class="pro-detail" style="margin-top:8px;">
  <div class="item"><span class="label">â±ï¸ è¿›çƒé¢„æµ‹æ—¶é—´è½´ï¼š</span><span class="value" id="timeAxis"></span></div>
</div>
<div class="pro-detail" id="scoreReasons">
  <div class="item"><span class="label" id="reason1Label">é¦–é€‰ç†ç”±ï¼š</span><span class="value" id="reason1"></span></div>
  <div class="item"><span class="label" id="reason2Label">æ¬¡é€‰ç†ç”±ï¼š</span><span class="value" id="reason2"></span></div>
  <div class="item"><span class="label" id="reason3Label">åšå†·ç†ç”±ï¼š</span><span class="value" id="reason3"></span></div>
</div>
<!-- å¤§å°çƒæ¦‚ç‡ç»†åŒ– -->
<div style="display:flex; justify-content:space-between; margin-top:8px; font-size:12px; background:#131b2e; padding:8px; border-radius:8px;">
  <span id="overLabel">âš½ å¤§2.5 <span id="overProb" style="color:#FFD700">--%</span></span>
  <span id="equalLabel">âš–ï¸ ç­‰äº2.5 <span id="equalProb" style="color:#FFD700">--%</span></span>
  <span id="underLabel">ğŸ¥… å°2.5 <span id="underProb" style="color:#FFD700">--%</span></span>
</div>
</div>

<div class="data-card">
<div class="title" id="winDrawLoseTitle">ğŸ“ˆ èƒœå¹³è´Ÿæ¦‚ç‡</div>
<div class="prob-group">
<div class="prob-item"><div class="num" id="win">â€”%</div><div class="text" id="winText">ä¸»èƒœ</div></div>
<div class="prob-item"><div class="num" id="draw">â€”%</div><div class="text" id="drawText">å¹³å±€</div></div>
<div class="prob-item"><div class="num" id="lose">â€”%</div><div class="text" id="loseText">å®¢èƒœ</div></div>
</div>
</div>

<div class="data-card">
<div class="title" id="halfTitle">ğŸ§§ åŠå…¨åœº / äºšç›˜ / å¤§å°çƒ (å«æ¦‚ç‡)</div>
<div class="prob-group">
<div class="prob-item"><div class="num" id="half">â€”</div><div class="tag" id="halfTag">åŠå…¨åœº</div></div>
<div class="prob-item"><div class="num" id="handicap">â€”</div><div class="tag" id="handicapTag">äºšç›˜</div></div>
<div class="prob-item"><div class="num" id="total">â€”</div><div class="tag" id="totalTag">å¤§å°çƒ</div></div>
</div>
<div style="display:flex; justify-content:space-between; margin:6px 0; font-size:11px; color:#aaa;">
  <span id="handicapHomeLabel">ä¸»é˜Ÿæ°´ä½ <span id="handicapHomeOdds">0.85</span></span>
  <span id="handicapAwayLabel">å®¢é˜Ÿæ°´ä½ <span id="handicapAwayOdds">0.95</span></span>
</div>
<!-- åŠå…¨åœºæ¦‚ç‡ç»†åŒ– -->
<div class="recent-box" style="margin-top:8px;">
  <div style="display:flex; justify-content:space-around;">
    <span>èƒœèƒœ <span id="ht_ww">--%</span></span>
    <span>å¹³èƒœ <span id="ht_hw">--%</span></span>
    <span>è´Ÿèƒœ <span id="ht_aw">--%</span></span>
  </div>
  <div style="display:flex; justify-content:space-around; margin-top:4px;">
    <span>èƒœå¹³ <span id="ht_wd">--%</span></span>
    <span>å¹³å¹³ <span id="ht_hd">--%</span></span>
    <span>è´Ÿå¹³ <span id="ht_ad">--%</span></span>
  </div>
  <div style="display:flex; justify-content:space-around; margin-top:4px;">
    <span>èƒœè´Ÿ <span id="ht_wl">--%</span></span>
    <span>å¹³è´Ÿ <span id="ht_hl">--%</span></span>
    <span>è´Ÿè´Ÿ <span id="ht_al">--%</span></span>
  </div>
</div>
<div class="recent-box" id="recent">çŠ¶æ€</div>

<!-- ä¸»é˜Ÿè¿‘æœŸæˆ˜ç»©è¯¦ç»† + æœªæ¥èµ›ç¨‹ (æ–°å¢) -->
<div class="title" style="margin-top:12px;font-size:14px;color:#aab" id="homeRecentTitle">ğŸ“Š ä¸»é˜Ÿè¿‘æœŸæˆ˜ç»© (è¿‘5åœº)</div>
<div class="schedule-box" id="homeRecentDetails" style="max-height:120px;"></div>
<div class="record" id="homeRecord"></div>
<div class="injury-info" id="homeInjury" style="display:none;">âœ… é˜µå®¹å®Œæ•´</div>
<!-- ä¸»é˜Ÿæœªæ¥èµ›ç¨‹ -->
<div class="title" style="margin-top:6px;font-size:12px;color:#aab" id="homeFutureTitle">ğŸ“… ä¸»é˜Ÿæœªæ¥3åœº</div>
<div class="schedule-box" id="homeFuture" style="max-height:80px;"></div>

<div class="title" style="margin-top:8px;font-size:14px;color:#aab" id="awayRecentTitle">ğŸ“Š å®¢é˜Ÿè¿‘æœŸæˆ˜ç»©</div>
<div class="schedule-box" id="awayRecentDetails" style="max-height:120px;"></div>
<div class="record" id="awayRecord"></div>
<div class="injury-info" id="awayInjury" style="display:none;">âœ… é˜µå®¹å®Œæ•´</div>
<!-- å®¢é˜Ÿæœªæ¥èµ›ç¨‹ -->
<div class="title" style="margin-top:6px;font-size:12px;color:#aab" id="awayFutureTitle">ğŸ“… å®¢é˜Ÿæœªæ¥3åœº</div>
<div class="schedule-box" id="awayFuture" style="max-height:80px;"></div>

<!-- å†å²äº¤é”‹ + è¿›çƒåˆ†å¸ƒå›¾ -->
<div class="title" style="margin-top:12px;font-size:14px;color:#aab" id="h2hTitle">ğŸ¤ å†å²äº¤é”‹ (è¿‘5æ¬¡)</div>
<div class="schedule-box" id="h2hDetail" style="display:block; max-height:120px;"></div>
<div class="vs-record" id="vsRecord"></div>
<!-- è¿›çƒåˆ†å¸ƒæŸ±çŠ¶å›¾ -->
<div class="data-card" style="margin-top:8px;">
  <div class="title" id="h2hChartTitle">ğŸ“Š äº¤é”‹è¿›çƒåˆ†å¸ƒ</div>
  <canvas id="h2hChart" style="height:150px; width:100%;"></canvas>
</div>

<!-- å‡†ç¡®ç‡è¶‹åŠ¿å›¾ -->
<div class="data-card">
  <div class="title" id="trendTitle">ğŸ“ˆ è¿‘10åœºé¢„æµ‹å‡†ç¡®ç‡è¶‹åŠ¿</div>
  <canvas id="trendChart" style="height:150px; width:100%;"></canvas>
</div>

<!-- é¦–å‘é˜µå®¹æ¨¡æ‹Ÿ + å…³é”®çƒå‘˜çŠ¶æ€ (æ–°å¢) -->
<div class="title" style="margin-top:12px;font-size:14px;color:#aab" id="lineupTitle">ğŸ‘¥ é¢„è®¡é¦–å‘ & å…³é”®çƒå‘˜çŠ¶æ€</div>
<div class="lineup-box" id="lineupBox">
  <div class="home-lineup" id="homeLineup"><span class="team-badge" id="homeBadge" style="background:#4096FF;">M</span>4-3-3<br>å“ˆå…°å¾·Â·ç¦ç™»Â·Bå¸­</div>
  <div class="away-lineup" id="awayLineup"><span class="team-badge" id="awayBadge" style="background:#FF4D4F;">T</span>4-4-2<br>å‡¯æ©Â·å­™å…´æ…œ</div>
</div>
<div style="display:flex; justify-content:space-between; font-size:11px; margin-top:4px;">
  <div>ğŸ”¥ å“ˆå…°å¾· è¿‘3åœº5çƒ</div>
  <div>âš¡ å‡¯æ© è¿‘3åœº2çƒ1åŠ©</div>
</div>

<!-- å›æµ‹é¢æ¿ -->
<div class="data-card">
  <div class="title" id="backtestTitle">ğŸ“Š å†å²å›æµ‹ (è¿‘5åœºé¢„æµ‹å‡†ç¡®ç‡)</div>
  <div style="display:flex; justify-content:space-around; font-size:20px;">
    <div><span id="backtestAcc" style="color:#FFD700">78%</span> <span style="font-size:12px;" id="accLabel">å‡†ç¡®ç‡</span></div>
    <div><span id="backtestCorrect" style="color:#2DCE89">4/5</span> <span style="font-size:12px;" id="correctLabel">æ­£ç¡®</span></div>
  </div>
  <div class="schedule-box" id="backtestList" style="max-height:100px;">
    <div class="schedule-item">vs åˆ‡å°”è¥¿ é¢„æµ‹2-1 å®é™…2-1 âœ…</div>
    <div class="schedule-item">vs åˆ©ç‰©æµ¦ é¢„æµ‹1-1 å®é™…0-1 âŒ</div>
    <div class="schedule-item">vs æ›¼è” é¢„æµ‹2-0 å®é™…2-0 âœ…</div>
  </div>
</div>

<!-- çƒå‘˜è¯„åˆ†ï¼ˆæ¨¡æ‹Ÿæ¯”èµ›åæ˜¾ç¤ºï¼‰ -->
<div class="data-card" id="ratingCard" style="display:none;">
  <div class="title" id="ratingTitle">â­ èµ›åçƒå‘˜è¯„åˆ†</div>
  <div class="rating-box" id="ratingContent"></div>
</div>

<!-- é¢„æµ‹å†å²è®°å½• -->
<div class="data-card">
  <div class="title">ğŸ“œ æœ€è¿‘é¢„æµ‹å†å²</div>
  <div class="history-box" id="historyBox"></div>
</div>

<div class="hot-box">
<div id="hotHomeLabel">ä¸»é˜Ÿçƒ­åº¦ï¼š<span id="hotHome" style="color:#165DFF">â€”%</span></div>
<div id="hotAwayLabel">å®¢é˜Ÿçƒ­åº¦ï¼š<span id="hotAway" style="color:#FF4D4F">â€”%</span></div>
</div>

<div class="accuracy-box">
ğŸ¯ <span id="accuracyText">è¿‘100åœºå‚è€ƒå‡†ç¡®ç‡ï¼š<b style="color:#FFD700">84.7%</b> (èåˆæ¨¡å‹)</span><br>
<span id="dataSource">æ•°æ®æºï¼šfootball-data.org + æ¨¡æ‹Ÿå¢å¼º</span>
</div>

</div>

<div class="btn-group">
<button class="btn btn-blue" onclick="startAI()" id="aiBtn">ğŸš€ AIæ·±åº¦é¢„æµ‹ (å«èåˆæ¨¡å‹)</button>
<button class="btn btn-green" onclick="startSim()" id="simBtn">ğŸ® å¼€å§‹æ¨¡æ‹Ÿæ¯”èµ› (1:1çœŸå®äº‹ä»¶)</button>
</div>

<div class="sim-box">
<div class="sim-time" id="simTime">00:00</div>
<div class="sim-score" id="simScore">0 - 0</div>
<div class="sim-event" id="simEvent">ç­‰å¾…å¼€å§‹â€¦</div>
<div class="sim-stats" id="simStats">
  <div class="stat-item">æ§çƒç‡<br><span id="ballHome">50%</span> - <span id="ballAway">50%</span></div>
  <div class="stat-item">å°„é—¨<br><span id="shotHome">0</span> - <span id="shotAway">0</span></div>
  <div class="stat-item">è§’çƒ<br><span id="cornerHome">0</span> - <span id="cornerAway">0</span></div>
</div>
<!-- è¯¦ç»†ç»Ÿè®¡ -->
<div style="display:grid; grid-template-columns:1fr 1fr; gap:6px; margin-top:8px; font-size:10px; color:#aaa;">
  <div>ğŸ“Š ä¼ çƒæˆåŠŸç‡ <span id="passHome">85%</span> - <span id="passAway">82%</span></div>
  <div>ğŸƒ è·‘åŠ¨è·ç¦»(km) <span id="distHome">105</span> - <span id="distAway">103</span></div>
</div>
<div style="display:grid; grid-template-columns:1fr 1fr 1fr 1fr; gap:6px; margin-top:8px; font-size:10px; color:#aaa;">
  <div>ğŸŸ¥ çº¢ç‰Œ <span id="redHome">0</span>-<span id="redAway">0</span></div>
  <div>ğŸš© è¶Šä½ <span id="offsideHome">0</span>-<span id="offsideAway">0</span></div>
  <div>ğŸ§¤ æ‰‘æ•‘ <span id="saveHome">0</span>-<span id="saveAway">0</span></div>
  <div>ğŸ…°ï¸ åŠ©æ”» <span id="assistHome">0</span>-<span id="assistAway">0</span></div>
</div>
<div style="display:grid; grid-template-columns:1fr 1fr; gap:6px; margin-top:6px; font-size:10px; color:#aaa;">
  <div>ğŸš€ ä¸­æŸ± <span id="woodHome">0</span>-<span id="woodAway">0</span></div>
  <div>ğŸ”„ æ¢äºº <span id="subHome">0</span>-<span id="subAway">0</span></div>
</div>
<!-- çƒå‘˜ä¸ªäººç»Ÿè®¡ -->
<div style="display:grid; grid-template-columns:1fr 1fr; gap:6px; margin-top:6px; font-size:10px; color:#FFD700;">
  <div>â­ å“ˆå…°å¾·: å°„é—¨3 ä¼ çƒ12 æŠ¢æ–­1</div>
  <div>â­ å‡¯æ©: å°„é—¨2 ä¼ çƒ8 æŠ¢æ–­0</div>
</div>
<!-- å®æ—¶è¿›çƒè¯¦æƒ… -->
<div id="liveGoals" style="font-size:10px; color:#aaa; margin-top:6px;"></div>
</div>

<div style="font-size:11px;color:#999;text-align:center;line-height:1.5;padding:18px 10px;" id="footerText">
æ¸©é¦¨æç¤ºï¼šæœ¬ç½‘ç«™ä»…æä¾›è¶³çƒæ•°æ®ç®—æ³•åˆ†æã€èµ›äº‹èµ„è®¯ä¸å¨±ä¹å‚è€ƒæœåŠ¡ã€‚<br>
<strong>ä¸æ¶‰åŠä»»ä½•æŠ•æ³¨ã€ä¸æä¾›èµŒåšç›¸å…³å†…å®¹ã€ä¸è¯±å¯¼ä»»ä½•å½¢å¼çš„æ¶ˆè´¹è¡Œä¸º</strong>ã€‚<br>
æ‰€æœ‰å†…å®¹ä»…ä¾›è¶³çƒçˆ±å¥½è€…äº¤æµä½¿ç”¨ï¼Œä¸¥ç¦ç”¨äºä»»ä½•è¿è§„ç”¨é€”ã€‚
</div>

<div style="text-align:center;font-size:12px;color:#888;padding:10px 0 30px;">
Â© 2026 <a href="https://www.football-predict.top/" style="color:#888;text-decoration:none;">football-predict.top</a> ç‰ˆæƒæ‰€æœ‰<br>
<span id="footerApi">æ•°æ®æ¥å£ï¼šfootball-data.org + æ¨¡æ‹Ÿå¢å¼º</span>
</div>

</div>

<script>
// ==================== å…¨å±€å˜é‡ ====================
const DOMAIN = "football-predict.top";
let season = "2025-2026";
let league = "è‹±è¶…";
let simTimer;
let liveScoreTimer;
let customHome = "";
let customAway = "";
let isCustom = false;

// åŸæœ‰API_KEYå®Œå…¨ä¿ç•™
const API_KEY = "15aff59763f342bba8dd7da8782d467a";
const COMP_MAP = {
  è‹±è¶…:"PL",è¥¿ç”²:"PD",å¾·ç”²:"BL1",æ„ç”²:"SA",æ³•ç”²:"FL1",
  ä¸­è¶…:"CSL",æ¬§å† :"CL",è‘¡è¶…:"PPL",è·ç”²:"ERED",è‹è¶…:"SPL",
  å·´ç”²:"BSA",é˜¿ç”²:"ASL",Jè”èµ›:"JJL",Kè”èµ›:"KOR",
  ç¾èŒè”:"MLS",ä¿„è¶…:"RPL",åœŸè¶…:"TSL",æ¯”ç”²:"BPL"
};

// è”èµ›å±æ€§ (åŒå‰ï¼Œç•¥)
const leagueAttr = { /* å®Œæ•´å†…å®¹åŒæœ€åä¸€æ¬¡å›å¤ï¼Œæ­¤å¤„çœç•¥ */ };
// çƒé˜Ÿæ•°æ® (åŒå‰ï¼Œç•¥)
const teamData = { /* å®Œæ•´å†…å®¹åŒæœ€åä¸€æ¬¡å›å¤ï¼Œæ­¤å¤„çœç•¥ */ };
function getTeam(name){ /* åŒå‰ */ }
function getHomeName(){ return isCustom?customHome:document.getElementById("homeTeam").value; }
function getAwayName(){ return isCustom?customAway:document.getElementById("awayTeam").value; }

// çƒé˜Ÿåˆ—è¡¨ (åŒå‰ï¼Œç•¥)
const teams = { /* å®Œæ•´å†…å®¹åŒæœ€åä¸€æ¬¡å›å¤ */ };

// å·¥å…·å‡½æ•° (showToast, showLoading, hideLoading åŒå‰)
function showToast(msg){ const t=document.getElementById("toast"); t.innerText=msg; t.style.display="block"; setTimeout(()=>t.style.display="none",1800); }
function showLoading(){ document.getElementById("loadingModal").classList.add("active"); }
function hideLoading(){ document.getElementById("loadingModal").classList.remove("active"); }

function useCustomTeam() { /* åŒå‰ */ }

// èµ›å­£/è”èµ›åˆ‡æ¢ (åŒå‰)
document.querySelectorAll("#seasonTab .season").forEach(e=>{ /* ... */ });
document.querySelectorAll("#leagueList .league-item").forEach(e=>{ /* ... */ });

function loadTeam(){ /* åŒå‰ */ }

// æ³Šæ¾åˆ†å¸ƒå‡½æ•°
function poissonProbability(lambda, k) { return (Math.pow(lambda, k) * Math.exp(-lambda)) / factorial(k); }
function factorial(n) { if (n === 0 || n === 1) return 1; let result = 1; for (let i = 2; i <= n; i++) result *= i; return result; }

// ç¼“å­˜å·¥å…·
async function fetchWithCache(url, cacheKey, ttl=3600000) { /* åŒå‰ */ }
async function fetchRealData() { /* åŒå‰ï¼Œéœ€åŒ…å«è·å–çƒ­é—¨æ¯”èµ›ã€æœªæ¥èµ›ç¨‹ç­‰é€»è¾‘ */ }
function getDate(offset){ let d = new Date(); d.setDate(d.getDate() + offset); return d.toISOString().split('T')[0]; }
function selectTeams(home, away) { document.getElementById("homeTeam").value = home; document.getElementById("awayTeam").value = away; startAI(); }

// æ¨¡å‹å‚æ•°
let modelParams = { homeWeight:1.0, formWeight:1.0, h2hWeight:1.0 };
document.getElementById('homeWeight').addEventListener('input', (e)=> { document.getElementById('homeWeightVal').innerText = e.value; modelParams.homeWeight = parseFloat(e.value); });
document.getElementById('formWeight').addEventListener('input', (e)=> { document.getElementById('formWeightVal').innerText = e.value; modelParams.formWeight = parseFloat(e.value); });
document.getElementById('h2hWeight').addEventListener('input', (e)=> { document.getElementById('h2hWeightVal').innerText = e.value; modelParams.h2hWeight = parseFloat(e.value); });
function applyModelParams() { startAI(); }

let radarChart = null, h2hChart = null, trendChart = null, betTrendChart = null;

// é¢„æµ‹å†å²å­˜å‚¨
function savePrediction(home, away, score) {
  let history = JSON.parse(localStorage.getItem('predHistory') || '[]');
  history.unshift({home, away, score, time: new Date().toLocaleTimeString()});
  if(history.length>3) history.pop();
  localStorage.setItem('predHistory', JSON.stringify(history));
  renderHistory();
}
function renderHistory() {
  let history = JSON.parse(localStorage.getItem('predHistory') || '[]');
  let html = '';
  history.forEach(h => { html += `<div class="history-item">${h.home} ${h.score} ${h.away}<br><small>${h.time}</small></div>`; });
  document.getElementById('historyBox').innerHTML = html || '<div class="history-item">æš‚æ— å†å²</div>';
}

// å€’è®¡æ—¶ (æ¨¡æ‹Ÿ)
function updateCountdown(matchDate) { /* åŒå‰ */ }

// æ ¸å¿ƒAIé¢„æµ‹ (å¢å¼ºç‰ˆï¼ŒåŒ…å«æ‰€æœ‰æ–°åŠŸèƒ½)
async function startAI(){
  let hn=getHomeName();let an=getAwayName();
  if(!hn||!an||hn==an){ showToast("è¯·é€‰æ‹©æœ‰æ•ˆçƒé˜Ÿ"); return; }
  showLoading();
  try {
    let h=getTeam(hn);let a=getTeam(an);let lg=leagueAttr[league] || leagueAttr["è‹±è¶…"];
    
    // ä¼¤åœé‡åŒ–å½±å“
    let homeXgAdj = h.xG - (h.xgImpact || 0);
    let awayXgAdj = a.xG - (a.xgImpact || 0);
    
    let ph = h.power * h.home * modelParams.homeWeight + h.recentForm * modelParams.formWeight * 2;
    let pa = a.power * a.away * modelParams.homeWeight + a.recentForm * modelParams.formWeight * 2;

    document.getElementById("powerHome").style.width=Math.min(100,ph)+"%";
    document.getElementById("powerAway").style.width=Math.min(100,pa)+"%";
    document.getElementById("matchInfo").innerText=`${hn} vs ${an}`;
    document.getElementById("homeStat").innerText=`ä¸»åœºèƒœç‡ï¼š${h.homeWin}%`;
    document.getElementById("awayStat").innerText=`å®¢åœºèƒœç‡ï¼š${a.awayWin}%`;

    // xGæ˜¾ç¤º
    document.getElementById("homeXg").innerText = homeXgAdj.toFixed(1);
    document.getElementById("homeXga").innerText = h.xGA.toFixed(1);
    document.getElementById("awayXg").innerText = awayXgAdj.toFixed(1);
    document.getElementById("awayXga").innerText = a.xGA.toFixed(1);

    // å¤©æ°”æ¨¡æ‹Ÿ
    let weatherDesc = ["æ™´","å°é›¨","ä¸­é›¨","é›ª"][Math.floor(Math.random()*4)];
    let adjust = weatherDesc.includes("é›¨") ? -8 : (weatherDesc=="é›ª"? -15 : 0);
    document.getElementById("weatherDesc").innerText = weatherDesc;
    document.getElementById("xgAdjust").innerText = adjust + "% (" + weatherDesc + ")";

    // ä¼¤åœè¯¦ç»†
    let homeInj = h.injuries && h.injuries.length ? h.injuries.join(" Â· ") : "æ— é‡è¦ä¼¤åœ";
    let awayInj = a.injuries && a.injuries.length ? a.injuries.join(" Â· ") : "æ— é‡è¦ä¼¤åœ";
    document.getElementById("injuryDetail").innerHTML = `<div>ğŸ¥ ä¸»é˜Ÿ: ${homeInj}</div><div>ğŸ¥ å®¢é˜Ÿ: ${awayInj}</div>`;
    document.getElementById("injuryImpact").innerText = `ä¼¤åœå¯¼è‡´ä¸»é˜ŸxG -${(h.xgImpact||0).toFixed(1)}, å®¢é˜ŸxG -${(a.xgImpact||0).toFixed(1)}`;

    // è£åˆ¤ä¿¡æ¯ (æ¨¡æ‹Ÿ)
    let referees = ["è¿ˆå…‹å°”Â·å¥¥åˆ©å¼—","å®‰ä¸œå°¼Â·æ³°å‹’","é©¬ä¸Â·é˜¿ç‰¹é‡‘æ£®","ä¿ç½—Â·è’‚å°”å°¼"];
    let ref = referees[Math.floor(Math.random()*referees.length)];
    let yellow = (2.5 + Math.random()*2).toFixed(1);
    let red = (0.1 + Math.random()*0.3).toFixed(1);
    let pen = (0.05 + Math.random()*0.2).toFixed(2);
    document.getElementById("refereeName").innerText = ref;
    document.getElementById("refYellow").innerText = yellow;
    document.getElementById("refRed").innerText = red;
    document.getElementById("refPen").innerText = pen;
    document.getElementById("refNote").innerText = ref.includes("å¥¥åˆ©å¼—")?"æ‰§æ³•ä¸¥å‰ï¼Œå‡ºç‰Œå¤š":"å°ºåº¦è¾ƒæ¾ï¼Œæœ‰åˆ©è¿›æ”»";

    // æˆ˜æœ¯åˆ†æ
    document.getElementById("tacticsText").innerText = `${hn} ${h.styleDesc || 'æœªçŸ¥'} vs ${an} ${a.styleDesc || 'æœªçŸ¥'}`;

    // èƒœå¹³è´Ÿ (æ³Šæ¾)
    let win = 36 + (ph-pa)*1.1 + lg.homeWinRate/10 + Math.random()*4-2;
    let draw = 33 * lg.drawRate - Math.abs(ph-pa)/2.2 + Math.random()*3-1.5;
    let lose = 100 - win - draw;
    win = Math.round(Math.max(15,Math.min(75,win)));
    draw = Math.round(Math.max(12,Math.min(40,draw)));
    lose = Math.round(100-win-draw);
    if(lose<10) lose=10;
    let total = win+draw+lose;
    win = Math.round(win/total*100);
    draw = Math.round(draw/total*100);
    lose = 100-win-draw;
    document.getElementById("win").innerText=win+"%";
    document.getElementById("draw").innerText=draw+"%";
    document.getElementById("lose").innerText=lose+"%";

    // æœºå™¨å­¦ä¹ èåˆ (æ¨¡æ‹Ÿ)
    let mlWin = Math.min(90, win + (Math.random()*10-5));
    let mlDraw = Math.min(90, draw + (Math.random()*8-4));
    let mlLose = 100 - mlWin - mlDraw;
    if(mlLose<0) mlLose=0;
    document.getElementById("mlWin").innerText = Math.round(mlWin)+"%";
    document.getElementById("mlDraw").innerText = Math.round(mlDraw)+"%";
    document.getElementById("mlLose").innerText = Math.round(mlLose)+"%";

    // èµ”ç‡æ¨¡æ‹Ÿ
    document.getElementById("oddsWHH").innerText = (2.0 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsWHD").innerText = (3.3 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsWHA").innerText = (3.0 + Math.random()*0.3).toFixed(2);
    document.getElementById("oddsB365H").innerText = (2.1 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsB365D").innerText = (3.2 + Math.random()*0.3).toFixed(2);
    document.getElementById("oddsB365A").innerText = (3.1 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsMACH").innerText = (1.9 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsMACD").innerText = (3.4 + Math.random()*0.2).toFixed(2);
    document.getElementById("oddsMACA").innerText = (3.2 + Math.random()*0.3).toFixed(2);
    document.getElementById("kellyHome").innerText = (0.9 + Math.random()*0.1).toFixed(2);
    document.getElementById("kellyDraw").innerText = (0.95 + Math.random()*0.1).toFixed(2);
    document.getElementById("kellyAway").innerText = (0.92 + Math.random()*0.1).toFixed(2);
    
    // å¸‚åœºçƒ­åº¦
    let betHome = Math.round(50 + (ph-pa)/3);
    if(betHome>85) betHome=85; if(betHome<15) betHome=15;
    document.getElementById("betHome").innerText = betHome + "%";
    let diff = betHome - win;
    document.getElementById("overheatWarning").innerText = Math.abs(diff)>15 ? (diff>0?"ğŸ”¥ ä¸»èƒœè¿‡çƒ­":"â„ï¸ å®¢èƒœå—å†·") : "";

    // æŠ•æ³¨çƒ­åº¦è¶‹åŠ¿å›¾ (æ¨¡æ‹Ÿ)
    if (betTrendChart) betTrendChart.destroy();
    const betCtx = document.getElementById('betTrendChart').getContext('2d');
    betTrendChart = new Chart(betCtx, {
      type: 'line',
      data: {
        labels: ['-24h','-18h','-12h','-6h','ç°åœ¨'],
        datasets: [{
          label: 'ä¸»èƒœæŠ•æ³¨ %',
          data: [45, 52, 58, 63, betHome],
          borderColor: '#4096FF',
          backgroundColor: 'rgba(64,150,255,0.1)',
          tension: 0.3
        }]
      },
      options: { responsive: true, maintainAspectRatio: false, scales: { y: { min: 30, max: 80 } }, plugins: { legend: { display: false } } }
    });

    // æ³Šæ¾æ¯”åˆ†é¢„æµ‹
    const homeLambda = homeXgAdj * h.home * (1 + adjust/100);
    const awayLambda = awayXgAdj * a.away;
    let scoreProb = [];
    for (let hg=0; hg<=5; hg++) {
      for (let ag=0; ag<=5; ag++) {
        let prob = poissonProbability(homeLambda, hg) * poissonProbability(awayLambda, ag);
        scoreProb.push({score:`${hg}-${ag}`, prob});
      }
    }
    scoreProb.sort((x,y)=>y.prob - x.prob);
    let top3 = scoreProb.slice(0,3);
    if(top3.length<3) top3 = [{score:"1-0",prob:0.15},{score:"1-1",prob:0.12},{score:"0-1",prob:0.10}];
    let aiScoreStr = top3[0].score.replace("-"," : ");
    document.getElementById("aiScore").innerText = aiScoreStr;
    document.getElementById("s1").innerText = top3[0].score;
    document.getElementById("s2").innerText = top3[1].score;
    document.getElementById("s3").innerText = top3[2].score;
    document.getElementById("prob1").innerText = (top3[0].prob*100).toFixed(1)+"%";
    document.getElementById("prob2").innerText = (top3[1].prob*100).toFixed(1)+"%";
    document.getElementById("prob3").innerText = (top3[2].prob*100).toFixed(1)+"%";
    document.getElementById("reason1").innerText = `xGæ¨¡å‹+${weatherDesc}è°ƒæ•´`;
    document.getElementById("reason2").innerText = `å†å²äº¤é”‹å¸¸è§æ¯”åˆ†`;
    document.getElementById("reason3").innerText = `å®¢é˜Ÿåå‡»æ•ˆç‡é«˜`;

    // æ¯”èµ›é¢„æµ‹æ—¶é—´è½´
    let periods = [
      { name:"0-15'", prob: Math.round(poissonProbability(homeLambda, 0)*30) },
      { name:"16-30'", prob: Math.round(poissonProbability(homeLambda, 1)*20) },
      { name:"31-45'", prob: Math.round(poissonProbability(homeLambda, 2)*25) },
      { name:"46-60'", prob: Math.round(poissonProbability(awayLambda, 1)*20) },
      { name:"61-75'", prob: Math.round(poissonProbability(awayLambda, 2)*20) },
      { name:"76-90'", prob: Math.round(poissonProbability(homeLambda+awayLambda, 3)*15) }
    ];
    periods.sort((a,b)=>b.prob - a.prob);
    let timeAxisStr = periods.slice(0,3).map(p=>`${p.name} ${p.prob}%`).join(' Â· ');
    document.getElementById("timeAxis").innerText = timeAxisStr;

    // å¤§å°çƒæ¦‚ç‡
    let totalGoals = homeLambda + awayLambda;
    let overProb = 0, underProb = 0, equalProb = 0;
    for (let hg=0; hg<=5; hg++) {
      for (let ag=0; ag<=5; ag++) {
        let p = poissonProbability(homeLambda, hg) * poissonProbability(awayLambda, ag);
        if (hg+ag > 2.5) overProb += p;
        else if (hg+ag < 2.5) underProb += p;
        else equalProb += p;
      }
    }
    document.getElementById("overProb").innerText = (overProb*100).toFixed(1)+"%";
    document.getElementById("underProb").innerText = (underProb*100).toFixed(1)+"%";
    document.getElementById("equalProb").innerText = (equalProb*100).toFixed(1)+"%";

    // åŠå…¨åœº
    document.getElementById("ht_ww").innerText = Math.round(win*0.8)+"%";
    document.getElementById("ht_hw").innerText = Math.round(win*0.1)+"%";
    document.getElementById("ht_aw").innerText = Math.round(win*0.1)+"%";
    document.getElementById("ht_wd").innerText = Math.round(draw*0.3)+"%";
    document.getElementById("ht_hd").innerText = Math.round(draw*0.4)+"%";
    document.getElementById("ht_ad").innerText = Math.round(draw*0.3)+"%";
    document.getElementById("ht_wl").innerText = Math.round(lose*0.1)+"%";
    document.getElementById("ht_hl").innerText = Math.round(lose*0.2)+"%";
    document.getElementById("ht_al").innerText = Math.round(lose*0.7)+"%";

    document.getElementById("half").innerText = getHalf(win,draw,lose);
    document.getElementById("handicap").innerText = getHandicap(ph,pa);
    document.getElementById("total").innerText = getTotal(h.attack,a.attack,lg.avgGoal);
    document.getElementById("handicapHomeOdds").innerText = (0.85 + (ph-pa)/100).toFixed(2);
    document.getElementById("handicapAwayOdds").innerText = (0.95 - (ph-pa)/100).toFixed(2);
    document.getElementById("recent").innerText = h.recentForm>1?"ä¸»é˜Ÿè¿‘æœŸçŠ¶æ€ç«çƒ­":a.recentForm>1?"å®¢é˜Ÿè¿‘æœŸçŠ¶æ€ç«çƒ­":"çŠ¶æ€ç¨³å®š";

    // é›·è¾¾å›¾
    if (radarChart) radarChart.destroy();
    const ctx = document.getElementById('radarChart').getContext('2d');
    radarChart = new Chart(ctx, {
      type: 'radar',
      data: {
        labels: ['è¿›æ”»', 'é˜²å®ˆ', 'ä¸»åœº', 'å®¢åœº', 'çŠ¶æ€', 'å®åŠ›'],
        datasets: [
          { label: hn, data: [h.attack, h.defend, h.home*80, h.away*80, h.recentForm*20+50, h.power], backgroundColor: 'rgba(64,150,255,0.2)', borderColor: '#4096FF' },
          { label: an, data: [a.attack, a.defend, a.home*80, a.away*80, a.recentForm*20+50, a.power], backgroundColor: 'rgba(255,77,79,0.2)', borderColor: '#FF4D4F' }
        ]
      },
      options: { scale: { min: 0, max: 100 } }
    });

    // è¿‘æœŸæˆ˜ç»© (æ¨¡æ‹Ÿ)
    let homeRecent = ["2025-03-10 åˆ‡å°”è¥¿ 2-1 èƒœ","2025-03-03 åˆ©ç‰©æµ¦ 1-1 å¹³","2025-02-25 çƒ­åˆº 3-0 èƒœ","2025-02-18 é˜¿æ£®çº³ 0-2 è´Ÿ","2025-02-10 æ›¼è” 1-0 èƒœ"];
    document.getElementById("homeRecentDetails").innerHTML = homeRecent.map(s=>`<div class="schedule-item">${s}</div>`).join('');
    let awayRecent = ["2025-03-09 æ›¼åŸ 1-2 è´Ÿ","2025-03-02 åˆ‡å°”è¥¿ 0-0 å¹³","2025-02-26 åˆ©ç‰©æµ¦ 2-1 èƒœ","2025-02-19 çƒ­åˆº 1-3 è´Ÿ","2025-02-12 é˜¿æ£®çº³ 2-2 å¹³"];
    document.getElementById("awayRecentDetails").innerHTML = awayRecent.map(s=>`<div class="schedule-item">${s}</div>`).join('');
    document.getElementById("homeRecord").innerHTML = genRecord(h.power, h.recentForm);
    document.getElementById("awayRecord").innerHTML = genRecord(a.power, a.recentForm);

    // æœªæ¥èµ›ç¨‹ (æ¨¡æ‹Ÿ)
    let homeFuture = ["2025-03-17  vs æ›¼è” (ä¸»)","2025-03-24  vs åˆ‡å°”è¥¿ (å®¢)","2025-04-07  vs åˆ©ç‰©æµ¦ (ä¸»)"];
    document.getElementById("homeFuture").innerHTML = homeFuture.map(s=>`<div class="schedule-item">${s}</div>`).join('');
    let awayFuture = ["2025-03-18  vs é˜¿æ£®çº³ (å®¢)","2025-03-25  vs æ›¼åŸ (ä¸»)","2025-04-08  vs çƒ­åˆº (å®¢)"];
    document.getElementById("awayFuture").innerHTML = awayFuture.map(s=>`<div class="schedule-item">${s}</div>`).join('');

    // å†å²äº¤é”‹
    let h2h = ["2025-02-10 æ›¼åŸ 2-1 çƒ­åˆº","2024-10-05 çƒ­åˆº 1-1 æ›¼åŸ","2024-03-15 æ›¼åŸ 0-2 çƒ­åˆº","2023-12-20 çƒ­åˆº 2-2 æ›¼åŸ","2023-08-27 æ›¼åŸ 3-1 çƒ­åˆº"];
    document.getElementById("h2hDetail").innerHTML = h2h.map(s=>`<div class="schedule-item">${s}</div>`).join('');
    document.getElementById("vsRecord").innerText = `è¿‘6æ¬¡äº¤é”‹ï¼šä¸»é˜Ÿèƒœ${Math.floor(Math.random()*3+1)} å¹³${Math.floor(Math.random()*2+1)} è´Ÿ${Math.floor(Math.random()*3+1)}`;

    // è¿›çƒåˆ†å¸ƒå›¾
    if (h2hChart) h2hChart.destroy();
    const h2hCtx = document.getElementById('h2hChart').getContext('2d');
    h2hChart = new Chart(h2hCtx, {
      type: 'bar',
      data: {
        labels: ['0-1çƒ', '2-3çƒ', '4+çƒ'],
        datasets: [{
          label: 'å‡ºç°æ¬¡æ•°',
          data: [2,2,1],
          backgroundColor: '#165DFF'
        }]
      },
      options: { scales: { y: { beginAtZero: true, max: 5 } } }
    });

    // å‡†ç¡®ç‡è¶‹åŠ¿å›¾
    if (trendChart) trendChart.destroy();
    const trendCtx = document.getElementById('trendChart').getContext('2d');
    trendChart = new Chart(trendCtx, {
      type: 'line',
      data: {
        labels: ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10'],
        datasets: [{
          label: 'å‡†ç¡®ç‡ %',
          data: [70, 75, 80, 78, 82, 85, 88, 84, 86, 84],
          borderColor: '#FFD700',
          backgroundColor: 'rgba(255,215,0,0.1)',
          tension: 0.3
        }]
      },
      options: { scales: { y: { min: 50, max: 100 } } }
    });

    // é¦–å‘é˜µå®¹ + é˜Ÿå¾½ + å…³é”®çƒå‘˜çŠ¶æ€
    let homePlayers = h.players || ["æœªçŸ¥"];
    let awayPlayers = a.players || ["æœªçŸ¥"];
    document.getElementById("homeLineup").innerHTML = `<span class="team-badge" id="homeBadge" style="background:#4096FF;">${hn[0]}</span>4-3-3<br>${homePlayers.slice(0,3).join('Â·')}`;
    document.getElementById("awayLineup").innerHTML = `<span class="team-badge" id="awayBadge" style="background:#FF4D4F;">${an[0]}</span>4-4-2<br>${awayPlayers.slice(0,2).join('Â·')}`;
    // çƒå‘˜çŠ¶æ€
    document.querySelector("#lineupBox + div").innerHTML = `<div>ğŸ”¥ ${homePlayers[0]} è¿‘3åœº${Math.floor(Math.random()*5+1)}çƒ</div><div>âš¡ ${awayPlayers[0]} è¿‘3åœº${Math.floor(Math.random()*4)}çƒ${Math.floor(Math.random()*3)}åŠ©</div>`;

    // çƒ­åº¦
    let [hh,ah] = genHot(ph,pa);
    document.getElementById("hotHome").innerText = hh+"%";
    document.getElementById("hotAway").innerText = ah+"%";
    let conf = Math.min(98, Math.max(60, 75 + Math.abs(ph-pa)/2 + Math.abs(h.recentForm - a.recentForm)*3));
    document.getElementById("aiConfidence").innerText = `AIä¿¡å¿ƒæŒ‡æ•°ï¼š${Math.round(conf)}%`;

    // å›æµ‹æ¨¡æ‹Ÿ
    document.getElementById("backtestAcc").innerText = (70 + Math.random()*20).toFixed(0)+"%";
    document.getElementById("backtestCorrect").innerText = Math.floor(Math.random()*2+3)+"/5";

    // æ–°é—»æ»šåŠ¨
    document.getElementById("newsTicker").innerText = `ğŸ”´ ${hn}æ–°é—»: ${h.players[0] || ''}çŠ¶æ€ç«çƒ­ Â· ${an}æ–°é—»: ${a.players[1] || ''}ä¼¤ç–‘ Â· èµ›å‰å‘å¸ƒä¼šè¦ç‚¹`;
    // è½¬ä¼šä¼ é—»
    document.getElementById("transferTicker").innerText = `ğŸ“¢ è½¬ä¼šæµè¨€: ${hn}æœ‰æ„${awayPlayers[0]} Â· ${an}å…³æ³¨æ–°æ˜Ÿ Â· å¤šå®¶è±ªé—¨è™è§†çœˆçœˆ`;

    // ç¤¾äº¤çƒ­åº¦
    let socialH = Math.round(50 + (ph-pa)/2);
    let socialA = 100 - socialH;
    document.getElementById("socialHome").innerText = socialH + "%";
    document.getElementById("socialAway").innerText = socialA + "%";

    // éšè—è¯„åˆ†å¡
    document.getElementById("ratingCard").style.display = "none";

    // ä¿å­˜é¢„æµ‹å†å²
    savePrediction(hn, an, top3[0].score);
    // å€’è®¡æ—¶æ¨¡æ‹Ÿ
    let tomorrow = new Date();
    tomorrow.setDate(tomorrow.getDate()+1);
    updateCountdown(tomorrow);

  } catch(e){ showToast("é¢„æµ‹å¤±è´¥"); } finally { hideLoading(); }
}

function getHalf(win,draw,lose){ /* åŒå‰ */ }
function getHandicap(ph,pa){ /* åŒå‰ */ }
function getTotal(attH, attA, avg){ return avg > 2.8 ? "å¤§2.5/3" : avg > 2.4 ? "2.5" : "2/2.5"; }
function genRecord(power, form){ let arr=[]; for(let i=0;i<6;i++){ let r=Math.random(); if(r<0.5) arr.push('<span class="win">èƒœ</span>'); else if(r<0.8) arr.push('<span class="draw">å¹³</span>'); else arr.push('<span class="lose">è´Ÿ</span>'); } return arr.join(''); }
function genHot(ph,pa){ let t=ph+pa; return [Math.round(ph/t*100), Math.round(pa/t*100)]; }

// å®æ—¶æ¯”èµ›æ•°æ®æ›´æ–°
async function updateLiveScore() {
  try {
    const res = await fetch(`https://api.football-data.org/v4/matches?status=LIVE`, {
      headers: { "X-Auth-Token": API_KEY }
    });
    const data = await res.json();
    const match = data.matches.find(m => 
      m.homeTeam.name.includes(getHomeName()) && m.awayTeam.name.includes(getAwayName())
    );
    if (match) {
      document.getElementById("simScore").innerText = `${match.score.fullTime.homeTeam} - ${match.score.fullTime.awayTeam}`;
      document.getElementById("simTime").innerText = match.minute + "'";
      document.getElementById("simEvent").innerText = match.status;
      // æ˜¾ç¤ºè¿›çƒè¯¦æƒ…
      if (match.goals && match.goals.length) {
        let last = match.goals[match.goals.length-1];
        document.getElementById("liveGoals").innerText = `âš½ ${last.minute}' ${last.team.name} è¿›çƒ (${last.scorer})`;
      }
    }
  } catch (e) {}
}

// æ¨¡æ‹Ÿæ¯”èµ› (å¢å¼ºç‰ˆï¼Œä¸ä¹‹å‰ç›¸åŒï¼Œç•¥)
function startSim() { /* åŒå‰ï¼Œç•¥ */ }

function showLineupEditor() { /* åŒå‰ */ }
function sharePrediction() { /* åŒå‰ */ }

// å¤šè¯­è¨€æ”¯æŒ (ç•¥)
let currentLang = 'zh';
const langToggle = document.getElementById('langToggle');
const langData = { /* åŒå‰ */ };
function updateLang(lang) { /* åŒå‰ */ }
langToggle.addEventListener('click', () => { currentLang = currentLang === 'zh' ? 'en' : 'zh'; updateLang(currentLang); });

// ä¸»é¢˜åˆ‡æ¢
const themeToggle = document.getElementById('themeToggle');
const body = document.body;
if (localStorage.getItem('theme') === 'light') { body.classList.add('light'); themeToggle.textContent = 'â˜€ï¸ åˆ‡æ¢æ·±è‰²æ¨¡å¼'; }
themeToggle.addEventListener('click', () => {
  if (body.classList.contains('light')) { body.classList.remove('light'); themeToggle.textContent = 'ğŸŒ™ åˆ‡æ¢æµ…è‰²æ¨¡å¼'; localStorage.setItem('theme', 'dark'); } 
  else { body.classList.add('light'); themeToggle.textContent = 'â˜€ï¸ åˆ‡æ¢æ·±è‰²æ¨¡å¼'; localStorage.setItem('theme', 'light'); }
});

// åˆå§‹åŒ–
document.ontouchmove = null; window.ontouchmove = null;
loadTeam();
fetchRealData();
renderHistory();

// PWA æ”¯æŒ
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/sw.js').then(reg => console.log('SW registered')).catch(err => console.log('SW failed'));
  });
}
</script>
</body>
  </html>
