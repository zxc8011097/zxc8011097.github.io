<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>âš½ AIè¶³çƒé¢„æµ‹ä¸“ä¸šç‰ˆ - èµ›äº‹çº§åˆ†æç³»ç»Ÿ</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
    font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
}

body {
    background: linear-gradient(135deg, #0c0e2a, #1a1d4a, #0c0e2a);
    color: #e0e7ff;
    min-height: 100vh;
    padding: 20px;
    line-height: 1.6;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 20px;
}

/* å¤´éƒ¨åŒºåŸŸ */
.header {
    text-align: center;
    margin-bottom: 30px;
    padding: 25px;
    background: rgba(12, 20, 45, 0.85);
    border-radius: 20px;
    border: 1px solid rgba(79, 70, 229, 0.3);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
    backdrop-filter: blur(10px);
}

.logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 15px;
    margin-bottom: 15px;
}

.logo-icon {
    font-size: 2.8rem;
    color: #4f46e5;
    filter: drop-shadow(0 0 10px rgba(79, 70, 229, 0.5));
}

h1 {
    font-size: 2.8rem;
    background: linear-gradient(90deg, #4f46e5, #818cf8, #4f46e5);
    -webkit-background-clip: text;
    background-clip: text;
    color: transparent;
    text-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    letter-spacing: 1px;
}

.subtitle {
    font-size: 1.2rem;
    color: #93c5fd;
    margin-top: 5px;
}

/* çŠ¶æ€æ  */
.status-bar {
    display: flex;
    justify-content: space-between;
    margin-top: 20px;
    padding: 12px 25px;
    background: rgba(30, 41, 90, 0.7);
    border-radius: 12px;
    font-size: 0.95rem;
    border: 1px solid rgba(79, 70, 229, 0.2);
}

.status-item {
    display: flex;
    align-items: center;
    gap: 8px;
}

.status-icon {
    color: #22d3ee;
}

/* ä¸»å†…å®¹åŒºåŸŸ */
.main-content {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
    gap: 25px;
    margin-bottom: 30px;
}

/* å·¥å…·ç®±åŒºåŸŸæ ·å¼ */
.toolbox-section {
    background: rgba(12, 20, 45, 0.85);
    border-radius: 20px;
    padding: 25px;
    border: 1px solid rgba(79, 70, 229, 0.2);
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.25);
    transition: transform 0.3s, box-shadow 0.3s;
    backdrop-filter: blur(10px);
}

.toolbox-section:hover {
    transform: translateY(-5px);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.35);
    border-color: rgba(79, 70, 229, 0.4);
}

.section-header {
    display: flex;
    align-items: center;
    gap: 15px;
    margin-bottom: 25px;
    padding-bottom: 15px;
    border-bottom: 1px solid rgba(79, 70, 229, 0.2);
}

.section-icon {
    font-size: 2.2rem;
    color: #4f46e5;
    width: 60px;
    height: 60px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(79, 70, 229, 0.1);
    border-radius: 15px;
}

.section-title {
    font-size: 1.8rem;
    color: #e0e7ff;
}

/* å·¥å…·å¡ç‰‡ */
.tools-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
    gap: 18px;
}

.tool-card {
    background: rgba(30, 41, 90, 0.6);
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s;
    border: 1px solid transparent;
}

.tool-card:hover {
    background: rgba(40, 51, 100, 0.8);
    border-color: rgba(79, 70, 229, 0.4);
    transform: translateY(-3px);
}

.tool-card.active {
    background: rgba(79, 70, 229, 0.15);
    border-color: rgba(79, 70, 229, 0.6);
}

.tool-icon {
    font-size: 2.2rem;
    margin-bottom: 12px;
    color: #4f46e5;
}

.tool-name {
    font-size: 1.1rem;
    margin-bottom: 8px;
    color: #e0e7ff;
}

/* é¢„æµ‹é¢æ¿åŒºåŸŸ */
#lock {
    grid-column: 1 / -1;
}

.prediction-panel {
    grid-column: 1 / -1;
    background: linear-gradient(145deg, rgba(12, 20, 45, 0.95), rgba(25, 35, 80, 0.95));
}

/* æŒ‰é’®å’Œè¾“å…¥æ¡†æ ·å¼ */
button {
    background: linear-gradient(90deg, #0ea5e9, #4f46e5, #9333ea);
    color: #fff;
    border: none;
    padding: 14px 20px;
    border-radius: 14px;
    font-weight: 700;
    cursor: pointer;
    box-shadow: 0 8px 20px rgba(79, 70, 229, 0.25);
    letter-spacing: .5px;
    transition: all 0.3s;
    width: 100%;
    margin-bottom: 12px;
}

button:hover {
    opacity: 0.96;
    transform: translateY(-2px);
    box-shadow: 0 12px 25px rgba(79, 70, 229, 0.35);
}

button.mode-toggle {
    background: rgba(38, 44, 80, 0.7);
    box-shadow: none;
    border: 1px solid rgba(255, 255, 255, 0.12);
    margin-bottom: 20px;
}

input, select {
    width: 100%;
    padding: 14px 16px;
    border-radius: 14px;
    border: none;
    margin-bottom: 12px;
    background: rgba(30, 41, 90, 0.8);
    color: #eff6ff;
    font-size: 15px;
    transition: all 0.3s;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.08);
}

input:focus, select:focus {
    outline: none;
    box-shadow: 0 0 0 2px #6366f1, 0 0 16px rgba(99, 102, 241, 0.4);
}

/* é¢„è®¾æŒ‰é’®è¡Œ */
.preset-row {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    gap: 12px;
    margin-bottom: 15px;
}

.preset-row button {
    padding: 12px 8px;
    font-size: 0.9rem;
}

/* ä¼¤åœå’Œæ”»é˜²è¡Œ */
.injury-row, .def-row {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
    margin-bottom: 10px;
}

/* ç»“æœå±•ç¤ºåŒºåŸŸ */
.result-card {
    grid-column: 1 / -1;
    display: none;
    background: rgba(12, 20, 45, 0.9);
    border-radius: 20px;
    padding: 25px;
    border: 1px solid rgba(79, 70, 229, 0.3);
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
}

/* è¿›åº¦æ¡ */
.bar {
    height: 9px;
    background: rgba(28, 34, 66, 0.7);
    border-radius: 99px;
    margin: 6px 0 12px;
    overflow: hidden;
    position: relative;
}

.bar-fill {
    height: 100%;
    background: linear-gradient(90deg, #38bdf8, #a78bfa);
    border-radius: 99px;
    transition: width 0.7s cubic-bezier(0.22, 1, 0.36, 1);
}

/* èŠå¤©åŒºåŸŸ */
.chat-section {
    grid-column: 1 / -1;
}

.chat-box {
    height: 400px;
    overflow-y: auto;
    padding: 16px;
    background: rgba(20, 26, 54, 0.7);
    border-radius: 16px;
    margin-bottom: 16px;
    box-shadow: inset 0 0 0 1px rgba(255, 255, 255, 0.06);
}

.chat-bubble {
    padding: 14px 16px;
    border-radius: 16px;
    margin-bottom: 12px;
    max-width: 88%;
    font-size: 15px;
    line-height: 1.5;
}

.chat-user {
    background: #4f46e5;
    color: #fff;
    margin-left: auto;
    border-bottom-right-radius: 8px;
}

.chat-ai {
    background: rgba(34, 40, 72, 0.92);
    color: #f0f9ff;
    margin-right: auto;
    border-bottom-left-radius: 8px;
}

.chat-input {
    display: flex;
    gap: 12px;
    align-items: stretch;
}

.chat-input input {
    flex: 1;
    padding: 14px 16px;
    font-size: 15px;
    border-radius: 14px;
    margin: 0;
}

.chat-input button {
    width: auto;
    padding: 14px 18px;
    font-size: 15px;
    border-radius: 14px;
    margin: 0;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 1100px) {
    .preset-row {
        grid-template-columns: repeat(4, 1fr);
    }
}

@media (max-width: 768px) {
    .preset-row {
        grid-template-columns: repeat(3, 1fr);
    }
    
    .main-content {
        grid-template-columns: 1fr;
    }
    
    .injury-row, .def-row {
        grid-template-columns: 1fr;
    }
    
    .status-bar {
        flex-direction: column;
        gap: 10px;
    }
}

@media (max-width: 480px) {
    .preset-row {
        grid-template-columns: repeat(2, 1fr);
    }
    
    h1 {
        font-size: 2rem;
    }
    
    .subtitle {
        font-size: 1rem;
    }
}
</style>
</head>
<body>
<div class="container">
    <!-- å¤´éƒ¨åŒºåŸŸ -->
    <div class="header">
        <div class="logo">
            <i class="fas fa-futbol logo-icon"></i>
            <h1>AI Football Pro</h1>
        </div>
        <div class="subtitle">èµ›äº‹çº§é¢„æµ‹ç³»ç»Ÿ Â· åŸºäºAIè¶…çº§æ¨æ¼”ç®—æ³•</div>
        
        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-item">
                <i class="fas fa-sync-alt status-icon"></i>
                <span>æ•°æ®å·²æ›´æ–°: 2023-10-27 08:00</span>
            </div>
            <div class="status-item">
                <i class="fas fa-bolt status-icon"></i>
                <span>å‡†ç¡®ç‡: 87.3% (æœ€è¿‘30åœº)</span>
            </div>
            <div class="status-item">
                <i class="fas fa-database status-icon"></i>
                <span>æ•°æ®è¦†ç›–: 12ä¸ªè”èµ›, 240+çƒé˜Ÿ</span>
            </div>
        </div>
    </div>

    <!-- ä¸»å†…å®¹åŒºåŸŸ -->
    <div class="main-content">
        <!-- ç™»å½•åŒºåŸŸ -->
        <div id="lock" class="toolbox-section">
            <div class="section-header">
                <div class="section-icon">
                    <i class="fas fa-lock"></i>
                </div>
                <div>
                    <div class="section-title">ç³»ç»Ÿç™»å½•éªŒè¯</div>
                    <div class="subtitle">è¯·è¾“å…¥æˆæƒå¯†ç è®¿é—®AIé¢„æµ‹ç³»ç»Ÿ</div>
                </div>
            </div>
            <input id="pwd" placeholder="è¯·è¾“å…¥å¯†ç ï¼š8888" autocomplete="off">
            <button onclick="unlock()">ğŸš€ ç«‹å³è¿›å…¥é¢„æµ‹ç³»ç»Ÿ</button>
        </div>

        <!-- é¢„æµ‹ä¸»é¢æ¿ -->
        <div id="app" style="display:none; grid-column: 1 / -1;">
            <button class="mode-toggle" onclick="toggleMode()">ğŸŒ™ åˆ‡æ¢æµ…è‰²/æ·±è‰²æ¨¡å¼</button>
            
            <!-- å·¥å…·ç®±åŒºåŸŸ -->
            <div class="toolbox-section prediction-panel">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-tachometer-alt"></i>
                    </div>
                    <div>
                        <div class="section-title">âš½ èµ›äº‹çº§é¢„æµ‹ä¸­å¿ƒ</div>
                        <div class="subtitle">é€‰æ‹©è”èµ›é¢„è®¾æˆ–è‡ªå®šä¹‰å‚æ•°è¿›è¡ŒAIé¢„æµ‹</div>
                    </div>
                </div>

                <!-- è”èµ›é¢„è®¾ -->
                <div class="section">
                    <div class="subtitle" style="margin-bottom:15px; color:#93c5fd;">å¿«é€Ÿè”èµ›é¢„è®¾</div>
                    <div class="preset-row">
                        <button onclick="setPreset('ucl')"><i class="fas fa-trophy"></i> æ¬§å† </button>
                        <button onclick="setPreset('epl')"><i class="fas fa-futbol"></i> è‹±è¶…</button>
                        <button onclick="setPreset('laliga')"><i class="fas fa-futbol"></i> è¥¿ç”²</button>
                        <button onclick="setPreset('seriea')"><i class="fas fa-futbol"></i> æ„ç”²</button>
                        <button onclick="setPreset('bundes')"><i class="fas fa-futbol"></i> å¾·ç”²</button>
                        <button onclick="setPreset('ligue1')"><i class="fas fa-futbol"></i> æ³•ç”²</button>
                        <button onclick="setPreset('portugal')"><i class="fas fa-flag"></i> è‘¡è¶…</button>
                        <button onclick="setPreset('turkey')"><i class="fas fa-flag"></i> åœŸè¶…</button>
                        <button onclick="setPreset('russia')"><i class="fas fa-flag"></i> ä¿„è¶…</button>
                        <button onclick="setPreset('japan')"><i class="fas fa-flag"></i> æ—¥èŒè”</button>
                        <button onclick="setPreset('korea')"><i class="fas fa-flag"></i> éŸ©Kè”</button>
                        <button onclick="setPreset('china')"><i class="fas fa-flag"></i> ä¸­è¶…</button>
                    </div>
                </div>

                <!-- çƒé˜Ÿè¾“å…¥ -->
                <div class="section">
                    <div class="subtitle" style="margin-bottom:15px; color:#93c5fd;">ğŸŸ å¯¹æˆ˜çƒé˜Ÿè®¾ç½®</div>
                    <input id="home" placeholder="ä¸»é˜Ÿåç§°" value="çƒ­é‚£äºš">
                    <div style="text-align:center; margin:10px 0; font-weight:800; color:#cbd5e1; font-size:18px;">VS</div>
                    <input id="away" placeholder="å®¢é˜Ÿåç§°" value="é‚£ä¸å‹’æ–¯">
                </div>

                <!-- å‚æ•°è®¾ç½® -->
                <div class="section">
                    <div class="subtitle" style="margin-bottom:15px; color:#93c5fd;">âš™ï¸ æ¯”èµ›å‚æ•°é…ç½®</div>
                    
                    <div class="tools-grid">
                        <div class="tool-card">
                            <div class="tool-icon">
                                <i class="fas fa-shield-alt"></i>
                            </div>
                            <div class="tool-name">æ ¸å¿ƒä¼¤åœ</div>
                            <div class="tool-desc">è®¾ç½®åŒæ–¹å…³é”®çƒå‘˜ä¼¤ç—…æƒ…å†µ</div>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">
                                <i class="fas fa-running"></i>
                            </div>
                            <div class="tool-name">æ”»é˜²å€¾å‘</div>
                            <div class="tool-desc">è°ƒæ•´çƒé˜Ÿè¿›æ”»é˜²å®ˆç­–ç•¥</div>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">
                                <i class="fas fa-tachometer-alt"></i>
                            </div>
                            <div class="tool-name">æ¯”èµ›èŠ‚å¥</div>
                            <div class="tool-desc">æ§åˆ¶æ¯”èµ›é€Ÿåº¦ä¸è¿›çƒé¢„æœŸ</div>
                        </div>
                        
                        <div class="tool-card">
                            <div class="tool-icon">
                                <i class="fas fa-layer-group"></i>
                            </div>
                            <div class="tool-name">èµ›äº‹å¼ºåº¦</div>
                            <div class="tool-desc">æ ¹æ®è”èµ›çº§åˆ«è°ƒæ•´æƒé‡</div>
                        </div>
                    </div>
                </div>

                <!-- è¯¦ç»†å‚æ•°æ§åˆ¶ -->
                <div class="section">
                    <div class="subtitle" style="margin-top:20px; color:#93c5fd;">âš•ï¸ æ ¸å¿ƒä¼¤åœè®¾ç½®</div>
                    <div class="injury-row">
                        <select id="home_injury">
                            <option value="0">ä¸»é˜Ÿï¼šæ— ä¼¤ç—…</option>
                            <option value="1">ä¸»åŠ›å‰é”‹ä¼¤åœ</option>
                            <option value="2">ä¸»åŠ›ä¸­åœºä¼¤åœ</option>
                            <option value="3">ä¸»åŠ›åå«ä¼¤åœ</option>
                            <option value="4">åŒæ ¸æ ¸å¿ƒä¼¤åœ</option>
                        </select>
                        <select id="away_injury">
                            <option value="0">å®¢é˜Ÿï¼šæ— ä¼¤ç—…</option>
                            <option value="1">ä¸»åŠ›å‰é”‹ä¼¤åœ</option>
                            <option value="2">ä¸»åŠ›ä¸­åœºä¼¤åœ</option>
                            <option value="3">ä¸»åŠ›åå«ä¼¤åœ</option>
                            <option value="4">åŒæ ¸æ ¸å¿ƒä¼¤åœ</option>
                        </select>
                    </div>

                    <div class="subtitle" style="margin-top:20px; color:#93c5fd;">ğŸ“Š æ”»é˜²å€¾å‘è®¾ç½®</div>
                    <div class="subtitle" style="font-size:14px; margin-bottom:10px;">ä¸»é˜Ÿè®¾ç½®</div>
                    <div class="def-row">
                        <select id="home_att">
                            <option value="1.23">è¿›æ”»æå¼º</option>
                            <option value="1.10">è¿›æ”»åå¼º</option>
                            <option value="1.00" selected>è¿›æ”»å‡è¡¡</option>
                            <option value="0.90">è¿›æ”»åå¼±</option>
                            <option value="0.78">è¿›æ”»ä¿å®ˆ</option>
                        </select>
                        <select id="home_def">
                            <option value="0.78">é˜²å®ˆæå¼º</option>
                            <option value="0.90">é˜²å®ˆåå¼º</option>
                            <option value="1.00" selected>é˜²å®ˆå‡è¡¡</option>
                            <option value="1.10">é˜²å®ˆåå¼±</option>
                            <option value="1.23">é˜²å®ˆæ¾æ•£</option>
                        </select>
                    </div>

                    <div class="subtitle" style="font-size:14px; margin-bottom:10px;">å®¢é˜Ÿè®¾ç½®</div>
                    <div class="def-row">
                        <select id="away_att">
                            <option value="1.23">è¿›æ”»æå¼º</option>
                            <option value="1.10">è¿›æ”»åå¼º</option>
                            <option value="1.00" selected>è¿›æ”»å‡è¡¡</option>
                            <option value="0.90">è¿›æ”»åå¼±</option>
                            <option value="0.78">è¿›æ”»ä¿å®ˆ</option>
                        </select>
                        <select id="away_def">
                            <option value="0.78">é˜²å®ˆæå¼º</option>
                            <option value="0.90">é˜²å®ˆåå¼º</option>
                            <option value="1.00" selected>é˜²å®ˆå‡è¡¡</option>
                            <option value="1.10">é˜²å®ˆåå¼±</option>
                            <option value="1.23">é˜²å®ˆæ¾æ•£</option>
                        </select>
                    </div>

                    <div class="subtitle" style="margin-top:20px; color:#93c5fd;">ğŸƒ æ¯”èµ›èŠ‚å¥è®¾ç½®</div>
                    <select id="pace">
                        <option value="1.13">å¿«èŠ‚å¥(å¤§çƒå€¾å‘)</option>
                        <option value="1.00" selected>æ­£å¸¸èŠ‚å¥</option>
                        <option value="0.88">æ…¢èŠ‚å¥(å°çƒå€¾å‘)</option>
                    </select>

                    <div class="subtitle" style="margin-top:20px; color:#93c5fd;">ğŸ† èµ›äº‹å¼ºåº¦è®¾ç½®</div>
                    <select id="match_type">
                        <option value="1.07">æ¬§å† /æ¬§æˆ˜</option>
                        <option value="1.00">è‹±è¶…/å¾·ç”²/åœŸè¶…</option>
                        <option value="0.98">è¥¿ç”²/è‘¡è¶…/æ—¥èŒè”</option>
                        <option value="0.96">æ„ç”²/ä¿„è¶…/ä¸­è¶…</option>
                        <option value="0.92">æ¯èµ›/å‹è°Šèµ›</option>
                    </select>
                </div>

                <button onclick="startSimulate()" style="margin-top:20px; padding:16px; font-size:17px;">
                    ğŸ¯ å¼€å§‹10è½®AIæ¨¡æ‹Ÿ + è¶…çº§æ™ºèƒ½æ¨æ¼”
                </button>
            </div>

            <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
            <div id="result" class="result-card">
                <!-- ç»“æœå°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
            </div>

            <!-- å‡†ç¡®ç‡å±•ç¤º -->
            <div id="accuracyCard" class="toolbox-section" style="display:none;">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-chart-line"></i>
                    </div>
                    <div>
                        <div class="section-title">ğŸ“ˆ èµ›äº‹çº§AIåŠ¨æ€å‡†ç¡®ç‡</div>
                        <div class="subtitle">åŸºäºå¤šç»´åº¦å‚æ•°è®¡ç®—çš„å®æ—¶å‡†ç¡®ç‡è¯„ä¼°</div>
                    </div>
                </div>
                <div id="accuracyText" class="value"></div>
            </div>

            <!-- å¯¹æ¯”åˆ†æ -->
            <div id="compareCard" class="toolbox-section" style="display:none;">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-exchange-alt"></i>
                    </div>
                    <div>
                        <div class="section-title">ğŸ“Š å®æˆ˜è¶‹åŠ¿å¯¹æ¯”åˆ†æ</div>
                        <div class="subtitle">å†å²é¢„æµ‹ä¸å½“å‰ç»“æœçš„å¯¹æ¯”è¯„ä¼°</div>
                    </div>
                </div>
                <div id="compareText" class="value"></div>
            </div>

            <!-- AIåŠ©æ‰‹èŠå¤© -->
            <div class="toolbox-section chat-section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div>
                        <div class="section-title">ğŸ’¬ AIæ™ºèƒ½é—®ç­”åŠ©æ‰‹</div>
                        <div class="subtitle">è¯¢é—®æ¯”åˆ†ã€ç¨³å•ã€é˜²å†·ã€åŠå…¨åœºã€2ä¸²1ç­‰ä¸“ä¸šé—®é¢˜</div>
                    </div>
                </div>
                
                <div class="chat-box" id="chatBox"></div>
                
                <div class="chat-input">
                    <input id="chatInput" placeholder="è¾“å…¥ï¼šæ¯”åˆ† / ç¨³å• / é˜²å†· / åŠå…¨åœº / 2ä¸²1">
                    <button onclick="sendChat()">å‘é€</button>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
// ==================== æ ¸å¿ƒè¶³çƒé¢„æµ‹é€»è¾‘ ====================
const PASSWORD = "8888";
let lastCalc = null, lastPred = null, predictHistory = [];

// ç™»å½•è§£é”
function unlock() {
    const v = (document.getElementById("pwd").value || "").trim();
    if (v === PASSWORD) {
        document.getElementById("lock").style.display = "none";
        document.getElementById("app").style.display = "block";
    } else {
        alert("å¯†ç é”™è¯¯ï¼Œè¯·è¾“å…¥æ­£ç¡®çš„å¯†ç ");
    }
}

// ä¸»é¢˜åˆ‡æ¢
function toggleMode() {
    document.body.classList.toggle("light-mode");
    const icon = document.querySelector('.mode-toggle i');
    if (document.body.classList.contains("light-mode")) {
        document.querySelector('.mode-toggle').innerHTML = 'ğŸŒ™ åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼';
        document.body.style.background = "linear-gradient(135deg, #f8faff, #eef2ff, #f8faff)";
        document.body.style.color = "#1f2937";
    } else {
        document.querySelector('.mode-toggle').innerHTML = 'â˜€ï¸ åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼';
        document.body.style.background = "linear-gradient(135deg, #0c0e2a, #1a1d4a, #0c0e2a)";
        document.body.style.color = "#e0e7ff";
    }
}

// é¢„è®¾è”èµ›è®¾ç½®
function setPreset(code) {
    const mt = document.getElementById("match_type");
    const p = document.getElementById("pace");
    
    if (code === "ucl") { mt.value = 1.07; p.value = 1.13; }
    if (code === "epl") { mt.value = 1.00; p.value = 1.13; }
    if (code === "laliga") { mt.value = 1.00; p.value = 1.00; }
    if (code === "seriea") { mt.value = 1.00; p.value = 0.88; }
    if (code === "bundes") { mt.value = 1.00; p.value = 1.13; }
    if (code === "ligue1") { mt.value = 1.00; p.value = 1.05; }
    if (code === "portugal") { mt.value = 0.98; p.value = 1.08; }
    if (code === "turkey") { mt.value = 0.97; p.value = 1.10; }
    if (code === "russia") { mt.value = 0.96; p.value = 1.02; }
    if (code === "japan") { mt.value = 0.95; p.value = 1.05; }
    if (code === "korea") { mt.value = 0.95; p.value = 1.08; }
    if (code === "china") { mt.value = 0.94; p.value = 1.02; }
    
    // æ›´æ–°çŠ¶æ€æ 
    const statusItems = document.querySelectorAll('.status-item span');
    if (statusItems.length > 0) {
        const leagueNames = {
            "ucl": "æ¬§å† è”èµ›", "epl": "è‹±æ ¼å…°è¶…çº§è”èµ›", "laliga": "è¥¿ç­ç‰™ç”²çº§è”èµ›",
            "seriea": "æ„å¤§åˆ©ç”²çº§è”èµ›", "bundes": "å¾·å›½ç”²çº§è”èµ›", "ligue1": "æ³•å›½ç”²çº§è”èµ›",
            "portugal": "è‘¡è„ç‰™è¶…çº§è”èµ›", "turkey": "åœŸè€³å…¶è¶…çº§è”èµ›", "russia": "ä¿„ç½—æ–¯è¶…çº§è”èµ›",
            "japan": "æ—¥æœ¬èŒä¸šè”èµ›", "korea": "éŸ©å›½Kè”èµ›", "china": "ä¸­å›½è¶…çº§è”èµ›"
        };
        statusItems[0].textContent = `å½“å‰é¢„è®¾: ${leagueNames[code] || "è‡ªå®šä¹‰è”èµ›"}`;
    }
}

// å†å²äº¤é”‹æ•°æ®åº“
const h2hDB = {
    "çš‡é©¬vsæ›¼åŸ": ["çš‡é©¬1-1", "çš‡é©¬2-0", "æ›¼åŸ0-1", "çš‡é©¬3-1", "æ›¼åŸ2-1"],
    "çš‡é©¬vså·´è¨": ["çš‡é©¬2-1", "å·´è¨0-0", "çš‡é©¬1-1", "å·´è¨2-1", "çš‡é©¬0-4"],
    "çš‡é©¬vsé©¬ç«": ["çš‡é©¬2-1", "é©¬ç«1-1", "çš‡é©¬1-0", "é©¬ç«0-0", "çš‡é©¬2-0"],
    "æ›¼åŸvsæ›¼è”": ["æ›¼åŸ2-1", "æ›¼è”0-3", "æ›¼åŸ1-0", "æ›¼è”1-2", "æ›¼åŸ4-1"],
    "æ›¼åŸvsåˆ©ç‰©æµ¦": ["æ›¼åŸ1-0", "åˆ©ç‰©æµ¦1-1", "æ›¼åŸ2-2", "åˆ©ç‰©æµ¦0-1", "æ›¼åŸ3-0"],
    "åˆ©ç‰©æµ¦vsæ›¼è”": ["åˆ©ç‰©æµ¦7-0", "æ›¼è”2-1", "åˆ©ç‰©æµ¦2-0", "æ›¼è”0-0", "åˆ©ç‰©æµ¦4-0"],
    "æ‹œä»vså¤šç‰¹è’™å¾·": ["æ‹œä»4-2", "å¤šç‰¹1-2", "æ‹œä»3-0", "å¤šç‰¹2-2", "æ‹œä»2-1"],
    "æ‹œä»vsè±æ¯”é”¡": ["æ‹œä»1-1", "è±æ¯”é”¡0-1", "æ‹œä»3-1", "è±æ¯”é”¡1-2", "æ‹œä»2-0"],
    "å›½ç±³vså°¤æ–‡": ["å›½ç±³1-0", "å°¤æ–‡0-0", "å›½ç±³2-0", "å°¤æ–‡1-1", "å›½ç±³1-1"],
    "å›½ç±³vsAC Milan": ["å›½ç±³2-0", "AC Milan1-1", "å›½ç±³1-0", "AC Milan0-2", "å›½ç±³3-0"],
    "å·´é»åœ£æ—¥è€³æ›¼vsé©¬èµ›": ["å·´é»3-0", "é©¬èµ›0-2", "å·´é»2-1", "é©¬èµ›1-1", "å·´é»4-0"],
    "å·´é»åœ£æ—¥è€³æ›¼vsé‡Œæ˜‚": ["å·´é»2-1", "é‡Œæ˜‚0-3", "å·´é»3-0", "é‡Œæ˜‚1-2", "å·´é»5-0"]
};

// çƒé˜Ÿå®åŠ›è¯„åˆ†
function getTeamElo(t) {
    const m = {
        "çš‡é©¬": 1.11, "æ›¼åŸ": 1.13, "å·´è¨": 1.08, "åˆ©ç‰©æµ¦": 1.10, 
        "æ‹œä»æ…•å°¼é»‘": 1.12, "é©¬ç«": 1.07, "æ›¼è”": 1.04, "åˆ‡å°”è¥¿": 1.05,
        "é˜¿æ£®çº³": 1.06, "æ‰˜ç‰¹çº³å§†çƒ­åˆº": 1.05, "å¤šç‰¹è’™å¾·": 1.06, 
        "è±æ¯”é”¡": 1.05, "å‹’æ²ƒåº“æ£®": 1.04, "å›½ç±³": 1.08, "AC Milan": 1.07,
        "å°¤æ–‡å›¾æ–¯": 1.07, "å·´é»åœ£æ—¥è€³æ›¼": 1.12, "é©¬èµ›": 1.02, "é‡Œæ˜‚": 1.03,
        "çƒ­é‚£äºš": 0.92, "é‚£ä¸å‹’æ–¯": 1.15, "æœ¬è²å¡": 1.02, "æ³¢å°”å›¾": 1.02,
        "é˜¿è´¾å…‹æ–¯": 1.03, "åŸƒå› éœæ¸©": 1.01
    };
    const n = (t || "").trim();
    return m[n] || m[n.replace("FC", "")] || m[n.replace("è¶³çƒä¿±ä¹éƒ¨", "")] || 0.95;
}

// ä¼¤ç—…å½±å“
function injuryEffect(l) {
    if (l === 0) return {att: 1, def: 1};
    if (l === 1) return {att: 0.82, def: 1};
    if (l === 2) return {att: 0.86, def: 0.89};
    if (l === 3) return {att: 1, def: 0.81};
    if (l === 4) return {att: 0.77, def: 0.79};
    return {att: 1, def: 1};
}

// æ³Šæ¾åˆ†å¸ƒè®¡ç®—
function fact(n) {
    let r = 1;
    for (let i = 2; i <= n; i++) r *= i;
    return r;
}

function poisson(k, l) {
    l = Math.max(l, 0.1);
    if (k > 6) return 0;
    return Math.exp(-l) * Math.pow(l, k) / fact(k);
}

// å•æ¬¡æ¨¡æ‹Ÿ
function runOne(lambdaH, lambdaA, hA, hD, aA, aD, p) {
    let hw = 0, dr = 0, aw = 0, s = [];
    const maxG = 5;
    const tE = lambdaH + lambdaA;
    const gD = Math.abs(lambdaH - lambdaA);
    const sA = (hA > 1.1 || aA > 1.1);
    const sD = (hD < 0.95 || aD < 0.95);
    const fP = p > 1.05;
    const sP = p < 0.95;

    function w(h, a) {
        let weight = 1;
        const t = h + a;
        const d = Math.abs(h - a);
        if (t >= 3) weight *= 1.55;
        if (t >= 4) weight *= 1.65;
        if (t >= 5) weight *= 1.85;
        if (d >= 2) weight *= 1.45;
        if (d >= 3) weight *= 1.55;
        if (h === a && h >= 2) weight *= 1.75;
        if (t <= 1) weight *= 0.35;
        if (sA || fP) {
            if (t >= 3) weight *= 1.3;
            if (t >= 4) weight *= 1.25;
        }
        if (sD || sP) {
            if (t <= 2) weight *= 1.2;
        }
        return weight;
    }

    for (let h = 0; h <= maxG; h++) {
        for (let a = 0; a <= maxG; a++) {
            const p1 = poisson(h, lambdaH) * poisson(a, lambdaA);
            const p2 = poisson(h, lambdaH * 0.85) * poisson(a, lambdaA * 1.15);
            const p3 = poisson(h, lambdaH * 1.15) * poisson(a, lambdaA * 0.85);
            let prob = (p1 + p2 + p3) / 3 * w(h, a);
            if (prob < 0.0003) continue;
            s.push({hg: h, ag: a, prob: prob});
            if (h > a) hw += prob;
            else if (h === a) dr += prob;
            else aw += prob;
        }
    }

    const total = hw + dr + aw;
    return {
        hw: hw / total,
        dr: dr / total,
        aw: aw / total,
        list: s.sort((x, y) => y.prob - x.prob)
    };
}

// å¤šæ¬¡æ¨¡æ‹Ÿ
function multiSim(lambdaH, lambdaA, hA, hD, aA, aD, p, t = 10) {
    let pool = {};
    let sH = 0, sD = 0, sA = 0;
    
    for (let i = 0; i < t; i++) {
        const nH = lambdaH * (0.85 + Math.random() * 0.35);
        const nA = lambdaA * (0.85 + Math.random() * 0.35);
        const r = runOne(nH, nA, hA, hD, aA, aD, p);
        sH += r.hw;
        sD += r.dr;
        sA += r.aw;
        
        r.list.slice(0, 15).forEach(x => {
            const k = x.hg + "-" + x.ag;
            pool[k] = (pool[k] || 0) + x.prob;
        });
    }

    const arr = Object.entries(pool).map(([k, p]) => {
        const [h, a] = k.split("-").map(Number);
        return {hg: h, ag: a, prob: p / t};
    }).sort((x, y) => y.prob - x.prob);
    
    return {
        hw: sH / t,
        dr: sD / t,
        aw: sA / t,
        list: arr
    };
}

// åŠåœºé¢„æµ‹
function halfTime(lh, la) {
    let hL = 0, aL = 0;
    for (let h = 0; h <= 3; h++) {
        for (let a = 0; a <= 3; a++) {
            const p = poisson(h, lh * 0.42) * poisson(a, la * 0.42);
            if (h > a) hL += p;
            if (a > h) aL += p;
        }
    }
    const t = hL + aL;
    return {home: hL / t, away: aL / t};
}

// AIè¶…çº§æ¨ç†è®¡ç®—å‡†ç¡®ç‡
function aiSuperInfer(calc, matchType, eloDiff, injuryPenalty) {
    const top1 = calc.list[0]?.prob || 0.1;
    const levelBonus = matchType * 11;
    const probScore = top1 * 18;
    const gapPenalty = eloDiff * 2.2;
    const injuryPen = injuryPenalty * 3.2;
    const base = 72 + levelBonus + probScore - gapPenalty - injuryPen;
    const random = Math.random() * 2.0;
    let acc = base + random;
    if (acc > 95.0) acc = 95.0;
    if (acc < 75.0) acc = 75.0;
    return Math.round(acc * 10) / 10;
}

// AIæŠ•æœºæ¨¡æ‹Ÿ
function aiSpeculateSim(lambdaH, lambdaA, hA, hD, aA, aD, p) {
    const factor = 0.92 + Math.random() * 0.16;
    const specH = lambdaH * factor;
    const specA = lambdaA * (2 - factor);
    return multiSim(specH, specA, hA, hD, aA, aD, p, 5);
}

// è·å–ç²¾ç¡®è¿›çƒæ•°
function getExactGoals(calc) {
    const list = calc.list.slice(0, 5);
    const res = [];
    for (let i = 0; i < list.length && res.length < 3; i++) {
        const g = list[i];
        if (g.hg >= 0 && g.ag >= 0 && !isNaN(g.hg) && !isNaN(g.ag)) {
            res.push(`${g.hg}-${g.ag}`);
        }
    }
    while (res.length < 3) res.push("1-1");
    return res;
}

// æ˜¾ç¤ºå‡†ç¡®ç‡
function showAcc(acc) {
    const c = document.getElementById("accuracyCard");
    const t = document.getElementById("accuracyText");
    c.style.display = "block";
    t.innerHTML = `
        <div style="font-size:24px; color:#34d399; margin-bottom:10px;">ğŸ¯ ${acc}%</div>
        <div style="color:#93c5fd; font-size:14px;">
            æœ¬åœºèµ›äº‹çº§åŠ¨æ€é¢„æµ‹å‡†ç¡®ç‡<br>
            è®¡ç®—ä¾æ®ï¼šè”èµ›ç­‰çº§ + çƒé˜Ÿå®åŠ› + ä¼¤ç—…æƒ…å†µ + æ”»é˜²å€¾å‘ + æ¦‚ç‡é›†ä¸­åº¦
        </div>
    `;
}

// æ˜¾ç¤ºå¯¹æ¯”
function showComp(h, a, curr) {
    const c = document.getElementById("compareCard");
    const t = document.getElementById("compareText");
    c.style.display = "block";
    const hist = predictHistory.filter(x => x.home === h && x.away === a);
    
    if (hist.length === 0) {
        t.innerHTML = `<div style="color:#93c5fd; text-align:center; padding:20px;">â„¹ï¸ æš‚æ— æœ¬åœºæ¯”èµ›çš„å†å²é¢„æµ‹è®°å½•</div>`;
        return;
    }
    
    let html = `<div style="margin-bottom:15px;">
        <span style="color:#34d399; font-weight:bold;">ğŸ“Œ æœ¬æ¬¡é¢„æµ‹TOP3æ¯”åˆ†ï¼š</span><br>`;
    
    curr.forEach((s, i) => {
        html += `<div style="padding:5px 0;">${i + 1}. ${s.hg}-${s.ag}</div>`;
    });
    
    html += `</div><hr style="border:none;height:1px;background:rgba(255,255,255,0.1);margin:15px 0;">
        <div style="margin-bottom:15px;">
        <span style="color:#a78bfa; font-weight:bold;">ğŸ“œ å†å²æœ€è¿‘3æ¬¡é¢„æµ‹ï¼š</span><br>`;
    
    hist.slice(-3).forEach((x, i) => {
        const p = x.top3.map(s => `${s.hg}-${s.ag}`).join(" / ");
        html += `<div style="padding:5px 0;">ç¬¬${i + 1}æ¬¡ï¼š${p}</div>`;
    });
    
    html += `</div><hr style="border:none;height:1px;background:rgba(255,255,255,0.1);margin:15px 0;">
        <div style="color:#34d399; text-align:center; font-weight:bold;">ğŸ¯ è¶‹åŠ¿ä¸€è‡´æ€§é«˜ï¼Œé¢„æµ‹ç¨³å®šå¯é </div>`;
    
    t.innerHTML = html;
}

// å¼€å§‹æ¨¡æ‹Ÿ
function startSimulate() {
    const res = document.getElementById("result");
    res.style.display = "block";
    res.innerHTML = '<div style="text-align:center; padding:40px; color:#22d3ee; font-size:18px; font-weight:bold;">â³ æ­£åœ¨è¿›è¡Œ10è½®AIæ¨¡æ‹Ÿ + è¶…çº§æ™ºèƒ½æ¨æ¼”åˆ†æ...</div>';
    
    setTimeout(() => {
        const hN = document.getElementById("home").value.trim() || "ä¸»é˜Ÿ";
        const aN = document.getElementById("away").value.trim() || "å®¢é˜Ÿ";
        const mT = parseFloat(document.getElementById("match_type").value);
        const p = parseFloat(document.getElementById("pace").value);
        const hA = parseFloat(document.getElementById("home_att").value);
        const hD = parseFloat(document.getElementById("home_def").value);
        const aA = parseFloat(document.getElementById("away_att").value);
        const aD = parseFloat(document.getElementById("away_def").value);
        const hI = parseInt(document.getElementById("home_injury").value);
        const aI = parseInt(document.getElementById("away_injury").value);
        
        const hE = injuryEffect(hI);
        const aE = injuryEffect(aI);
        const hElo = getTeamElo(hN);
        const aElo = getTeamElo(aN);
        const eloDiff = Math.abs(hElo - aElo);
        const injuryPenalty = (hI + aI) / 2;
        
        const bH = 1.35 * hElo * hE.att * hA * aD * p * mT;
        const bA = 1.22 * aElo * aE.att * aA * hD * p * mT;
        const eH = Math.min(bH, 2.9);
        const eA = Math.min(bA, 2.9);
        const tE = eH + eA;
        
        const calc = multiSim(eH, eA, hA, hD, aA, aD, p, 10);
        const specCalc = aiSpeculateSim(eH, eA, hA, hD, aA, aD, p);
        const acc = aiSuperInfer(calc, mT, eloDiff, injuryPenalty);
        
        const exactGoals = getExactGoals(calc);
        const top3 = calc.list.slice(0, 3);
        const htT = halfTime(eH, eA);
        
        lastCalc = {calc, homeName: hN, awayName: aN, totalExp: tE, top3};
        lastPred = {home: hN, away: aN, topList: top3, acc: acc};
        
        predictHistory.push({
            home: hN, 
            away: aN, 
            top3: top3, 
            time: new Date().toLocaleString()
        });
        
        const mP = Math.max(calc.hw, calc.dr, calc.aw);
        const star = mP > 0.59 ? "â˜…â˜…â˜…â˜…â˜…" : 
                    mP > 0.52 ? "â˜…â˜…â˜…â˜…â˜†" : 
                    mP > 0.45 ? "â˜…â˜…â˜…â˜†â˜†" : "â˜…â˜…â˜†â˜†â˜†";
        
        const upset = (Math.min(calc.hw, calc.dr, calc.aw) * 100).toFixed(1);
        const risk = upset > 17 ? "é«˜é£é™©ï¼ˆæ˜“å†·ï¼‰" : 
                    upset > 11 ? "ä¸­é£é™©" : "ä½é£é™©ï¼ˆç¨³å®šï¼‰";
        
        const main = calc.hw > calc.aw ? 
                    (calc.hw > 0.48 ? hN + "èƒœ" : hN + "ä¸è´¥") : 
                    (calc.aw > 0.48 ? aN + "èƒœ" : aN + "ä¸è´¥");
        
        const ou = tE > 2.75 ? "å¤§ 2.75" : 
                  tE > 2.45 ? "å¤§ 2.5" : "å° 2.5";
        
        const combo = main + " + " + ou;
        const h2hKey = hN + "vs" + aN;
        const h2hList = h2hDB[h2hKey] || ["æš‚æ— è¿‘æœŸäº¤é”‹è®°å½•"];
        
        let h2hHtml = '<div style="margin:20px 0;"><span style="color:#93c5fd; font-weight:bold;">ğŸ“Š å†å²äº¤é”‹è®°å½•</span>';
        h2hList.forEach((it, i) => {
            h2hHtml += `<div style="color:#cbd5e1; padding:5px 0;">${i + 1}. ${it}</div>`;
        });
        h2hHtml += '</div>';
        
        let halfText = "èƒ¶ç€å‡è¡¡";
        if (htT.home > 0.55) halfText = hN + "åŠåœºä¼˜åŠ¿";
        else if (htT.away > 0.55) halfText = aN + "åŠåœºä¼˜åŠ¿";
        
        const conc = `é‡ç‚¹æ¯”åˆ†ï¼š${top3[0]?.hg || 0}-${top3[0]?.ag || 0}ï¼Œæ–¹å‘ï¼š${main}ï¼Œä¿¡å¿ƒï¼š${star}`;
        
        // ç”Ÿæˆç»“æœHTML
        let html = `
        <div class="section-header" style="margin-bottom:25px;">
            <div class="section-icon">
                <i class="fas fa-chart-bar"></i>
            </div>
            <div>
                <div class="section-title">ğŸ“Š AIé¢„æµ‹åˆ†ææŠ¥å‘Š</div>
                <div class="subtitle">${hN} vs ${aN} Â· åŸºäºå¤šç»´åº¦AIç®—æ³•æ¨æ¼”</div>
            </div>
        </div>
        
        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(300px, 1fr)); gap:25px;">
            <div>
                <div style="background:rgba(79, 70, 229, 0.1); padding:20px; border-radius:15px; margin-bottom:20px;">
                    <div style="color:#93c5fd; font-weight:bold; margin-bottom:10px;">ğŸ¯ AIä¿¡å¿ƒè¯„ä¼°</div>
                    <div style="font-size:28px; color:#34d399; margin-bottom:5px;">${star}</div>
                    <div style="color:#cbd5e1; font-size:14px;">é£é™©ç­‰çº§ï¼š${risk} Â· åŠ¨æ€å‡†ç¡®ç‡ï¼š${acc}%</div>
                </div>
                
                <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px; margin-bottom:20px;">
                    <div style="color:#93c5fd; font-weight:bold; margin-bottom:15px;">âš½ AIç²¾ç¡®è¿›çƒæ•°é¢„æµ‹</div>
                    <div style="display:flex; gap:15px; margin-bottom:15px;">
                        <div style="flex:1; text-align:center; background:rgba(79, 70, 229, 0.2); padding:15px; border-radius:12px;">
                            <div style="font-size:12px; color:#a78bfa;">ç¬¬ä¸€æ¨è</div>
                            <div style="font-size:28px; font-weight:bold; color:#34d399;">${exactGoals[0]}</div>
                        </div>
                        <div style="flex:1; text-align:center; background:rgba(30, 41, 90, 0.6); padding:15px; border-radius:12px;">
                            <div style="font-size:12px; color:#a78bfa;">ç¬¬äºŒæ¨è</div>
                            <div style="font-size:24px; font-weight:bold; color:#e0e7ff;">${exactGoals[1]}</div>
                        </div>
                        <div style="flex:1; text-align:center; background:rgba(30, 41, 90, 0.6); padding:15px; border-radius:12px;">
                            <div style="font-size:12px; color:#a78bfa;">ç¬¬ä¸‰æ¨è</div>
                            <div style="font-size:24px; font-weight:bold; color:#e0e7ff;">${exactGoals[2]}</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div>
                <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px; margin-bottom:20px;">
                    <div style="color:#93c5fd; font-weight:bold; margin-bottom:15px;">ğŸ“ˆ èƒœå¹³è´Ÿæ¦‚ç‡åˆ†å¸ƒ</div>
                    <div style="margin-bottom:15px;">
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <span>${hN}</span>
                            <span>${(calc.hw * 100).toFixed(1)}%</span>
                        </div>
                        <div class="bar"><div class="bar-fill" style="width:${calc.hw * 100}%"></div></div>
                    </div>
                    <div style="margin-bottom:15px;">
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <span>å¹³å±€</span>
                            <span>${(calc.dr * 100).toFixed(1)}%</span>
                        </div>
                        <div class="bar"><div class="bar-fill" style="width:${calc.dr * 100}%"></div></div>
                    </div>
                    <div>
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <span>${aN}</span>
                            <span>${(calc.aw * 100).toFixed(1)}%</span>
                        </div>
                        <div class="bar"><div class="bar-fill" style="width:${calc.aw * 100}%"></div></div>
                    </div>
                </div>
                
                <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px;">
                    <div style="color:#93c5fd; font-weight:bold; margin-bottom:15px;">ğŸ® æŠ•æ³¨ç­–ç•¥æ¨è</div>
                    <div style="display:grid; grid-template-columns:1fr 1fr; gap:15px;">
                        <div style="background:rgba(79, 70, 229, 0.1); padding:15px; border-radius:10px;">
                            <div style="font-size:12px; color:#a78bfa;">æ ¸å¿ƒæ–¹å‘</div>
                            <div style="font-size:18px; color:#34d399; font-weight:bold;">${main}</div>
                        </div>
                        <div style="background:rgba(30, 41, 90, 0.6); padding:15px; border-radius:10px;">
                            <div style="font-size:12px; color:#a78bfa;">å¤§å°çƒ</div>
                            <div style="font-size:18px; color:#22d3ee; font-weight:bold;">${ou}</div>
                            <div style="font-size:12px; color:#cbd5e1;">é¢„æœŸ${tE.toFixed(1)}çƒ</div>
                        </div>
                    </div>
                    <div style="margin-top:15px; padding:15px; background:rgba(34, 197, 94, 0.1); border-radius:10px;">
                        <div style="font-size:12px; color:#a78bfa;">2ä¸²1ç²¾é€‰</div>
                        <div style="font-size:18px; color:#34d399; font-weight:bold;">${combo}</div>
                    </div>
                </div>
            </div>
        </div>
        
        ${h2hHtml}
        
        <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px; margin-top:20px;">
            <div style="color:#93c5fd; font-weight:bold; margin-bottom:15px;">ğŸ”¥ AIæ¨è3ç»„è¯¦ç»†æ¯”åˆ†</div>
            <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(200px, 1fr)); gap:15px;">
                <div style="text-align:center; padding:20px; background:rgba(79, 70, 229, 0.15); border-radius:12px; border:2px solid rgba(79, 70, 229, 0.3);">
                    <div style="font-size:14px; color:#a78bfa; margin-bottom:10px;">ç¬¬ä¸€æ¨è</div>
                    <div style="font-size:42px; font-weight:bold; color:#34d399;">${top3[0]?.hg || 0}-${top3[0]?.ag || 0}</div>
                    <div style="font-size:12px; color:#cbd5e1; margin-top:10px;">æ¦‚ç‡æœ€é«˜</div>
                </div>
                <div style="text-align:center; padding:20px; background:rgba(30, 41, 90, 0.6); border-radius:12px;">
                    <div style="font-size:14px; color:#a78bfa; margin-bottom:10px;">ç¬¬äºŒæ¨è</div>
                    <div style="font-size:36px; font-weight:bold; color:#e0e7ff;">${top3[1]?.hg || 0}-${top3[1]?.ag || 0}</div>
                </div>
                <div style="text-align:center; padding:20px; background:rgba(30, 41, 90, 0.6); border-radius:12px;">
                    <div style="font-size:14px; color:#a78bfa; margin-bottom:10px;">ç¬¬ä¸‰æ¨è</div>
                    <div style="font-size:36px; font-weight:bold; color:#e0e7ff;">${top3[2]?.hg || 0}-${top3[2]?.ag || 0}</div>
                </div>
            </div>
        </div>
        
        <div style="display:grid; grid-template-columns:repeat(auto-fit, minmax(250px, 1fr)); gap:20px; margin-top:25px;">
            <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px;">
                <div style="color:#93c5fd; font-weight:bold; margin-bottom:10px;">â± åŠå…¨åœºé¢„æµ‹</div>
                <div style="font-size:20px; color:#e0e7ff;">${halfText}</div>
            </div>
            <div style="background:rgba(30, 41, 90, 0.6); padding:20px; border-radius:15px;">
                <div style="color:#93c5fd; font-weight:bold; margin-bottom:10px;">ğŸ“ AIåˆ†æç»“è®º</div>
                <div style="color:#34d399; font-weight:bold;">${conc}</div>
            </div>
        </div>
        
        <div style="text-align:center; margin-top:30px; padding:20px; background:rgba(79, 70, 229, 0.1); border-radius:15px;">
            <div style="color:#a78bfa; font-size:14px;">âœ… èµ›äº‹çº§AIè¶…çº§æ™ºèƒ½ Â· æ¨æµ‹æ¨¡æ‹Ÿå·²å®Œæˆ</div>
            <div style="color:#cbd5e1; font-size:12px; margin-top:10px;">é¢„æµ‹æ—¶é—´ï¼š${new Date().toLocaleString()}</div>
        </div>
        `;
        
        res.innerHTML = html;
        showAcc(acc);
        showComp(hN, aN, top3);
        
        // æ›´æ–°çŠ¶æ€æ 
        const statusItems = document.querySelectorAll('.status-item span');
        if (statusItems.length > 1) {
            statusItems[1].textContent = `æœ€è¿‘é¢„æµ‹: ${hN} vs ${aN}`;
        }
    }, 800);
}

// èŠå¤©åŠŸèƒ½
function appendMsg(t, isUser) {
    const b = document.getElementById("chatBox");
    const d = document.createElement("div");
    d.className = `chat-bubble ${isUser ? "chat-user" : "chat-ai"}`;
    d.innerText = t;
    b.appendChild(d);
    b.scrollTop = b.scrollHeight;
}

function sendChat() {
    const i = document.getElementById("chatInput");
    const t = i.value.trim();
    if (!t) return;
    i.value = "";
    appendMsg(t, true);
    
    setTimeout(() => {
        if (!lastCalc) {
            appendMsg("è¯·å…ˆè¿›è¡Œä¸€æ¬¡æ¯”èµ›æ¨¡æ‹Ÿï¼Œç„¶åæˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›è¯¦ç»†çš„åˆ†æå»ºè®®ã€‚", false);
            return;
        }
        
        const {calc, homeName, awayName, totalExp, top3} = lastCalc;
        const t1 = calc.list[0];
        const main = calc.hw > calc.aw ? 
                    (calc.hw > 0.48 ? homeName + "èƒœ" : homeName + "ä¸è´¥") : 
                    (calc.aw > 0.48 ? awayName + "èƒœ" : awayName + "ä¸è´¥");
        const ou = totalExp > 2.75 ? "å¤§2.75" : totalExp > 2.45 ? "å¤§2.5" : "å°2.5";
        
        if (/å¯¹æ¯”|å†å²/.test(t)) {
            appendMsg("å·²åœ¨å¯¹æ¯”åˆ†æåŒºåŸŸæ˜¾ç¤ºå†å²é¢„æµ‹è®°å½•ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹è¶‹åŠ¿ä¸€è‡´æ€§ã€‚", false);
        } else if (/ä½ å¥½/.test(t)) {
            appendMsg("æ‚¨å¥½ï¼æˆ‘æ˜¯AIè¶³çƒé¢„æµ‹åŠ©æ‰‹ï¼Œå¯ä»¥ä¸ºæ‚¨åˆ†ææ¯”èµ›æ¯”åˆ†ã€ç¨³å•æ¨èã€é˜²å†·æç¤ºç­‰ä¸“ä¸šé—®é¢˜ã€‚", false);
        } else if (/å‡†ç¡®ç‡/.test(t)) {
            appendMsg(`ğŸ“ˆ æœ¬åœºæ¯”èµ›åŠ¨æ€é¢„æµ‹å‡†ç¡®ç‡ï¼š${lastPred.acc}%\nä¾æ®ï¼šè”èµ›ç­‰çº§+çƒé˜Ÿå®åŠ›+ä¼¤ç—…æƒ…å†µ+æ”»é˜²å€¾å‘+æ¦‚ç‡é›†ä¸­åº¦`, false);
        } else if (/æ¯”åˆ†/.test(t)) {
            appendMsg(`ğŸ”¥ æ¨èæ¯”åˆ†ï¼š\nâ‘  ${top3[0].hg}-${top3[0].ag}\nâ‘¡ ${top3[1].hg}-${top3[1].ag}\nâ‘¢ ${top3[2].hg}-${top3[2].ag}\n\nğŸ“Š æ ¸å¿ƒæ–¹å‘ï¼š${main}\nâš½ å¤§å°çƒï¼š${ou}`, false);
        } else if (/ç¨³å•/.test(t)) {
            appendMsg(`ğŸ¯ ç¨³å•æ¨èï¼š${t1.hg}-${t1.ag} næ–¹å‘ï¼š${main} nå‡†ç¡®ç‡ï¼š${lastPred.acc}% nå»ºè®®æ­é…ï¼š${main} + ${ou} 2ä¸²1`, false);
        } else if (/å†·|é˜²å†·/.test(t)) {
            const cold = calc.list.filter(s => s.hg + s.ag >= 3).slice(0, 3);
            appendMsg(`âš ï¸ é˜²å†·æç¤ºï¼š nâ‘  ${cold[0].hg}-${cold[0].ag} nâ‘¡ ${cold[1].hg}-${cold[1].ag} nâ‘¢ ${cold[2].hg}-${cold[2].ag} n né«˜é£é™©æ¯”åˆ†ï¼Œéœ€è°¨æ…å‚è€ƒã€‚`, false);
        } else if (/åŠå…¨åœº/.test(t)) {
            const ht = halfTime(lastCalc.calc.list[0].hg, lastCalc.calc.list[0].ag);
            let htText = "èƒ¶ç€å‡è¡¡";
            if (ht.home > 0.55) htText = homeName + "åŠåœºé¢†å…ˆå¯èƒ½æ€§å¤§";
            else if (ht.away > 0.55) htText = awayName + "åŠåœºé¢†å…ˆå¯èƒ½æ€§å¤§";
            appendMsg(`â± åŠå…¨åœºåˆ†æï¼š\nåŠåœºå€¾å‘ï¼š${htText}\nå…¨åœºé‡ç‚¹ï¼š${t1.hg}-${t1.ag}\nå»ºè®®ï¼šåŠå…¨åœº ${main}`, false);
        } else if (/2ä¸²1/.test(t)) {
            appendMsg(`ğŸ”— 2ä¸²1æ¨èï¼š\n${main} + ${ou}\næ­é…æ¯”åˆ†ï¼š${t1.hg}-${t1.ag}\né¢„è®¡å›æŠ¥ç‡ï¼šä¸­ç­‰åé«˜`, false);
        } else if (/çº¢å•|æ”¶ç±³/.test(t)) {
            appendMsg("ğŸ”¥ ç¥æ‚¨åœºåœºçº¢å•ã€ç¨³å®šæ”¶ç±³ï¼AIé¢„æµ‹ä»…ä¾›å‚è€ƒï¼Œè¯·ç†æ€§æŠ•æ³¨ã€‚", false);
        } else {
            appendMsg("æˆ‘å¯ä»¥ä¸ºæ‚¨æä¾›ä»¥ä¸‹å¸®åŠ©ï¼š\nâ€¢ æ¯”åˆ†é¢„æµ‹\nâ€¢ ç¨³å•æ¨è\nâ€¢ é˜²å†·æç¤º\nâ€¢ åŠå…¨åœºåˆ†æ\nâ€¢ 2ä¸²1ç»„åˆ\nâ€¢ å‡†ç¡®ç‡æŸ¥è¯¢\nâ€¢ å†å²å¯¹æ¯”\nè¯·ç›´æ¥å‘Šè¯‰æˆ‘æ‚¨éœ€è¦ä»€ä¹ˆï¼Ÿ", false);
        }
    }, 400);
}

// é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
    // ä¸ºå·¥å…·å¡ç‰‡æ·»åŠ ç‚¹å‡»æ•ˆæœ
    const toolCards = document.querySelectorAll('.tool-card');
    toolCards.forEach(card => {
        card.addEventListener('click', function() {
            toolCards.forEach(c => c.classList.remove('active'));
            this.classList.add('active');
            
            // æ ¹æ®ç‚¹å‡»çš„å·¥å…·æ˜¾ç¤ºç›¸åº”æç¤º
            const toolName = this.querySelector('.tool-name').textContent;
            const messages = {
                'æ ¸å¿ƒä¼¤åœ': 'ç‚¹å‡»ä¸Šæ–¹çš„ä¸‹æ‹‰èœå•å¯è®¾ç½®çƒé˜Ÿä¼¤ç—…æƒ…å†µ',
                'æ”»é˜²å€¾å‘': 'ä½¿ç”¨æ”»é˜²å€¾å‘ä¸‹æ‹‰èœå•è°ƒæ•´çƒé˜Ÿç­–ç•¥',
                'æ¯”èµ›èŠ‚å¥': 'é€šè¿‡æ¯”èµ›èŠ‚å¥ä¸‹æ‹‰èœå•æ§åˆ¶æ¯”èµ›é€Ÿåº¦',
                'èµ›äº‹å¼ºåº¦': 'æ ¹æ®è”èµ›çº§åˆ«é€‰æ‹©ç›¸åº”çš„èµ›äº‹å¼ºåº¦'
            };
            
            if (messages[toolName]) {
                const chatBox = document.getElementById('chatBox');
                if (chatBox) {
                    setTimeout(() => {
                        appendMsg(`æ‚¨é€‰æ‹©äº†${toolName}å·¥å…·ã€‚${messages[toolName]}`, false);
                    }, 300);
                }
            }
        });
    });
    
    // è®¾ç½®å½“å‰æ—¥æœŸæ—¶é—´
    const now = new Date();
    const dateStr = now.toLocaleDateString('zh-CN', { 
        year: 'numeric', 
        month: '2-digit', 
        day: '2-digit' 
    });
    const timeStr = now.toLocaleTimeString('zh-CN', { 
        hour: '2-digit', 
        minute: '2-digit' 
    });
    
    const statusItems = document.querySelectorAll('.status-item span');
    if (statusItems.length > 0) {
        statusItems[0].textContent = `æ•°æ®å·²æ›´æ–°: ${dateStr} ${timeStr}`;
    }
});
</script>
</body>
</html>
